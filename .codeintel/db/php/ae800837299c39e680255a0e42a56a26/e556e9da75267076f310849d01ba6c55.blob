<scope ilk="blob" lang="PHP" name="ErrorStack.php" src="/usr/share/php/PEAR/ErrorStack.php"><import line="978" module="PEAR.php" /><variable citdl="int" ilk="constant" line="92" name="PEAR_ERRORSTACK_PUSHANDLOG" /><variable citdl="int" ilk="constant" line="97" name="PEAR_ERRORSTACK_PUSH" /><variable citdl="int" ilk="constant" line="102" name="PEAR_ERRORSTACK_LOG" /><variable citdl="int" ilk="constant" line="106" name="PEAR_ERRORSTACK_IGNORE" /><variable citdl="int" ilk="constant" line="110" name="PEAR_ERRORSTACK_DIE" /><variable citdl="int" ilk="constant" line="117" name="PEAR_ERRORSTACK_ERR_NONCLASS" /><variable citdl="int" ilk="constant" line="123" name="PEAR_ERRORSTACK_ERR_OBJTOSTRING" /><scope doc="Error Stack Implementation&#xA;&#xA;Usage:&#xA;&lt;code&gt;&#xA;// global error stack&#xA;$global_stack = &amp;PEAR_ErrorStack::singleton(&apos;MyPackage&apos;);&#xA;// local error stack&#xA;$local_stack = new PEAR_ErrorStack(&apos;MyPackage&apos;);&#xA;&lt;/code&gt;&#xA;@author     Greg Beaver &lt;cellog@php.net&gt;&#xA;@version    1.9.4&#xA;@package    PEAR_ErrorStack&#xA;@category   Debugging&#xA;@copyright  2004-2008 Greg Beaver&#xA;@license    http://opensource.org/licenses/bsd-license.php New BSD License&#xA;@version    CVS: $Id: ErrorStack.php 313023 2011-07-06 19:17:11Z dufuz $&#xA;@link       http://pear.php.net/package/PEAR_ErrorStack" ilk="class" line="143" lineend="982" name="PEAR_ErrorStack"><variable citdl="array" doc="Errors are stored in the order that they are pushed on the stack.&#xA;@since 0.4alpha Errors are no longer organized by error level.&#xA;This renders pop() nearly unusable, and levels could be more easily&#xA;handled in a callback anyway&#xA;@var array&#xA;@access private" line="152" name="_errors" /><variable citdl="array" doc="Storage of errors by level.&#xA;&#xA;Allows easy retrieval and deletion of only errors from a particular level&#xA;@since PEAR 1.4.0dev&#xA;@var array&#xA;@access private" line="162" name="_errorsByLevel" /><variable citdl="string" doc="Package name this error stack represents&#xA;@var string&#xA;@access protected" line="169" name="_package" /><variable citdl="boolean" doc="Determines whether a PEAR_Error is thrown upon every error addition&#xA;@var boolean&#xA;@access private" line="176" name="_compat" /><variable citdl="false" doc="If set to a valid callback, this will be used to generate the error&#xA;message from the error code, otherwise the message passed in will be&#xA;used&#xA;@var false|string|array&#xA;@access private" line="185" name="_msgCallback" /><variable citdl="false" doc="If set to a valid callback, this will be used to generate the error&#xA;context for an error.  For PHP-related errors, this will be a file&#xA;and line number as retrieved from debug_backtrace(), but can be&#xA;customized for other purposes.  The error might actually be in a separate&#xA;configuration file, or in a database query.&#xA;@var false|string|array&#xA;@access protected" line="196" name="_contextCallback" /><variable citdl="false" doc="If set to a valid callback, this will be called every time an error&#xA;is pushed onto the stack.  The return value will be used to determine&#xA;whether to allow an error to be pushed or logged.&#xA;&#xA;The return value must be one an PEAR_ERRORSTACK_* constant&#xA;@see PEAR_ERRORSTACK_PUSHANDLOG, PEAR_ERRORSTACK_PUSH, PEAR_ERRORSTACK_LOG&#xA;@var false|string|array&#xA;@access protected" line="208" name="_errorCallback" /><variable citdl="false" doc="PEAR::Log object for logging errors&#xA;@var false|Log&#xA;@access protected" line="215" name="_logger" /><variable citdl="array" doc="Error messages - designed to be overridden&#xA;@var array&#xA;@abstract" line="222" name="_errorMsgs" /><scope attributes="__ctor__" doc="Set up a new error stack&#xA;&#xA;@param string   $package name of the package this error stack represents&#xA;@param callback $msgCallback callback used for error message generation&#xA;@param callback $contextCallback callback used for context generation,&#xA;                defaults to {@link getFileLine()}&#xA;@param boolean  $throwPEAR_Error" ilk="function" line="233" lineend="240" name="PEAR_ErrorStack" signature="PEAR_ErrorStack(string $package, callback $msgCallback = false, callback $contextCallback = false, boolean $throwPEAR_Error = false)"><variable citdl="string" ilk="argument" line="233" name="package" /><variable citdl="callback" default="false" ilk="argument" line="233" name="msgCallback" /><variable citdl="callback" default="false" ilk="argument" line="233" name="contextCallback" /><variable citdl="boolean" default="false" ilk="argument" line="233" name="throwPEAR_Error" /></scope><scope doc="Return a single error stack for this package.&#xA;&#xA;Note that all parameters are ignored if the stack for package $package&#xA;has already been instantiated&#xA;@param string   $package name of the package this error stack represents&#xA;@param callback $msgCallback callback used for error message generation&#xA;@param callback $contextCallback callback used for context generation,&#xA;                defaults to {@link getFileLine()}&#xA;@param boolean  $throwPEAR_Error&#xA;@param string   $stackClass class to instantiate&#xA;@static&#xA;@return PEAR_ErrorStack" ilk="function" line="256" lineend="275" name="singleton" returns="PEAR_ErrorStack" signature="PEAR_ErrorStack &amp;singleton(string $package, callback $msgCallback = false, callback $contextCallback = false, boolean $throwPEAR_Error = false, string $stackClass = &apos;PEAR_ErrorStack&apos;)"><variable citdl="string" ilk="argument" line="256" name="package" /><variable citdl="callback" default="false" ilk="argument" line="256" name="msgCallback" /><variable citdl="callback" default="false" ilk="argument" line="256" name="contextCallback" /><variable citdl="boolean" default="false" ilk="argument" line="256" name="throwPEAR_Error" /><variable citdl="string" default="&apos;PEAR_ErrorStack&apos;" ilk="argument" line="256" name="stackClass" /><variable attributes="__not_yet_defined__" line="259" name="GLOBALS" /><variable citdl="debug_backtrace()" line="264" name="trace" /></scope><scope doc="Internal error handler for PEAR_ErrorStack class&#xA;&#xA;Dies if the error is an exception (and would have died anyway)&#xA;@access private" ilk="function" line="283" lineend="295" name="_handleError" signature="_handleError($err)"><variable ilk="argument" line="283" name="err" /><variable attributes="__not_yet_defined__" line="287" name="_SERVER" /><variable citdl="err" line="286" name="message" /></scope><scope doc="Set up a PEAR::Log object for all error stacks that don&apos;t have one&#xA;@param Log $log &#xA;@static" ilk="function" line="302" lineend="309" name="setDefaultLogger" signature="setDefaultLogger(Log &amp; $log)"><variable citdl="Log" ilk="argument" line="302" name="log" /></scope><scope doc="Set up a PEAR::Log object for this error stack&#xA;@param Log $log" ilk="function" line="315" lineend="322" name="setLogger" signature="setLogger(Log &amp; $log)"><variable citdl="Log" ilk="argument" line="315" name="log" /></scope><scope doc="Set an error code =&gt; error message mapping callback&#xA;&#xA;This method sets the callback that can be used to generate error&#xA;messages for any instance&#xA;@param array|string Callback function/method" ilk="function" line="331" lineend="340" name="setMessageCallback" signature="setMessageCallback($msgCallback)"><variable ilk="argument" line="331" name="msgCallback" /></scope><scope doc="Get an error code =&gt; error message mapping callback&#xA;&#xA;This method returns the current callback that can be used to generate error&#xA;messages&#xA;@return array|string|false Callback function/method or false if none" ilk="function" line="349" lineend="352" name="getMessageCallback" returns="array" signature="array getMessageCallback()" /><scope doc="Sets a default callback to be used by all error stacks&#xA;&#xA;This method sets the callback that can be used to generate error&#xA;messages for a singleton&#xA;@param array|string Callback function/method&#xA;@param string Package name, or false for all packages&#xA;@static" ilk="function" line="363" lineend="370" name="setDefaultCallback" signature="setDefaultCallback($callback = false, $package = false)"><variable default="false" ilk="argument" line="363" name="callback" /><variable default="false" ilk="argument" line="363" name="package" /></scope><scope doc="Set a callback that generates context information (location of error) for an error stack&#xA;&#xA;This method sets the callback that can be used to generate context&#xA;information for an error.  Passing in NULL will disable context generation&#xA;and remove the expensive call to debug_backtrace()&#xA;@param array|string|null Callback function/method" ilk="function" line="380" lineend="392" name="setContextCallback" returns="this._contextCallback" signature="setContextCallback($contextCallback)"><variable ilk="argument" line="380" name="contextCallback" /></scope><scope doc="Set an error Callback&#xA;If set to a valid callback, this will be called every time an error&#xA;is pushed onto the stack.  The return value will be used to determine&#xA;whether to allow an error to be pushed or logged.&#xA;&#xA;The return value must be one of the ERRORSTACK_* constants.&#xA;&#xA;This functionality can be used to emulate PEAR&apos;s pushErrorHandling, and&#xA;the PEAR_ERROR_CALLBACK mode, without affecting the integrity of&#xA;the error stack or logging&#xA;@see PEAR_ERRORSTACK_PUSHANDLOG, PEAR_ERRORSTACK_PUSH, PEAR_ERRORSTACK_LOG&#xA;@see popCallback()&#xA;@param string|array $cb" ilk="function" line="409" lineend="412" name="pushCallback" signature="pushCallback($cb)"><variable ilk="argument" line="409" name="cb" /></scope><scope doc="Remove a callback from the error callback stack&#xA;@see pushCallback()&#xA;@return array|string|false" ilk="function" line="419" lineend="425" name="popCallback" returns="array" signature="array popCallback()" /><scope doc="Set a temporary overriding error callback for every package error stack&#xA;&#xA;Use this to temporarily disable all existing callbacks (can be used&#xA;to emulate the @ operator, for instance)&#xA;@see PEAR_ERRORSTACK_PUSHANDLOG, PEAR_ERRORSTACK_PUSH, PEAR_ERRORSTACK_LOG&#xA;@see staticPopCallback(), pushCallback()&#xA;@param string|array $cb&#xA;@static" ilk="function" line="437" lineend="440" name="staticPushCallback" signature="staticPushCallback($cb)"><variable ilk="argument" line="437" name="cb" /></scope><scope doc="Remove a temporary overriding error callback&#xA;@see staticPushCallback()&#xA;@return array|string|false&#xA;@static" ilk="function" line="448" lineend="455" name="staticPopCallback" returns="array" signature="array staticPopCallback()"><variable attributes="__not_yet_defined__" line="451" name="GLOBALS" /><variable citdl="array_pop()" line="450" name="ret" /></scope><scope doc="Add an error to the stack&#xA;&#xA;If the message generator exists, it is called with 2 parameters.&#xA; - the current Error Stack object&#xA; - an array that is in the same format as an error.  Available indices&#xA;   are &apos;code&apos;, &apos;package&apos;, &apos;time&apos;, &apos;params&apos;, &apos;level&apos;, and &apos;context&apos;&#xA;&#xA;Next, if the error should contain context information, this is&#xA;handled by the context grabbing method.&#xA;Finally, the error is pushed onto the proper error stack&#xA;@param int    $code      Package-specific error code&#xA;@param string $level     Error level.  This is NOT spell-checked&#xA;@param array  $params    associative array of error parameters&#xA;@param string $msg       Error message, or a portion of it if the message&#xA;                         is to be generated&#xA;@param array  $repackage If this error re-packages an error pushed by&#xA;                         another package, place the array returned from&#xA;                         {@link pop()} in this parameter&#xA;@param array  $backtrace Protected parameter: use this to pass in the&#xA;                         {@link debug_backtrace()} that should be used&#xA;                         to find error context&#xA;@return PEAR_Error|array if compatibility mode is on, a PEAR_Error is also&#xA;thrown.  If a PEAR_Error is returned, the userinfo&#xA;property is set to the following array:&#xA;&#xA;&lt;code&gt;&#xA;array(&#xA;   &apos;code&apos; =&gt; $code,&#xA;   &apos;params&apos; =&gt; $params,&#xA;   &apos;package&apos; =&gt; $this-&gt;_package,&#xA;   &apos;level&apos; =&gt; $level,&#xA;   &apos;time&apos; =&gt; time(),&#xA;   &apos;context&apos; =&gt; $context,&#xA;   &apos;message&apos; =&gt; $msg,&#xA;//[&apos;repackage&apos; =&gt; $err] repackaged error array/Exception class&#xA;);&#xA;&lt;/code&gt;&#xA;&#xA;Normally, the previous array is returned." ilk="function" line="498" lineend="588" name="push" returns="PEAR_Error" signature="PEAR_Error push(int $code, string $level = &apos;error&apos;, array $params = array(), string $msg = false, array $repackage = false, array $backtrace = false)"><variable citdl="int" ilk="argument" line="498" name="code" /><variable citdl="string" default="&apos;error&apos;" ilk="argument" line="498" name="level" /><variable citdl="array" default="array()" ilk="argument" line="498" name="params" /><variable citdl="string" default="false" ilk="argument" line="498" name="msg" /><variable citdl="array" default="false" ilk="argument" line="498" name="repackage" /><variable citdl="array" default="false" ilk="argument" line="498" name="backtrace" /><variable citdl="boolean" line="558" name="log" /><variable citdl="array()" line="521" name="err" /><variable citdl="boolean" line="534" name="die" /><variable citdl="this.staticPopCallback()" line="536" name="callback" /><variable attributes="__not_yet_defined__" line="577" name="GLOBALS" /><variable citdl="boolean" line="501" name="context" /><variable citdl="explode()" line="511" name="time" /><variable citdl="log" line="533" name="push" /></scope><scope doc="Static version of {@link push()}&#xA;&#xA;@param string $package   Package name this error belongs to&#xA;@param int    $code      Package-specific error code&#xA;@param string $level     Error level.  This is NOT spell-checked&#xA;@param array  $params    associative array of error parameters&#xA;@param string $msg       Error message, or a portion of it if the message&#xA;                         is to be generated&#xA;@param array  $repackage If this error re-packages an error pushed by&#xA;                         another package, place the array returned from&#xA;                         {@link pop()} in this parameter&#xA;@param array  $backtrace Protected parameter: use this to pass in the&#xA;                         {@link debug_backtrace()} that should be used&#xA;                         to find error context&#xA;@return PEAR_Error|array if compatibility mode is on, a PEAR_Error is also&#xA;                         thrown.  see docs for {@link push()}&#xA;@static" ilk="function" line="609" lineend="621" name="staticPush" returns="PEAR_Error" signature="PEAR_Error staticPush(string $package, int $code, string $level = &apos;error&apos;, array $params = array(), string $msg = false, array $repackage = false, array $backtrace = false)"><variable citdl="string" ilk="argument" line="609" name="package" /><variable citdl="int" ilk="argument" line="609" name="code" /><variable citdl="string" default="&apos;error&apos;" ilk="argument" line="609" name="level" /><variable citdl="array" default="array()" ilk="argument" line="609" name="params" /><variable citdl="string" default="false" ilk="argument" line="609" name="msg" /><variable citdl="array" default="false" ilk="argument" line="609" name="repackage" /><variable citdl="array" default="false" ilk="argument" line="609" name="backtrace" /><variable citdl="PEAR_ErrorStack.singleton()" line="612" name="s" /></scope><scope doc="Log an error using PEAR::Log&#xA;@param array $err Error array&#xA;@param array $levels Error level =&gt; Log constant map&#xA;@access protected" ilk="function" line="629" lineend="655" name="_log" signature="_log(array $err, array $levels)"><variable citdl="array" ilk="argument" line="629" name="err" /><variable citdl="array" ilk="argument" line="629" name="levels" /><variable citdl="this._logger" line="632" name="logger" /><variable citdl="levels" line="647" name="level" /></scope><scope doc="Pop an error off of the error stack&#xA;&#xA;@return false|array&#xA;@since 0.4alpha it is no longer possible to specify a specific error&#xA;level to return - the last error pushed will be returned, instead" ilk="function" line="665" lineend="675" name="pop" returns="false" signature="false pop()"><variable line="667" name="err" /></scope><scope doc="Pop an error off of the error stack, static method&#xA;&#xA;@param string package name&#xA;@return boolean&#xA;@since PEAR1.5.0a1" ilk="function" line="684" lineend="692" name="staticPop" returns="boolean" signature="boolean staticPop($package)"><variable ilk="argument" line="684" name="package" /><variable attributes="__not_yet_defined__" line="687" name="GLOBALS" /></scope><scope doc="Determine whether there are any errors on the stack&#xA;@param string|array Level name.  Use to determine if any errors&#xA;of level (string), or levels (array) have been pushed&#xA;@return boolean" ilk="function" line="700" lineend="706" name="hasErrors" returns="boolean" signature="boolean hasErrors($level = false)"><variable default="false" ilk="argument" line="700" name="level" /></scope><scope doc="Retrieve all errors since last purge&#xA;&#xA;@param boolean set in order to empty the error stack&#xA;@param string level name, to return only errors of a particular severity&#xA;@return array" ilk="function" line="715" lineend="743" name="getErrors" returns="array" signature="array getErrors($purge = false, $level = false)"><variable default="false" ilk="argument" line="715" name="purge" /><variable default="false" ilk="argument" line="715" name="level" /><variable line="730" name="i" /><variable attributes="__not_yet_defined__" line="730" name="unused" /><variable citdl="this._errorsByLevel" line="729" name="ret" /></scope><scope doc="Determine whether there are any errors on a single error stack, or on any error stack&#xA;&#xA;The optional parameter can be used to test the existence of any errors without the need of&#xA;singleton instantiation&#xA;@param string|false Package name to check for errors&#xA;@param string Level name to check for a particular severity&#xA;@return boolean&#xA;@static" ilk="function" line="755" lineend="769" name="staticHasErrors" returns="boolean" signature="boolean staticHasErrors($package = false, $level = false)"><variable default="false" ilk="argument" line="755" name="package" /><variable default="false" ilk="argument" line="755" name="level" /><variable attributes="__not_yet_defined__" line="758" name="GLOBALS" /><variable attributes="__not_yet_defined__" line="763" name="obj" /></scope><scope doc="Get a list of all errors since last purge, organized by package&#xA;@since PEAR 1.4.0dev BC break! $level is now in the place $merge used to be&#xA;@param boolean $purge Set to purge the error stack of existing errors&#xA;@param string  $level Set to a level name in order to retrieve only errors of a particular level&#xA;@param boolean $merge Set to return a flat array, not organized by package&#xA;@param array   $sortfunc Function used to sort a merged array - default&#xA;       sorts by time, and should be good for most cases&#xA;@static&#xA;@return array" ilk="function" line="782" lineend="803" name="staticGetErrors" returns="array" signature="array staticGetErrors(boolean $purge = false, string $level = false, boolean $merge = false, array $sortfunc = array(&apos;PEAR_ErrorStack&apos;,&apos;_sortErrors&apos;))"><variable citdl="boolean" default="false" ilk="argument" line="782" name="purge" /><variable citdl="string" default="false" ilk="argument" line="782" name="level" /><variable citdl="boolean" default="false" ilk="argument" line="782" name="merge" /><variable citdl="array" default="array(&apos;PEAR_ErrorStack&apos;,&apos;_sortErrors&apos;)" ilk="argument" line="782" name="sortfunc" /><variable citdl="GLOBALS" line="790" name="test" /><variable attributes="__not_yet_defined__" line="789" name="GLOBALS" /><variable attributes="__not_yet_defined__" line="789" name="obj" /><variable citdl="array()" line="785" name="ret" /><variable line="789" name="package" /></scope><scope doc="Error sorting function, sorts by time&#xA;@access private" ilk="function" line="809" lineend="818" name="_sortErrors" returns="int" signature="_sortErrors($a, $b)"><variable ilk="argument" line="809" name="a" /><variable ilk="argument" line="809" name="b" /></scope><scope doc="Standard file/line number/function/class context callback&#xA;&#xA;This function uses a backtrace generated from {@link debug_backtrace()}&#xA;and so will not work at all in PHP &lt; 4.3.0.  The frame should&#xA;reference the frame that contains the source of the error.&#xA;@return array|false either array(&apos;file&apos; =&gt; file, &apos;line&apos; =&gt; line,&#xA;        &apos;function&apos; =&gt; function name, &apos;class&apos; =&gt; class name) or&#xA;        if this doesn&apos;t work, then false&#xA;@param unused&#xA;@param integer backtrace frame.&#xA;@param array Results of debug_backtrace()&#xA;@static" ilk="function" line="834" lineend="880" name="getFileLine" returns="array" signature="array getFileLine($code, $params, $backtrace = null)"><variable ilk="argument" line="834" name="code" /><variable ilk="argument" line="834" name="params" /><variable default="null" ilk="argument" line="834" name="backtrace" /><variable citdl="backtrace" line="855" name="filebacktrace" /><variable attributes="__not_yet_defined__" line="859" name="matches" /><variable citdl="int" line="839" name="frame" /><variable citdl="backtrace" line="854" name="funcbacktrace" /><variable citdl="array()" line="857" name="ret" /><variable citdl="int" line="840" name="functionframe" /></scope><scope doc="Standard error message generation callback&#xA;&#xA;This method may also be called by a custom error message generator&#xA;to fill in template values from the params array, simply&#xA;set the third parameter to the error message template string to use&#xA;&#xA;The special variable %__msg% is reserved: use it only to specify&#xA;where a message passed in by the user should be placed in the template,&#xA;like so:&#xA;&#xA;Error message: %msg% - internal error&#xA;&#xA;If the message passed like so:&#xA;&#xA;&lt;code&gt;&#xA;$stack-&gt;push(ERROR_CODE, &apos;error&apos;, array(), &apos;server error 500&apos;);&#xA;&lt;/code&gt;&#xA;&#xA;The returned error message will be &quot;Error message: server error 500 -&#xA;internal error&quot;&#xA;@param PEAR_ErrorStack&#xA;@param array&#xA;@param string|false Pre-generated error message template&#xA;@static&#xA;@return string" ilk="function" line="909" lineend="937" name="getErrorMessage" returns="string" signature="string getErrorMessage(&amp; $stack, $err, $template = false)"><variable ilk="argument" line="909" name="stack" /><variable ilk="argument" line="909" name="err" /><variable default="false" ilk="argument" line="909" name="template" /><variable citdl="str_replace()" line="912" name="mainmsg" /><variable line="918" name="name" /><variable attributes="__not_yet_defined__" citdl="val.__toString()" line="918" name="val" /></scope><scope doc="Standard Error Message Template generator from code&#xA;@return string" ilk="function" line="943" lineend="949" name="getErrorMessageTemplate" returns="string" signature="string getErrorMessageTemplate($code)"><variable ilk="argument" line="943" name="code" /></scope><scope doc="Set the Error Message Template array&#xA;&#xA;The array format must be:&#xA;&lt;pre&gt;&#xA;array(error code =&gt; &apos;message template&apos;,...)&#xA;&lt;/pre&gt;&#xA;&#xA;Error message parameters passed into {@link push()} will be used as input&#xA;for the error message.  If the template is &apos;message %foo% was %bar%&apos;, and the&#xA;parameters are array(&apos;foo&apos; =&gt; &apos;one&apos;, &apos;bar&apos; =&gt; &apos;six&apos;), the error message returned will&#xA;be &apos;message one was six&apos;&#xA;@return string" ilk="function" line="965" lineend="968" name="setErrorMessageTemplate" returns="string" signature="string setErrorMessageTemplate($template)"><variable ilk="argument" line="965" name="template" /></scope><scope doc="emulate PEAR::raiseError()&#xA;&#xA;@return PEAR_Error" ilk="function" line="976" lineend="981" name="raiseError" returns="PEAR_Error" signature="PEAR_Error raiseError()"><variable citdl="func_get_args()" line="979" name="args" /></scope></scope><variable citdl="PEAR_ErrorStack.singleton()" line="983" name="stack" /></scope>