var require_min=function(f){require.define("http://dev1.lpcandy.ru/lib/templater/client/style.css",!0),require.define("http://dev1.lpcandy.ru/lib/templater/client/controls/component.js",function(a){var b=window.require.factory(a),c={exports:!1},d={},e=teacss.jQuery,f=window.Component=e.Class.extend({baseId:(new Date).getTime(),load:function(a,b){function h(){e.each(a,function(){this.afterLoad()}),b&&b()}var c=[],d=[];e.each(a,function(){if(!this.type)return;c.push(this),d.push(this.value)});var g=f.request={};c.length?f.app.request("component",{values:JSON.stringify(d)},function(a){if(f.request!=g)return;e.each(c,function(b){this.html=a[b].html,this.form=a[b].form}),h()}):h()},classFromName:function(a){var b=a.split("."),c=b[0],d;c=="ui"?d=teacss.ui:d=window[c];if(d)for(var e=1;e<b.length;e++)d&&(d=d[b[e]]);if(!d)throw new Error("Can't find class for name: "+a);return d}},{init:function(a){this.value=a||{},this.styleControls=[],this.zIndex=100,this.value.id||(this.value.id="id"+ ++this.Class.baseId),this.children=[],a&&a.type&&(this.type=f.app.components[a.type]),this.type=this.type||{}},load:function(a,b){this.parent=a,this.index=b,this.position(),this.html=this.type.new.html,this.form=this.type.new.form,this.afterLoad()},afterLoad:function(a){if(!this.element){this.scripts=[];var b=e.buildFragment([this.html],document,this.scripts);this.element=e(this.html,f.previewFrame.document).eq(0),this.element.attr("id")||this.element.attr("id",this.value.id),this.element.find("br.component-area").remove(),this.element.data("component",this);var c;!this.inherited&&this.parent&&!this.parent.inherited?c=e("<a href='#'>").text(this.type.name).click(function(a){a.preventDefault(),i.changeType()}):c=e("<span>").text(this.type.name);var d=!1;this.parent&&!this.inherited&&!this.parent.inherited&&(d=e("<a href='#' class='close-link'>").text("del").click(function(a){a.preventDefault(),f.previewFrame.select(!1),i.remove()}));var g=!1;this.form&&!this.inherited&&this.parent&&!this.parent.inherited&&(g=e("<a href='#' class='edit-link'>").text("edit").click(function(a){a.preventDefault(),f.previewFrame.select(!1),i.edit()}));var h=!1;!this.inherited&&this.parent&&!this.parent.inherited&&(h=e("<a href='#' class='edit-link'>").text("copy").click(function(a){a.preventDefault(),i.clone()})),this.menu=e("<div>").append(e("<div class='combo-group'>").append(d,h,g,c,"<span>&nbsp;</span>",this.idLink=e("<a href='#'>").text("#"+this.value.id).click(function(a){a.preventDefault(),i.changeId()})))}!this.area&&this.type&&this.type.area&&(this.type.area===!0?this.area=this.element:this.area=this.element.find(this.type.area).eq(0));var i=this;i.componentHandle&&i.componentHandle.detach(),i.parentComponentHandle&&(i.parentComponentHandle.remove(),delete i.parentComponentHandle),this.type&&this.type.area&&(i.parentComponentHandle=e("<div class='parent-component-handle'>").text("Parent").click(function(a){f.previewFrame.select(i,a)})),i.parent?i.componentHandle=e("<div class='component-handle'>").data("component",this).click(function(a){f.previewFrame.select(i,a)}).append(i.headingHandle=e("<div class='component-heading'>").html(this.type.name||"Root"),i.controlsBack=e("<div class='controls-back'>").append(),i.controlsCenter=e("<div class='controls-center'>").append(i.addInsideButton=e("<span>+</span>").attr({title:"Add into this area"}).click(function(a){i.addInside(a)})),i.controlsTop=e("<div class='controls-top'>").append(i.addTopButton=e("<span>+</span>").attr({title:"Add before this component"}).click(function(a){i.addTop(a)})),i.controlsBottom=e("<div class='controls-bottom'>").append(i.addBottomButton=e("<span>+</span>").attr({title:"Add after this component"}).click(function(a){i.addBottom(a)})),i.controlsLeft=e("<div class='controls-left'>").append(),i.controlsRight=e("<div class='controls-right'>").append()):(i.componentHandle=e("<div class='controls-root'>"),i.inherited||i.componentHandle.append(e("<div class='add-section'>").append(e("<span>").text(_t("Add Section")).click(function(a){i.addInside(a)})))),f.previewFrame.handleContainer.append(i.componentHandle),f.previewFrame.handleContainer.append(i.parentComponentHandle),this.area&&this.inherited&&this.menu&&this.menu.append(i.redefineHandle=e("<div class='combo-item'>").html("Redefine").click(function(){f.previewFrame.select(!1),i.redefine()})),this.area&&!this.inherited&&this.parent&&this.parent.inherited&&this.menu&&this.menu.append(e("<div class='combo-item'>").html("Undefine").click(function(){f.previewFrame.select(!1),i.undefine()})),this.parent&&!this.inherited&&!this.parent.inherited&&i.headingHandle.add(i.addTopButton).each(function(){e(this).addClass("draggable"),e(this).data("component",i)}),this.parent&&this.componentHandle.dblclick(function(a){i.selectNext(a)}),this.form&&!this.inherited&&this.parent&&!this.parent.inherited&&i.headingHandle.dblclick(function(){return f.previewFrame.select(!1),i.edit(),!1}),this.parent&&(!this.inherited&&!this.parent.inherited&&i.componentHandle.append(e("<div class='sort-handle'>")),a?a.replaceWith&&(a.replaceWith(this.element),e.each(this.children,function(){i.area.append(this.element)})):this.position(),this.setHandleIndex()),this.type.clientControl&&!this.clientControl&&(i.clientControl=f.classFromName(this.type.clientControl)({cmp:i}),i.clientControl.bind("change",function(){i.value=i.clientControl.getValue(),clearTimeout(i.saveTimeout),i.saveTimeout=setTimeout(function(){f.previewFrame.trigger("change")},500)})),i.clientControl&&i.clientControl.setValue(i.value)},setHandleIndex:function(a,b){this.parent?this.zIndex=this.parent.zIndex+this.parent.children.indexOf(this)+3:this.zIndex=100;var c=this,d=function(){var a=c.element.offset(),b={left:0,top:0};a||(a={}),b||(b={}),c.element.is("body")&&(a.top=0);var d=c.elementScale?c.elementScale.x:1,e=c.elementScale?c.elementScale.y:1,f=c.element.outerWidth(),g=c.element.outerHeight();if(c.parentComponentHandle){var h=Math.floor(a.left-b.left)+"px",i=Math.floor(a.top-b.top+g*e)+"px",j=c.parentComponentHandle[0];j.style.left!=h&&(j.style.left=h),j.style.top!=i&&(j.style.top=i)}if(c.componentHandle){var j=c.componentHandle[0],k={zIndex:c.zIndex,left:Math.floor(a.left-b.left)+"px",top:Math.floor(a.top-b.top)+"px",width:Math.floor(f*d)+"px",height:Math.floor(g*e)+"px"};for(var l in k)j.style[l]!=k[l]&&(j.style[l]=k[l])}};c.element&&(a?d():setTimeout(d,1)),b||e.each(this.children,function(){this.setHandleIndex(a)})},selectNext:function(a){var b=this,c=[],d=[],g=!1;e.each(b.parent.children,function(a,e){e==b?g=!0:g?d.push(e):c.push(e)});var h=d.concat(c);e.each(h,function(b,c){var d=c.element,e=d.offset(),g=d.outerWidth(),h=d.outerHeight(),i=a.pageX,j=a.pageY;if(i>=e.left&&i<=e.left+g&&j>=e.top&&j<=e.top+h)return f.previewFrame.select(c),!1})},position:function(a,b){if(this.parent){var c=this.parent.children.indexOf(this);c>=0&&this.parent.children.splice(c,1)}a&&(this.parent=a,this.index=b);if(this.index===undefined){this.parent.children.push(this),this.parent.area?this.parent.area.append(this.element):console.debug("No area for",this);if(this.scripts&&this.scripts.length){var d=this;setTimeout(function(){var a=f.previewFrame.frame[0].contentWindow.document,b=a.head||a.getElementsByTagName("head")[0],c=teacss.LazyLoad_f(a),e=teacss.queue(1);for(var g=0;g<d.scripts.length;g++){var h=d.scripts[g];h.src?e.defer(function(a,b){c.js([a],function(){b()})},h.src):e.defer(function(c,d){el=a.createElement("script"),el.innerHTML=c,b.appendChild(el),d()},h.innerHTML)}e.await(function(){}),d.scripts=[]},1)}}else{var c=this.parent.children.indexOf(this.index.before||this.index.after);this.index.before?(this.parent.children.splice(c,0,this),this.index.before.element.before(this.element)):(c==this.parent.children.length-1?this.parent.children.push(this):this.parent.children.splice(c+1,0,this),this.index.after.element.after(this.element))}},redefine:function(){this.inherited=!1;for(var a=0;a<this.children.length;a++)this.children[a].remove();this.children=[],this.area.empty(),this.afterLoad(!0),this.redefineHandle.remove(),f.previewFrame.trigger("change")},undefine:function(){this.remove(),f.previewFrame.trigger("change");var a=f.previewFrame;a.setValue(a.getValue())},remove:function(){var a=this.parent.children.indexOf(this);a>=0&&this.parent.children.splice(a,1),this.element.detach(),f.previewFrame.trigger("change"),this.componentHandle.remove();for(var a=0;a<this.children.length;a++)this.children[a].remove();this.removeControls(),f.previewFrame.root.setHandleIndex()},removeControls:function(){this.controls&&this.hasControls&&(e.each(this.controls,function(a,b){if(b.form){var c=b.form.items.indexOf(b);c!=-1&&b.form.items.splice(c,1)}b.element.remove()}),this.hasControls=!1,this.controls=[])},clone:function(){function b(c){var d=e.extend(!0,{},c.value);delete d.id;var g=new f(d);g.html=c.html,g.form=c.form;var h=f.app.settings.theme;return h.cmp&&(h.cmp[g.value.id]=e.extend(!0,{},h.cmp[c.value.id])),a.push(g),e.each(c.children,function(a,c){var d=b(c);d.parent=g,g.children.push(d)}),g}var a=[],c=b(this);c.parent=this.parent,c.afterLoad(),f.previewFrame.dropComponent({type:"after",cmp:this},c),e.each(a,function(a,b){b!=c&&b.afterLoad(),f.previewFrame.componentsHash[b.value.id]=b}),f.previewFrame.select(c),f.previewFrame.trigger("change")},addComponent:function(a,b,c){a.preventDefault();if((c||a.ctrlKey)&&f.app.options.allowSkipType){var d=f.previewFrame.dropComponent({type:b,cmp:this},{create:!0,type:{id:"container"}});f.previewFrame.trigger("change"),f.previewFrame.select(d)}else this.changeType({type:b,cmp:this})},addInside:function(a){this.addComponent(a,"inside",this==f.previewFrame.root)},addTop:function(a){this.addComponent(a,"left",this.parent==f.previewFrame.root)},addBottom:function(a){this.addComponent(a,"right",this.parent==f.previewFrame.root)},changeId:function(){var a,b=this;if(a=prompt("Enter new id",b.value.id))if(a!=b.value.id){var c=!1;e.each(f.app.settings.templates,function(){e.each_deep(this,function(){this&&this.value&&this.value.id==a&&(c=!0)})});if(c)alert("This id is already taken");else{var d=b.value.id;b.value.id=a,b.element.attr("id",a),b.idLink.text("#"+a),b.removeControls();var g=f.app.form.value;e.each(g,function(b,c){this[d]&&(this[a]=this[d],delete this[d])}),f.app.form.setValue(g),f.app.form.trigger("change"),f.app.updateComponentUI(b),f.previewFrame.select(b)}}},changeType:function(a){if(!f.typeDialog){f.typeDialog=teacss.ui.dialog({modal:!0,resizable:!1,draggable:!1,width:600,dialogClass:"change-type-dialog",title:_t("Select component type")});var b=f.app.components,c={};for(var d in b){var g=b[d];c[g.category]||(c[g.category]=[]),c[g.category].push(g)}var h=e("<div style='position:relative !important;'>").addClass("button-select-panel").click(function(a){a.stopPropagation()});f.typeDialog.element.css({padding:0}).append(h),h.append(h=e("<div>"));for(var i in c)h.append("<div class='combo-group'>"+i+"</div>"),e.each(c[i],function(){var a=this,b=e("<div class='combo-item draggable'>").addClass("type-"+a.id).html(a.name).data("component",{create:!0,type:a}).mousedown(function(a){var b=f.typeDialog.handle;if(b&&f.previewFrame.root.children.length==0)return a.preventDefault(),a.stopPropagation(),e(this).click(),!1}).click(function(){var b=f.typeDialog.handle,c=f.typeDialog.cmp,d;if(b)d=f.previewFrame.dropComponent(b,{create:!0,type:a});else{c.hasControls=!1,c.controls=[],c.value={id:c.value.id,type:a.id},c.type=a;var e=c.element;delete c.element,delete c.area,c.html=c.type.new.html,c.form=c.type.new.form,c.afterLoad(e)}f.previewFrame.reloadScript=!0,f.previewFrame.trigger("change"),f.previewFrame.select(d||c),f.previewFrame.reloadTea(),f.typeDialog.close()});a.description&&b.append(e("<small>").html(a.description)),h.append(b)})}f.typeDialog.cmp=this,f.typeDialog.handle=a,f.typeDialog.element.css({maxHeight:e(window).height()*.8}),f.typeDialog.open()},reloadHtml:function(a,b){var c=this;a=a||this.value,f.app.request("component",{values:JSON.stringify([a]),dataSource:f.previewFrame.value.data},function(d){c.html=d[0].html,c.form=d[0].form,c.value=d[0].value||a;var e=c.element;delete c.element,delete c.area,c.afterLoad(e),f.previewFrame.reloadScript=!0,f.previewFrame.reloadTea(),f.previewFrame.trigger("change"),f.previewFrame.select(c),b&&b()})},edit:function(){var a=this;if(!a.dialog){var b=800;a.form&&a.form.control&&a.form.width&&(b=a.form.width),a.dialog=teacss.ui.dialog({modal:!0,resizable:!1,draggable:!1,width:b,title:a.type.name,dialogClass:"component-form",maxHeight:"90%",buttons:{Save:function(){if(a.dialog.control)var b=a.dialog.control.getValue();else var b=e.extend({id:a.value.id,type:a.value.type},a.dialog.element.find(":input").serializeObject());e(this).dialog("close"),a.reloadHtml(b)},Cancel:function(){e(this).dialog("close"),f.previewFrame.select(a)}}}),a.dialog.element.css({overflowY:"scroll",overflowX:"hidden"}),a.dialog.reposition=function(){a.dialog.element.dialog("option","position",{my:"center",at:"center",of:window}),a.dialog.element.css({maxHeight:e(window).height()*.9})},setInterval(a.dialog.reposition,100),a.form&&a.form.control&&(a.dialog.control=f.classFromName(a.form.control)(),a.dialog.push(a.dialog.control))}a.dialog.control?(a.dialog.control.form=a.form,a.dialog.control.setValue(a.value)):(a.dialog.element.html(""),a.dialog.push(a.form),a.dialog.element.each(function(){var a=this;e(a).find("[data-value]").each(function(){function h(a){var b=d.clone();f.before(b),b.find("[name]").each(function(){var b=e(this).attr("name");e(this).attr("name",c+"[item_"+g+"]["+b+"]"),a&&a[b]&&e(this).val(a[b])}),b.find(".remove").click(function(a){a.preventDefault(),b.remove()}),g++}var b=e.parseJSON(e(this).attr("data-value")),c=e(this).attr("data-name"),d=e(this),f=e("<span>");d.removeAttr("data-value"),d.replaceWith(f);var g=0;for(var i=0;i<b.length;i++)h(b[i]);e(a).find(".add[data-name='"+c+"']").click(function(a){a.preventDefault(),h()})})})),a.dialog.open(),f.currentDialog=a.dialog}});return c.exports||d}),require.define("http://dev1.lpcandy.ru/lib/templater/client/controls/previewFrame.js",function(a){var b=window.require.factory(a),c={exports:!1},d={},e=b.dir;return ui.previewFrame=ui.panel.extend({init:function(a){var b=this;this._super(a);var c=e+"/../blank.htm";this.frameWrapper=$("<div>").css({position:"absolute",left:0,right:0,top:0,bottom:0}).appendTo(this.element),this.frame=$("<iframe>",{id:"preview_frame",src:c}).css({width:"100%",height:"100%"}).appendTo(this.frameWrapper),this.frame.on("load",function(){var a=b.window=b.frame[0].contentWindow,c=b.document=a.document,d=b.frame.contents();b.$f=function(a){return teacss.jQuery(a,d)},b.trigger("init"),b.layoutMode(!0);var e=function(a){var c=$(a.target);c.hasClass("draggable")||(c=c.parents(".draggable").eq(0));if(!c.hasClass("draggable"))return;var d=c.data("component");d&&!b.dragging&&(b.dragComponent=d,b.dragPoint={x:a.pageX,y:a.pageY},a.preventDefault())},f=function(a){b.dragComponent=!1,b.dragging&&(b.drop(a),b.dragEnd(a))},g=function(a){b.dragComponent&&!b.dragging&&(Math.abs(a.pageX-b.dragPoint.x)>3||Math.abs(a.pageY-b.dragPoint.y)>3)&&b.dragStart(a,b.dragComponent),b.dragging&&b.dragOver(a)};b.$f(c).mousedown(function(a){b.frame.parent().trigger("mousedown"),e.call(this,a)}),b.$f(c).mouseup(f),b.$f(c).mousemove(function(a){b.frame.parent().trigger(a),g.call(this,a)}),b.dnd_parent_initialized||(b.dnd_parent_initialized=!0,$(document).mousedown(e),$(document).mouseup(f),$(document).mousemove(g)),b.$f(c).bind("contextmenu",function(){return b.select(!1),!1}),b.$f("body").click(function(a){var b=$(a.target);(b.is("[type=submit]")||b.is("[href]"))&&a.preventDefault()}),setInterval(function(a){b.updateHandles()},1e3)}),Component.previewFrame=this},setValue:function(a){function j(a,c,d){c.children&&$.each(c.children,function(){var c=this,f=d;this.value&&this.value.id&&e&&e[this.value.id]&&(c=e[this.value.id].data,f=e[this.value.id].inherit);var g=new Component(this.value);g.parent=a,g.inherited=f,i.push(g),j(g,c,f),b.componentsHash[g.value.id]=g})}var b=this;this._super(a),b.componentsHash={};var c=b.$f;c("head").find("script").remove(),c("body").html("").append(b.handleContainer=$("<div>").addClass("handle-container")),b.dropHandle=!1;var d=b.root=new Component(a.template.value);d.element=c("body"),d.area=c("body");var e=!1,f=a.template,g=!1;if(b.root.value.parentTemplate){e={};function h(a,b){a.value&&a.value.parentTemplate?(h(Component.app.settings.templates[a.value.parentTemplate]||{},!0),a.children&&$.each(a.children,function(){this.value&&this.value.id&&(e[this.value.id]={data:this,inherit:b})})):f=a}h(a.template,!1),g=d.inherited=!0}var i=[];j(d,f,g),b.setLoading(!0),Component.load(i,function(){d.afterLoad(),b.setLoading(!1),b.reloadTea(!1,function(){b.trigger("loaded")})})},getValue:function(){function a(b){var c={};return c.value=b.value,b.children.length&&(c.children=[],$.each(b.children,function(){this&&this.type&&this.type.name&&c.children.push(a(this))})),c}var b;if(this.root.inherited){var c=this.root.children,d=[];function e(a){a.inherited?$.each(a.children,function(){e(this)}):d.push(a)}e(this.root),this.root.children=d,b=a(this.root),this.root.children=c}else b=a(this.root);return{template:b,data:this.value.data}},showHandles:function(a){var b=this;a?b.$f("body").removeClass("hide-handles"):b.$f("body").addClass("hide-handles")},view3dMode:function(a){function c(a,b,d,e){if(b>0){var f=a.parent.element.offset(),g=a.element.offset(),h=a.parent.element.width(),i=a.parent.element.height(),j=(h-20)/h,k=(i-20)/i,l=20+f.left-g.left,m=20+f.top-g.top,n="scale("+j+","+k+") translate(20px,20px)";a.element.css({"-webkit-transform":n,"-moz-transform":n,"-moz-transform-origin":l+"px "+m+"px","-webkit-transform-origin":l+"px "+m+"px"}),d*=j,e*=k,a.elementScale={x:d,y:e}}$.each(a.children,function(){c(this,b+1,d,e)})}var b=this;a?b.$f("body").addClass("view3d"):b.$f("body").removeClass("view3d"),b.view3d&&!a&&($.each(b.componentsHash,function(){var a=this;a.element.add(a.componentHandle).css({"-webkit-transform":"","-moz-transform":""}),a.elementScale=undefined}),b.updateHandles(!0)),a&&!b.view3d&&(c(b.root,-2,1,1),b.updateHandles(!0)),b.view3d=a},layoutMode:function(a){var b=this;this.$f("body").toggleClass("edit-layout",a),this.$f("body").toggleClass("view-layout",!a),!a&&this.layoutModeEnabled&&(b.view3dBackup=b.view3d,b.view3dMode(!1),$(".ui-dialog-content:visible").dialog("close")),a&&!this.layoutModeEnabled&&setTimeout(function(){b.view3dMode(b.view3dBackup)},1),a?b.contentEditableBackup&&b.contentEditableBackup.attr("contenteditable","true"):b.contentEditableBackup=this.$f("[contenteditable]").removeAttr("contenteditable"),this.root&&this.root.setHandleIndex(),this.layoutModeEnabled=a},setLoading:function(a){a?this.$f("body").append("<div class='loading-handle'>"):this.$f(".loading-handle").remove()},reloadTea:function(a,b){function d(){c.processTea("templater_dynamic",Component.app.styles,Component.app.settings.theme.extra_js,a,b)}var c=this;c.window.templaterStaticLoaded||!Component.app.staticStyles||Component.app.staticStyles.length==0?d():c.processTea("templater_static",Component.app.staticStyles,!1,function(){c.window.templaterStaticLoaded=!0,d()}),teacss.files["templater_static.tea"]=teacss.files["templater_static.tea"]||" ",teacss.files["templater_dynamic.tea"]=teacss.files["templater_dynamic.tea"]||" ",teacss.files["templater_makefile.tea"]=teacss.files["templater_makefile.tea"]||"@import 'templater_static.tea';@import 'templater_dynamic.tea';"},processTea:function(a,b,c,d,e){var f=this,g=this.frame,h="";for(var i=0;i<b.length;i++)h+='@import "'+b[i]+'";\n';c&&(h+="Script { @append {\n"+c+"\n}\n"),h+=" ",teacss.image.update=function(){},teacss.files[a+".tea"]=h,teacss.process(a+".tea",function(){teacss.tea.Style.insert(g[0].contentWindow.document),f.reloadScript&&f.$f("head script."+a).remove(),f.reloadScript=!1,teacss.tea.Script.insert(g[0].contentWindow.document),f.$f("head script:not([class*=templater])").addClass(a),f.updateHandles(),e&&e(),teacss.image.getDeferred()?teacss.image.update=function(){f.reloadTea(d)}:d&&d.call&&d()},g[0].contentWindow.document)},updateHandles:function(a){this.root&&this.root.setHandleIndex(a)},select:function(a,b){var c=this,d=Component.app;$("#teacss-layer > .button-select-panel").hide(),b&&b.stopPropagation(),c.$f&&(c.$f(".component-handle").removeClass("selected selected-parent"),c.$f(".controls-handle").removeClass("selected"),c.$f(".parent-component-handle").removeClass("selected-parent")),a&&(a.componentHandle.addClass("selected"),$.each(a.overlayControls||[],function(){a.componentHandle.append(this.element)}),a.addInsideButton.toggleClass("visible",a.area&&!a.inherited?!0:!1),a.addTopButton.toggleClass("visible",a!=c.root&&!a.parent.inherited),a.addBottomButton.toggleClass("visible",a!=c.root&&!a.parent.inherited)),a==c.root&&(a=!1),c.selected=a,a&&a.parent&&a.parent!=c.root&&(a.parent.componentHandle.addClass("selected-parent"),a.parent.parentComponentHandle&&a.parent.parentComponentHandle.addClass("selected-parent")),c.contextMenu||(c.contextMenu=$("<div>").addClass("context-menu button-select-panel"),c.contextMenu.appendTo(d.componentPanel.element),c.contextMenu.click(function(a){a.stopPropagation()}),c.contextMenu.data("combo",c.contextMenu),c.contextMenu.getParentCombo=function(){return!1},c.contextStyles=ui.fieldset(),c.contextStyles.element.css({padding:10}));if(a){Component.app.updateComponentUI(a),c.contextStyles.element.children().detach(),c.contextMenu.children().detach(),c.contextMenu.append(a.menu),c.contextMenu.show(),d.stylePanel.element.hide(),d.breadcrumbs.show().empty();var e=a;while(e)d.breadcrumbs.prepend(" > ",$("<a href='#'>").text(e.value.type).click(e,function(a){a.preventDefault(),c.select(a.data,a)})),e=e.parent,e==c.root&&(e=!1);var f=a.controls;a.controls&&a.controls.length&&(c.contextMenu.append(c.contextStyles.element),$.each(a.controls,function(){this.options.cmp=a,this.options.position?a[this.options.position].append(this.element):(c.contextStyles.push(this),this.options.comboDirection=="default"&&(this.options.comboDirection="right"))}))}else c.contextMenu.hide(),d.breadcrumbs.hide(),d.stylePanel.element.show()},initDragScroll:function(){var a=this;if(!a.dragScroll){a.dragScroll={top:$("<div>").css({top:0}),bottom:$("<div>").css({bottom:0})};var b=a.dragScroll.both=$(a.dragScroll.top).add(a.dragScroll.bottom),c,d;b.css({position:"fixed",left:0,right:0,height:20,zIndex:99999}),b.bind("mousemove",function(b){if(a.dragging){if(a.$f("html,body").is(":animated"))return!0;var e=a.frame[0].contentWindow,f=e.document,g=$(e).scrollTop(),h=parseInt($(this).css("top"))==0?-1:1,i=h==-1?c:d,j=h==-1?g:$(f).height()-(g+$(e).height());if(i!=undefined&&i==j&&j>0){var k=g+h*50;a.$f("html,body").animate({scrollTop:k},0,"linear")}return h==-1?c=j:d=j,!0}$(this).hide()})}a.dragScroll.both.appendTo(a.$f("body"));var e=a.frame[0].contentWindow,f=e.document;$(f).height()>$(e).height()?a.dragScroll.both.show():a.dragScroll.both.hide()},dragStart:function(a,b){var c=this;if(!c.$f)return;c.dragging=!0,c.initDragScroll(),c.Class.draggable=c.draggable=b,Component.typeDialog&&Component.typeDialog.close(),c.view3dBackupDrag=c.view3d,c.view3dMode(!0),c.$f("body").addClass("dragging"),c.$f(".controls-handle").addClass("hidden")},dragEnd:function(){var a=this;a.dragging=!1,a.$f("body").removeClass("dragging"),a.$f(".controls-handle").removeClass("hidden"),a.$f(".sort-handle").removeClass("visible"),a.$f(".area-handle").removeClass("visible"),a.dragScroll&&a.dragScroll.both.hide(),a.view3dMode(a.view3dBackupDrag)},dragOver:function(a){function b(a){return a*a}function c(a,c){return b(a.x-c.x)+b(a.y-c.y)}function d(a,b,d){var e=c(b,d);if(e==0)return c(a,b);var f=((a.x-b.x)*(d.x-b.x)+(a.y-b.y)*(d.y-b.y))/e;return f<0?c(a,b):f>1?c(a,d):c(a,{x:b.x+f*(d.x-b.x),y:b.y+f*(d.y-b.y)})}function f(b){var c=d({x:a.pageX,y:a.pageY},{x:b.x0,y:b.y0},{x:b.x1,y:b.y1});if(!e||c<e.dist)b.dist=c,e=b}if(!this.dragging)return;a.preventDefault();var e=!1,g=this,h=[g.root];$.each(g.componentsHash,function(){if(this.parent&&this.parent.inherited)return;var a=this.parent;while(a){if(a==g.draggable)return;a=a.parent}h.push(this)}),$.each(h,function(){var a=this,b=a.element;if(!b)return;if(a==g.root)return;var c=b.offset(),d=c.left,e=c.top,h=c.left+b.width(),i=c.top+b.height();f({x0:d,y0:e,x1:h,y1:e,cmp:a,type:"top"}),f({x0:d,y0:e,x1:d,y1:i,cmp:a,type:"left"}),f({x0:h,y0:e,x1:h,y1:i,cmp:a,type:"right"}),f({x0:d,y0:i,x1:h,y1:i,cmp:a,type:"bottom"})}),$.each(h,function(){var b=this;if(this.inherited)return;if(this.area&&this.children.length==0){var c=this.area,d=c.offset();if(!d)return;var f=c.outerWidth(),g=c.outerHeight(),h=d.left,i=d.top,j=d.left+f,k=d.top+g;if(a.pageX>h&&a.pageY>i&&a.pageX<j&&a.pageY<k){var l=f*g;if(!e||e.type!="inside"||l<e.dist)e={type:"inside",cmp:b,dist:l,x0:h,y0:i,x1:j,y1:k}}}}),e.cmp==g.draggable&&(e=!1),e?(g.dropHandle||(g.dropHandle=$("<div>").addClass("drop-marker").appendTo(g.handleContainer)),g.dropHandle.stop().show().css({opacity:1,left:e.x0,top:e.y0,width:e.x1-e.x0,height:e.y1-e.y0}),e.type!="inside"?g.dropHandle.addClass("flat"):g.dropHandle.removeClass("flat"),g.dropHandle.min=e):g.dropHandle&&g.dropHandle.hide()},dropComponent:function(a,b){var c=this,d=a.cmp;if(b==d)return;var e=d.parent,f;a.type=="inside"&&(e=d);if(a.type=="left"||a.type=="top")f={before:d};a.type=="right"&&(f={after:d}),a.type=="bottom"&&(f={after:d});if(b.create){var g=new Component({type:b.type.id});g.load(e,f),c.componentsHash[g.value.id]=g}else g=b,b.position(e,f);return c.root.setHandleIndex(),setTimeout(function(){c.reloadTea()},1),c.select(c.selected),g},drop:function(a){var b=this;b.dragging=!1,a.preventDefault();if(!b.dropHandle||!b.dropHandle.min)return;var c=b.dropHandle.min,d=b.draggable;if(d==c.cmp)return;var e=b.dropComponent(c,d);b.trigger("change"),setTimeout(function(){var a=e.element,c=a.offset();b.dropHandle.stop().removeClass("flat").css({opacity:1}).animate({left:c.left,top:c.top,width:a.outerWidth(),height:a.outerHeight()},600).animate({opacity:0},1e3,function(){b.dropHandle.hide()})},1)}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/lib/templater/client/controls/serializeObject.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return function(a){a.fn.serializeObject=function(){var b=this,c={},d={},e={validate:/^[a-zA-Z][a-zA-Z0-9_-]*(?:\[(?:\d*|[a-zA-Z0-9_-]+)\])*$/,key:/[a-zA-Z0-9_-]+|(?=\[\])/g,push:/^$/,fixed:/^\d+$/,named:/^[a-zA-Z0-9_-]+$/};return this.build=function(a,b,c){return a[b]=c,a},this.push_counter=function(a){return d[a]===undefined&&(d[a]=0),d[a]++},a.each(a(this).serializeArray(),function(){if(!e.validate.test(this.name))return;var d,f=this.name.match(e.key),g=this.value,h=this.name;while((d=f.pop())!==undefined)h=h.replace(new RegExp("\\["+d+"\\]$"),""),d.match(e.push)?g=b.build([],b.push_counter(h),g):d.match(e.fixed)?g=b.build([],d,g):d.match(e.named)&&(g=b.build({},d,g));c=a.extend(!0,c,g)}),c}}(teacss.jQuery),c.exports||d}),require.define("http://dev1.lpcandy.ru/lib/templater/client/controls/rasterizeHTML.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return!function(a){if("object"==typeof d)c.exports=a();else if("function"==typeof define&&define.amd)define(a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.rasterizeHTML=a()}}(function(){var a;return function c(a,d,e){function f(h,i){if(!d[h]){if(!a[h]){var j="function"==typeof b&&b;if(!i&&j)return j(h,!0);if(g)return g(h,!0);throw new Error("Cannot find module '"+h+"'")}var k=d[h]={exports:{}};a[h][0].call(k.exports,function(b){var c=a[h][1][b];return f(c?c:b)},k,k.exports,c,a,d,e)}return d[h].exports}for(var g="function"==typeof b&&b,h=0;h<e.length;h++)f(e[h]);return f}({1:[function(b,c,d){!function(e,f){"object"==typeof d?c.exports=f(b("url"),b("xmlserializer"),b("ayepromise"),b("inlineresources")):"function"==typeof a&&a.amd?a(["url","xmlserializer","ayepromise","inlineresources"],f):e.rasterizeHTML=f(e.url,e.xmlserializer,e.ayepromise,e.inlineresources)}(this,function(a,b,c,d){var e=function(a){"use strict";var b={},c=[];b.joinUrl=function(b,c){return b?a.resolve(b,c):c},b.getConstantUniqueIdFor=function(a){return c.indexOf(a)<0&&c.push(a),c.indexOf(a)},b.clone=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c};var d=function(a){return"object"==typeof a&&null!==a},e=function(a){return d(a)&&Object.prototype.toString.apply(a).match(/\[object (Canvas|HTMLCanvasElement)\]/i)},f=function(a){return"function"==typeof a};return b.parseOptionalParameters=function(a){var c={canvas:null,options:{},callback:null};return f(a[0])?c.callback=a[0]:null==a[0]||e(a[0])?(c.canvas=a[0]||null,f(a[1])?c.callback=a[1]:(c.options=b.clone(a[1]),c.callback=a[2]||null)):(c.options=b.clone(a[0]),c.callback=a[1]||null),c},b}(a),f=function(a,b){var c={};return c.baseUrlRespecting=function(b,c){var d=function(){var d=new b,e=d.open;return d.open=function(){var b=Array.prototype.slice.call(arguments),d=b.shift(),f=b.shift(),g=a.joinUrl(c,f);return e.apply(this,[d,g].concat(b))},d};return d},c.finishNotifying=function(a){var c=0,d=0,e=!1,f=b.defer(),g=function(){var a=c-d;0>=a&&e&&f.resolve({totalCount:c})},h=function(){var b=new a,e=b.send;return b.send=function(){return c+=1,e.apply(this,arguments)},b.addEventListener("load",function(){d+=1,g()}),b};return h.waitForRequestsToFinish=function(){return e=!0,g(),f.promise},h},c}(e,c),g=function(){"use strict";var a={},b=function(a){return Array.prototype.slice.call(a)};a.addClassNameRecursively=function(b,c){b.className+=" "+c,b.parentNode!==b.ownerDocument&&a.addClassNameRecursively(b.parentNode,c)};var c=function(a,c){var d=a.parentStyleSheet,e=b(d.cssRules).indexOf(a);d.insertRule(c,e+1),d.deleteRule(e)},d=function(a,b){var d=a.cssText.replace(/^[^\{]+/,""),e=b+" "+d;c(a,e)},e=function(a){return b(a).reduce(function(a,b){return a+b.cssText},"")},f=function(a){a.textContent=e(a.sheet.cssRules)};return a.rewriteStyleRuleSelector=function(a,c,e){var g=c+"(?=\\W|$)";b(a.querySelectorAll("style")).forEach(function(a){var c=b(a.sheet.cssRules).filter(function(a){return a.selectorText&&(new RegExp(g)).test(a.selectorText)});c.length&&(c.forEach(function(a){var b=a.selectorText.replace(new RegExp(g,"g"),e);d(a,b)}),f(a))})},a}(),h=function(a){"use strict";var b={},c=function(a){return Array.prototype.slice.call(a)};return b.fakeHover=function(b,c){var d=b.querySelector(c),e="rasterizehtmlhover";d&&(a.addClassNameRecursively(d,e),a.rewriteStyleRuleSelector(b,":hover","."+e))},b.fakeActive=function(b,c){var d=b.querySelector(c),e="rasterizehtmlactive";d&&(a.addClassNameRecursively(d,e),a.rewriteStyleRuleSelector(b,":active","."+e))},b.persistInputValues=function(a){var b=a.querySelectorAll("input"),d=a.querySelectorAll("textarea"),e=function(a){return"checkbox"===a.type||"radio"===a.type};c(b).filter(e).forEach(function(a){a.checked?a.setAttribute("checked",""):a.removeAttribute("checked")}),c(b).filter(function(a){return!e(a)}).forEach(function(a){a.setAttribute("value",a.value)}),c(d).forEach(function(a){a.textContent=a.value})},b}(g),i=function(a,b,c,d){"use strict";var e={},f=function(a,b,c,d){var e=a.createElement(b);return e.style.visibility="hidden",e.style.width=c+"px",e.style.height=d+"px",e.style.position="absolute",e.style.top=-1e4-d+"px",e.style.left=-1e4-c+"px",a.getElementsByTagName("body")[0].appendChild(e),e};e.executeJavascript=function(a,e){var g=f(d.document,"iframe",e.width,e.height),h=a.documentElement.outerHTML,i=[],j=c.defer(),k=e.executeJsTimeout||0,l=function(){var a=g.contentDocument;d.document.getElementsByTagName("body")[0].removeChild(g),j.resolve({document:a,errors:i})},m=function(){var a=c.defer();return k>0?setTimeout(a.resolve,k):a.resolve(),a.promise};g.onload=function(){m().then(o.waitForRequestsToFinish).then(l)};var n=g.contentWindow.XMLHttpRequest,o=b.finishNotifying(n),p=b.baseUrlRespecting(o,e.baseUrl);return g.contentDocument.open(),g.contentWindow.XMLHttpRequest=p,g.contentWindow.onerror=function(a){i.push({resourceType:"scriptExecution",msg:a})},g.contentDocument.write(h),g.contentDocument.close(),j.promise};var g=function(a,b,c){var d=a.createElement("iframe");return d.style.width=b+"px",d.style.height=c+"px",d.style.visibility="hidden",d.style.position="absolute",d.style.top=-1e4-c+"px",d.style.left=-1e4-b+"px",d.sandbox="allow-same-origin",d},h=function(a,b,c){var e=Math.floor(a/c),f=Math.floor(b/c);return g(d.document,e,f)},i=function(a,b,c,d){return{width:Math.max(a.width*d,b),height:Math.max(a.height*d,c)}},j=function(a,b,c,d,e){var f,g,h,j,k,l,m,n=Math.max(a.documentElement.scrollWidth,a.body.clientWidth),o=Math.max(a.documentElement.scrollHeight,a.body.scrollHeight,a.body.clientHeight);if(b){if(k=a.querySelector(b),!k)throw{message:"Clipping selector not found"};l=k.getBoundingClientRect(),f=l.top,g=l.left,h=l.width,j=l.height}else f=0,g=0,h=n,j=o;return m=i({width:h,height:j},c,d,e),{left:g,top:f,width:m.width,height:m.height,viewportWidth:n,viewportHeight:o}};e.calculateDocumentContentSize=function(a,b){var e,f=a.documentElement.outerHTML,g=c.defer(),i=b.zoom||1;return e=h(b.width,b.height,i),d.document.getElementsByTagName("body")[0].appendChild(e),e.onload=function(){var a,c=e.contentDocument;try{a=j(c,b.clip,b.width,b.height,i),d.document.getElementsByTagName("body")[0].removeChild(e),g.resolve(a)}catch(f){g.reject(f)}},e.contentDocument.open(),e.contentDocument.write(f),e.contentDocument.close(),g.promise};var k=function(a,b){var c,e,f,g,h=/<html((?:\s+[^>]*)?)>/im.exec(b),i=d.document.implementation.createHTMLDocument("");if(h)for(c="<div"+h[1]+"></div>",i.documentElement.innerHTML=c,f=i.querySelector("div"),e=0;e<f.attributes.length;e++)g=f.attributes[e],a.documentElement.setAttribute(g.name,g.value)};e.parseHTML=function(a){var b;return(new DOMParser).parseFromString("<a></a>","text/html")?b=(new DOMParser).parseFromString(a,"text/html"):(b=d.document.implementation.createHTMLDocument(""),b.documentElement.innerHTML=a,k(b,a)),b};var l=function(a){var b=new DOMParser,c=b.parseFromString("<","text/xml"),d=c.getElementsByTagName("parsererror")[0].namespaceURI;return"http://www.w3.org/1999/xhtml"===d?a.getElementsByTagName("parsererror").length>0:a.getElementsByTagNameNS(d,"parsererror").length>0},m=function(a){if(l(a))throw{message:"Invalid source"}};e.validateXHTML=function(a){var b=new DOMParser,c=b.parseFromString(a,"application/xml");m(c)};var n=null,o=function(a,b){return b===!1||"none"===b||"repeated"===b?((null===n||"repeated"!==b)&&(n=Date.now()),a+"?_="+n):a},p=function(b,d){var e=new window.XMLHttpRequest,f=a.joinUrl(d.baseUrl,b),g=o(f,d.cache),h=c.defer(),i=function(){h.reject({message:"Unable to load page"})};e.addEventListener("load",function(){200===e.status||0===e.status?h.resolve(e.responseXML):i()},!1),e.addEventListener("error",function(){i()},!1);try{e.open("GET",g,!0),e.responseType="document",e.send(null)}catch(j){i()}return h.promise};return e.loadDocument=function(a,b){return p(a,b).then(function(a){return m(a),a})},e}(e,f,c,window),j=function(a,b,c,d,e,f){"use strict";var g={},h=function(){if(f.navigator.userAgent.indexOf("WebKit")>=0&&f.navigator.userAgent.indexOf("Chrome")<0)return!1;if(f.BlobBuilder||f.MozBlobBuilder||f.WebKitBlobBuilder)return!0;if(f.Blob)try{return new f.Blob(["<b></b>"],{type:"text/xml"}),!0}catch(a){return!1}return!1},i=function(a){var b,c="image/svg+xml;charset=utf-8",d=f.BlobBuilder||f.MozBlobBuilder||f.WebKitBlobBuilder;return d?(b=new d,b.append(a),b.getBlob(c)):new f.Blob([a],{type:c})},j=function(a){var b=f.URL||f.webkitURL||f;return h()?b.createObjectURL(i(a)):"data:image/svg+xml;charset=utf-8,"+encodeURIComponent(a)},k=function(a){var b=f.URL||f.webkitURL||f;h()&&b.revokeObjectURL(a)},l=function(a,b){var c,d,e,f;b=b||1,c=Math.round(a.viewportWidth),d=Math.round(a.viewportHeight),e=-a.left,f=-a.top;var g={x:e,y:f,width:c,height:d};return 1!==b&&(g.style="-webkit-transform: scale("+b+"); -webkit-transform-origin: 0 0; transform: scale("+b+"); transform-origin: 0 0;"),g},m=function(a){var b=a.style||"";a.style=b+"float: left;"},n=function(a){var b=Object.keys(a);return b.length?" "+b.map(function(b){return b+'="'+a[b]+'"'}).join(" "):""};g.getSvgForDocument=function(a,c,e){var f;f=d.serializeToString(a),b.validateXHTML(f);var g=l(c,e);return m(g),'<svg xmlns="http://www.w3.org/2000/svg" width="'+c.width+'" height="'+c.height+'"><foreignObject'+n(g)+">"+f+"</foreignObject></svg>"};var o=function(){return{message:"Error rendering page"}};return g.renderSvg=function(a){var b,c,d=e.defer(),g=function(){c.onload=null,c.onerror=null},h=function(){b&&k(b)};return b=j(a),c=new f.Image,c.onload=function(){g(),h(),d.resolve(c)},c.onerror=function(){h(),d.reject(o())},c.src=b,d.promise},g.drawImageOnCanvas=function(a,b){try{b.getContext("2d").drawImage(a,0,0)}catch(c){throw o()}},g.drawDocumentImage=function(a,d){return d.hover&&c.fakeHover(a,d.hover),d.active&&c.fakeActive(a,d.active),b.calculateDocumentContentSize(a,d).then(function(b){return g.getSvgForDocument(a,b,d.zoom)}).then(function(a){return g.renderSvg(a)})},g}(e,i,h,b,c,window),k=function(a,b,c,d,e){"use strict";var f={},g=function(a,b,c){return d.drawDocumentImage(a,c).then(function(a){return b&&d.drawImageOnCanvas(a,b),a})},h=function(a,d){return b.executeJavascript(a,d).then(function(a){var b=a.document;return c.persistInputValues(b),{document:b,errors:a.errors}})};return f.rasterize=function(b,c,d){var f;return f=a.clone(d),f.inlineScripts=d.executeJs===!0,e.inlineReferences(b,f).then(function(a){return d.executeJs?h(b,d).then(function(b){return{document:b.document,errors:a.concat(b.errors)}}):{document:b,errors:a}}).then(function(a){return g(a.document,c,d).then(function(b){return{image:b,errors:a.errors}})})},f}(e,i,h,j,d),l=function(a,b,c){"use strict";var d={},e=function(a,b){var c=300,d=200,e=a?a.width:c,f=a?a.height:d,g=void 0!==b.width?b.width:e,h=void 0!==b.height?b.height:f;return{width:g,height:h}},f=function(b){var c,d=e(b.canvas,b.options);return c=a.clone(b.options),c.width=d.width,c.height=d.height,c};d.drawDocument=function(){var b=arguments[0],d=Array.prototype.slice.call(arguments,1),e=a.parseOptionalParameters(d),g=c.rasterize(b,e.canvas,f(e));return e.callback&&g.then(function(a){e.callback(a.image,a.errors)},function(){e.callback(null,[{resourceType:"document",msg:"Error rendering page"}])}),g};var g=function(a,c,e,f){var g=b.parseHTML(a);return d.drawDocument(g,c,e,f)};d.drawHTML=function(){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=a.parseOptionalParameters(c);return g(b,d.canvas,d.options,d.callback)};var h=function(b,c,d){var e=document.implementation.createHTMLDocument("");e.replaceChild(b.documentElement,e.documentElement);var f=d?a.clone(d):{};return d.baseUrl||(f.baseUrl=c),{document:e,options:f}},i=function(a,c,e,f){var g=b.loadDocument(a,e).then(function(b){var f=h(b,a,e);return d.drawDocument(f.document,c,f.options)});return f&&g.then(function(a){f(a.image,a.errors)},function(b){f(null,[{resourceType:"page",url:a,msg:b.message+" "+a}])}),g};return d.drawURL=function(){var b=arguments[0],c=Array.prototype.slice.call(arguments,1),d=a.parseOptionalParameters(c);return i(b,d.canvas,d.options,d.callback)},d}(e,i,k);return l})},{ayepromise:2,inlineresources:30,url:"j37I/u",xmlserializer:37}],2:[function(b,c,d){!function(b,e){"function"==typeof a&&a.amd?a(e):"object"==typeof d?c.exports=e():b.ayepromise=e()}(this,function(){"use strict";var a={},b=function(){var a=!1;return function(b){return function(){a||(a=!0,b.apply(null,arguments))}}},c=function(a){var b=a&&a.then;return"object"==typeof a&&"function"==typeof b?function(){return b.apply(a,arguments)}:void 0},d=function(b,c){var d=a.defer(),e=function(a,b){setTimeout(function(){var c;try{c=a(b)}catch(e){return void d.reject(e)}c===d.promise?d.reject(new TypeError("Cannot resolve promise with itself")):d.resolve(c)},1)},g=function(a){b&&b.call?e(b,a):d.resolve(a)},h=function(a){c&&c.call?e(c,a):d.reject(a)};return{promise:d.promise,handle:function(a,b){a===f?g(b):h(b)}}},e=0,f=1,g=2;return a.defer=function(){var a,h=e,i=[],j=function(b,c){h=b,a=c,i.forEach(function(b){b.handle(h,a)}),i=null},k=function(a){j(f,a)},l=function(a){j(g,a)},m=function(b,c){var f=d(b,c);return h===e?i.push(f):f.handle(h,a),f.promise},n=function(a){var c=b();try{a(c(o),c(l))}catch(d){c(l)(d)}},o=function(a){var b;try{b=c(a)}catch(d){return void l(d)}b?n(b):k(a)},p=b();return{resolve:p(o),reject:p(l),promise:{then:m,fail:function(a){return m(null,a)}}}},a})},{}],3:[function(b,c,d){((function(b){!function(e){function f(a){throw RangeError(I[a])}function g(a,b){for(var c=a.length;c--;)a[c]=b(a[c]);return a}function h(a,b){return g(a.split(H),b).join(".")}function i(a){for(var b,c,d=[],e=0,f=a.length;f>e;)b=a.charCodeAt(e++),b>=55296&&56319>=b&&f>e?(c=a.charCodeAt(e++),56320==(64512&c)?d.push(((1023&b)<<10)+(1023&c)+65536):(d.push(b),e--)):d.push(b);return d}function j(a){return g(a,function(a){var b="";return a>65535&&(a-=65536,b+=L(a>>>10&1023|55296),a=56320|1023&a),b+=L(a)}).join("")}function k(a){return 10>a-48?a-22:26>a-65?a-65:26>a-97?a-97:x}function l(a,b){return a+22+75*(26>a)-((0!=b)<<5)}function m(a,b,c){var d=0;for(a=c?K(a/B):a>>1,a+=K(a/b);a>J*z>>1;d+=x)a=K(a/J);return K(d+(J+1)*a/(a+A))}function n(a){var b,c,d,e,g,h,i,l,n,o,p=[],q=a.length,r=0,s=D,t=C;for(c=a.lastIndexOf(E),0>c&&(c=0),d=0;c>d;++d)a.charCodeAt(d)>=128&&f("not-basic"),p.push(a.charCodeAt(d));for(e=c>0?c+1:0;q>e;){for(g=r,h=1,i=x;e>=q&&f("invalid-input"),l=k(a.charCodeAt(e++)),(l>=x||l>K((w-r)/h))&&f("overflow"),r+=l*h,n=t>=i?y:i>=t+z?z:i-t,!(n>l);i+=x)o=x-n,h>K(w/o)&&f("overflow"),h*=o;b=p.length+1,t=m(r-g,b,0==g),K(r/b)>w-s&&f("overflow"),s+=K(r/b),r%=b,p.splice(r++,0,s)}return j(p)}function o(a){var b,c,d,e,g,h,j,k,n,o,p,q,r,s,t,u=[];for(a=i(a),q=a.length,b=D,c=0,g=C,h=0;q>h;++h)p=a[h],128>p&&u.push(L(p));for(d=e=u.length,e&&u.push(E);q>d;){for(j=w,h=0;q>h;++h)p=a[h],p>=b&&j>p&&(j=p);for(r=d+1,j-b>K((w-c)/r)&&f("overflow"),c+=(j-b)*r,b=j,h=0;q>h;++h)if(p=a[h],b>p&&++c>w&&f("overflow"),p==b){for(k=c,n=x;o=g>=n?y:n>=g+z?z:n-g,!(o>k);n+=x)t=k-o,s=x-o,u.push(L(l(o+t%s,0))),k=K(t/s);u.push(L(l(k,0))),g=m(c,r,d==e),c=0,++d}++c,++b}return u.join("")}function p(a){return h(a,function(a){return F.test(a)?n(a.slice(4).toLowerCase()):a})}function q(a){return h(a,function(a){return G.test(a)?"xn--"+o(a):a})}var r="object"==typeof d&&d,s="object"==typeof c&&c&&c.exports==r&&c,t="object"==typeof b&&b;(t.global===t||t.window===t)&&(e=t);var u,v,w=2147483647,x=36,y=1,z=26,A=38,B=700,C=72,D=128,E="-",F=/^xn--/,G=/[^ -~]/,H=/\x2E|\u3002|\uFF0E|\uFF61/g,I={overflow:"Overflow: input needs wider integers to process","not-basic":"Illegal input >= 0x80 (not a basic code point)","invalid-input":"Invalid input"},J=x-y,K=Math.floor,L=String.fromCharCode;if(u={version:"1.2.4",ucs2:{decode:i,encode:j},decode:n,encode:o,toASCII:q,toUnicode:p},"function"==typeof a&&"object"==typeof a.amd&&a.amd)a("punycode",function(){return u});else if(r&&!r.nodeType)if(s)s.exports=u;else for(v in u)u.hasOwnProperty(v)&&(r[v]=u[v]);else e.punycode=u}(this)})).call(this,"undefined"!=typeof self?self:"undefined"!=typeof window?window:{})},{}],4:[function(a,b){function c(a,b){return Object.prototype.hasOwnProperty.call(a,b)}"use strict",b.exports=function(a,b,e,f){b=b||"&",e=e||"=";var g={};if("string"!=typeof a||0===a.length)return g;var h=/\+/g;a=a.split(b);var i=1e3;f&&"number"==typeof f.maxKeys&&(i=f.maxKeys);var j=a.length;i>0&&j>i&&(j=i);for(var k=0;j>k;++k){var l,m,n,o,p=a[k].replace(h,"%20"),q=p.indexOf(e);q>=0?(l=p.substr(0,q),m=p.substr(q+1)):(l=p,m=""),n=decodeURIComponent(l),o=decodeURIComponent(m),c(g,n)?d(g[n])?g[n].push(o):g[n]=[g[n],o]:g[n]=o}return g};var d=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)}},{}],5:[function(a,b){function c(a,b){if(a.map)return a.map(b);for(var c=[],d=0;d<a.length;d++)c.push(b(a[d],d));return c}"use strict";var d=function(a){switch(typeof a){case"string":return a;case"boolean":return a?"true":"false";case"number":return isFinite(a)?a:"";default:return""}};b.exports=function(a,b,g,h){return b=b||"&",g=g||"=",null===a&&(a=void 0),"object"==typeof a?c(f(a),function(c){var f=encodeURIComponent(d(c))+g;return e(a[c])?a[c].map(function(a){return f+encodeURIComponent(d(a))}).join(b):f+encodeURIComponent(d(a[c]))}).join(b):h?encodeURIComponent(d(h))+g+encodeURIComponent(d(a)):""};var e=Array.isArray||function(a){return"[object Array]"===Object.prototype.toString.call(a)},f=Object.keys||function(a){var b=[];for(var c in a)Object.prototype.hasOwnProperty.call(a,c)&&b.push(c);return b}},{}],6:[function(a,b,c){"use strict",c.decode=c.parse=a("./decode"),c.encode=c.stringify=a("./encode")},{"./decode":4,"./encode":5}],7:[function(a,b){b.exports=function(){function b(a,b){function c(){this.constructor=a}c.prototype=b.prototype,a.prototype=new c}function c(a,b,c,d,e,f){this.message=a,this.expected=b,this.found=c,this.offset=d,this.line=e,this.column=f,this.name="SyntaxError"}function d(b){function d(a){function c(a,c,d){var e,f;for(e=c;d>e;e++)f=b.charAt(e),"\n"===f?(a.seenCR||a.line++,a.column=1,a.seenCR=!1):"\r"===f||"\u2028"===f||"\u2029"===f?(a.line++,a.column=1,a.seenCR=!0):(a.column++,a.seenCR=!1)}return T!==a&&(T>a&&(T=0,U={line:1,column:1,seenCR:!1}),c(U,T,a),T=a),U}function e(a){V>R||(R>V&&(V=R,W=[]),W.push(a))}function f(a,e,f){function g(a){var b=1;for(a.sort(function(a,b){return a.description<b.description?-1:a.description>b.description?1:0});b<a.length;)a[b-1]===a[b]?a.splice(b,1):b++}function h(a,b){function c(a){function b(a){return a.charCodeAt(0).toString(16).toUpperCase()}return a.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\x08/g,"\\b").replace(/\t/g,"\\t").replace(/\n/g,"\\n").replace(/\f/g,"\\f").replace(/\r/g,"\\r").replace(/[\x00-\x07\x0B\x0E\x0F]/g,function(a){return"\\x0"+b(a)}).replace(/[\x10-\x1F\x80-\xFF]/g,function(a){return"\\x"+b(a)}).replace(/[\u0180-\u0FFF]/g,function(a){return"\\u0"+b(a)}).replace(/[\u1080-\uFFFF]/g,function(a){return"\\u"+b(a)})}var d,e,f,g=new Array(a.length);for(f=0;f<a.length;f++)g[f]=a[f].description;return d=a.length>1?g.slice(0,-1).join(", ")+" or "+g[a.length-1]:g[0],e=b?'"'+c(b)+'"':"end of input","Expected "+d+" but "+e+" found."}var i=d(f),j=f<b.length?b.charAt(f):null;return null!==e&&g(e),new c(null!==a?a:h(e,j),e,j,f,i.line,i.column)}function g(){var a,b;return a=h(),a===r&&(a=R,b=[],b!==r&&(S=a,b=u()),a=b),a}function h(){var a,c,d,f,g,j;if(a=R,c=i(),c!==r){for(d=[],f=o();f!==r;)d.push(f),f=o();if(d!==r)if(44===b.charCodeAt(R)?(f=w,R++):(f=r,0===X&&e(x)),f!==r){for(g=[],j=o();j!==r;)g.push(j),j=o();g!==r?(j=h(),j!==r?(S=a,c=y(c,j),a=c):(R=a,a=v)):(R=a,a=v)}else R=a,a=v;else R=a,a=v}else R=a,a=v;return a===r&&(a=R,c=i(),c!==r&&(S=a,c=z(c)),a=c),a}function i(){var a;return a=j(),a===r&&(a=m()),a}function j(){var a,b,c,d;if(a=R,b=k(),b!==r){if(c=[],d=o(),d!==r)for(;d!==r;)c.push(d),d=o();else c=v;c!==r?(d=l(),d!==r?(S=a,b=A(b,d),a=b):(R=a,a=v)):(R=a,a=v)}else R=a,a=v;return a===r&&(a=R,b=k(),b!==r&&(S=a,b=B(b)),a=b),a}function k(){var a,c,d,f;return a=R,b.substr(R,4)===C?(c=C,R+=4):(c=r,0===X&&e(D)),c!==r?(d=n(),d!==r?(41===b.charCodeAt(R)?(f=E,R++):(f=r,0===X&&e(F)),f!==r?(S=a,c=G(d),a=c):(R=a,a=v)):(R=a,a=v)):(R=a,a=v),a}function l(){var a,c,d,f;return a=R,b.substr(R,7)===H?(c=H,R+=7):(c=r,0===X&&e(I)),c!==r?(d=n(),d!==r?(41===b.charCodeAt(R)?(f=E,R++):(f=r,0===X&&e(F)),f!==r?(S=a,c=G(d),a=c):(R=a,a=v)):(R=a,a=v)):(R=a,a=v),a}function m(){var a,c,d,f;return a=R,b.substr(R,6)===J?(c=J,R+=6):(c=r,0===X&&e(K)),c!==r?(d=n(),d!==r?(41===b.charCodeAt(R)?(f=E,R++):(f=r,0===X&&e(F)),f!==r?(S=a,c=L(d),a=c):(R=a,a=v)):(R=a,a=v)):(R=a,a=v),a}function n(){var a,c,d;if(a=R,c=[],M.test(b.charAt(R))?(d=b.charAt(R),R++):(d=r,0===X&&e(N)),d!==r)for(;d!==r;)c.push(d),M.test(b.charAt(R))?(d=b.charAt(R),R++):(d=r,0===X&&e(N));else c=v;return c!==r&&(S=a,c=O(c)),a=c}function o(){var a;return P.test(b.charAt(R))?(a=b.charAt(R),R++):(a=r,0===X&&e(Q)),a}var p,q=arguments.length>1?arguments[1]:{},r={},s={start:g},t=g,u=function(){return[]},v=r,w=",",x={type:"literal",value:",",description:'","'},y=function(a,b){return[a].concat(b)},z=function(a){return[a]},A=function(a,b){return{url:a,format:b}},B=function(a){return{url:a}},C="url(",D={type:"literal",value:"url(",description:'"url("'},E=")",F={type:"literal",value:")",description:'")"'},G=function(a){return a},H="format(",I={type:"literal",value:"format(",description:'"format("'},J="local(",K={type:"literal",value:"local(",description:'"local("'},L=function(a){return{local:a}},M=/^[^)]/,N={type:"class",value:"[^)]",description:"[^)]"},O=function(a){return Y.extractValue(a.join(""))},P=/^[ \t\r\n\f]/,Q={type:"class",value:"[ \\t\\r\\n\\f]",description:"[ \\t\\r\\n\\f]"},R=0,S=0,T=0,U={line:1,column:1,seenCR:!1},V=0,W=[],X=0;if("startRule"in q){if(!(q.startRule in s))throw new Error("Can't start parsing from rule \""+q.startRule+'".');t=s[q.startRule]}var Y=a("../util");if(p=t(),p!==r&&R===b.length)return p;throw p!==r&&R<b.length&&e({type:"end",description:"end of input"}),f(null,W,V)}return b(c,Error),{SyntaxError:c,parse:d}}()},{"../util":9}],8:[function(a,b,c){var d=a("./grammar");c.SyntaxError=function(a,b){this.message=a,this.offset=b},c.parse=function(a){try{return d.parse(a)}catch(b){throw new c.SyntaxError(b.message,b.offset)}},c.serialize=function(a){return a.map(function(a){var b;return a.url?(b='url("'+a.url+'")',a.format&&(b+=' format("'+a.format+'")')):b='local("'+a.local+'")',b}).join(", ")}},{"./grammar":7}],9:[function(a,b,c){var d=function(a){var b=/^[\t\r\f\n ]*(.+?)[\t\r\f\n ]*$/;return a.replace(b,"$1")},e=function(a){var b=/^"(.*)"$/,c=/^'(.*)'$/;return b.test(a)?a.replace(b,"$1"):c.test(a)?a.replace(c,"$1"):a};c.extractValue=function(a){return e(d(a))}},{}],10:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,MatcherList:a("./MatcherList").MatcherList};d.CSSDocumentRule=function(){d.CSSRule.call(this),this.matcher=new d.MatcherList,this.cssRules=[]},d.CSSDocumentRule.prototype=new d.CSSRule,d.CSSDocumentRule.prototype.constructor=d.CSSDocumentRule,d.CSSDocumentRule.prototype.type=10,Object.defineProperty(d.CSSDocumentRule.prototype,"cssText",{get:function(){for(var a=[],b=0,c=this.cssRules.length;c>b;b++)a.push(this.cssRules[b].cssText);return"@-moz-document "+this.matcher.matcherText+" {"+a.join("")+"}"}}),c.CSSDocumentRule=d.CSSDocumentRule},{"./CSSRule":16,"./MatcherList":22}],11:[function(a,b,c){var d={CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration,CSSRule:a("./CSSRule").CSSRule};d.CSSFontFaceRule=function(){d.CSSRule.call(this),this.style=new d.CSSStyleDeclaration,this.style.parentRule=this},d.CSSFontFaceRule.prototype=new d.CSSRule,d.CSSFontFaceRule.prototype.constructor=d.CSSFontFaceRule,d.CSSFontFaceRule.prototype.type=5,Object.defineProperty(d.CSSFontFaceRule.prototype,"cssText",{get:function(){return"@font-face {"+this.style.cssText+"}"}}),c.CSSFontFaceRule=d.CSSFontFaceRule},{"./CSSRule":16,"./CSSStyleDeclaration":17}],12:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,CSSStyleSheet:a("./CSSStyleSheet").CSSStyleSheet,MediaList:a("./MediaList").MediaList};d.CSSImportRule=function(){d.CSSRule.call(this),this.href="",this.media=new d.MediaList,this.styleSheet=new d.CSSStyleSheet},d.CSSImportRule.prototype=new d.CSSRule,d.CSSImportRule.prototype.constructor=d.CSSImportRule,d.CSSImportRule.prototype.type=3,Object.defineProperty(d.CSSImportRule.prototype,"cssText",{get:function(){var a=this.media.mediaText;return"@import url("+this.href+")"+(a?" "+a:"")+";"},set:function(a){for(var b,c,d=0,e="",f="";c=a.charAt(d);d++)switch(c){case" ":case"\t":case"\r":case"\n":case"\f":"after-import"===e?e="url":f+=c;break;case"@":e||a.indexOf("@import",d)!==d||(e="after-import",d+="import".length,f="");break;case"u":if("url"===e&&a.indexOf("url(",d)===d){if(b=a.indexOf(")",d+1),-1===b)throw d+': ")" not found';d+="url(".length;var g=a.slice(d,b);g[0]===g[g.length-1]&&('"'===g[0]||"'"===g[0])&&(g=g.slice(1,-1)),this.href=g,d=b,e="media"}break;case'"':if("url"===e){if(b=a.indexOf('"',d+1),!b)throw d+": '\"' not found";this.href=a.slice(d+1,b),d=b,e="media"}break;case"'":if("url"===e){if(b=a.indexOf("'",d+1),!b)throw d+': "\'" not found';this.href=a.slice(d+1,b),d=b,e="media"}break;case";":"media"===e&&f&&(this.media.mediaText=f.trim());break;default:"media"===e&&(f+=c)}}}),c.CSSImportRule=d.CSSImportRule},{"./CSSRule":16,"./CSSStyleSheet":19,"./MediaList":23}],13:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration};d.CSSKeyframeRule=function(){d.CSSRule.call(this),this.keyText="",this.style=new d.CSSStyleDeclaration,this.style.parentRule=this},d.CSSKeyframeRule.prototype=new d.CSSRule,d.CSSKeyframeRule.prototype.constructor=d.CSSKeyframeRule,d.CSSKeyframeRule.prototype.type=9,Object.defineProperty(d.CSSKeyframeRule.prototype,"cssText",{get:function(){return this.keyText+" {"+this.style.cssText+"} "}}),c.CSSKeyframeRule=d.CSSKeyframeRule},{"./CSSRule":16,"./CSSStyleDeclaration":17}],14:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule};d.CSSKeyframesRule=function(){d.CSSRule.call(this),this.name="",this.cssRules=[]},d.CSSKeyframesRule.prototype=new d.CSSRule,d.CSSKeyframesRule.prototype.constructor=d.CSSKeyframesRule,d.CSSKeyframesRule.prototype.type=8,Object.defineProperty(d.CSSKeyframesRule.prototype,"cssText",{get:function(){for(var a=[],b=0,c=this.cssRules.length;c>b;b++)a.push("  "+this.cssRules[b].cssText);return"@"+(this._vendorPrefix||"")+"keyframes "+this.name+" { \n"+a.join("\n")+"\n}"}}),c.CSSKeyframesRule=d.CSSKeyframesRule},{"./CSSRule":16}],15:[function(a,b,c){var d={CSSRule:a("./CSSRule").CSSRule,MediaList:a("./MediaList").MediaList};d.CSSMediaRule=function(){d.CSSRule.call(this),this.media=new d.MediaList,this.cssRules=[]},d.CSSMediaRule.prototype=new d.CSSRule,d.CSSMediaRule.prototype.constructor=d.CSSMediaRule,d.CSSMediaRule.prototype.type=4,Object.defineProperty(d.CSSMediaRule.prototype,"cssText",{get:function(){for(var a=[],b=0,c=this.cssRules.length;c>b;b++)a.push(this.cssRules[b].cssText);return"@media "+this.media.mediaText+" {"+a.join("")+"}"}}),c.CSSMediaRule=d.CSSMediaRule},{"./CSSRule":16,"./MediaList":23}],16:[function(a,b,c){var d={};d.CSSRule=function(){this.parentRule=null,this.parentStyleSheet=null},d.CSSRule.STYLE_RULE=1,d.CSSRule.IMPORT_RULE=3,d.CSSRule.MEDIA_RULE=4,d.CSSRule.FONT_FACE_RULE=5,d.CSSRule.PAGE_RULE=6,d.CSSRule.WEBKIT_KEYFRAMES_RULE=8,d.CSSRule.WEBKIT_KEYFRAME_RULE=9,d.CSSRule.prototype={constructor:d.CSSRule},c.CSSRule=d.CSSRule},{}],17:[function(a,b,c){var d={};d.CSSStyleDeclaration=function(){this.length=0,this.parentRule=null,this._importants={}},d.CSSStyleDeclaration.prototype={constructor:d.CSSStyleDeclaration,getPropertyValue:function(a){return this[a]||""},setProperty:function(a,b,c){if(this[a]){var d=Array.prototype.indexOf.call(this,a);0>d&&(this[this.length]=a,this.length++)}else this[this.length]=a,this.length++;this[a]=b,this._importants[a]=c},removeProperty:function(a){if(a in this){var b=Array.prototype.indexOf.call(this,a);if(0>b)return"";var c=this[a];return this[a]="",Array.prototype.splice.call(this,b,1),c}return""},getPropertyCSSValue:function(){},getPropertyPriority:function(a){return this._importants[a]||""},getPropertyShorthand:function(){},isPropertyImplicit:function(){},(get cssText(){for(var a=[],b=0,c=this.length;c>b;++b){var d=this[b],e=this.getPropertyValue(d),f=this.getPropertyPriority(d);f&&(f=" !"+f),a[b]=d+": "+e+f+";"}return a.join(" ")}),(set cssText(a){var b,c;for(b=this.length;b--;)c=this[b],this[c]="";Array.prototype.splice.call(this,0,this.length),this._importants={};var e=d.parse("#bogus{"+a+"}").cssRules[0].style,f=e.length;for(b=0;f>b;++b)c=e[b],this.setProperty(e[b],e.getPropertyValue(c),e.getPropertyPriority(c))})},c.CSSStyleDeclaration=d.CSSStyleDeclaration,d.parse=a("./parse").parse},{"./parse":27}],18:[function(a,b,c){var d={CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration,CSSRule:a("./CSSRule").CSSRule};d.CSSStyleRule=function(){d.CSSRule.call(this),this.selectorText="",this.style=new d.CSSStyleDeclaration,this.style.parentRule=this},d.CSSStyleRule.prototype=new d.CSSRule,d.CSSStyleRule.prototype.constructor=d.CSSStyleRule,d.CSSStyleRule.prototype.type=1,Object.defineProperty(d.CSSStyleRule.prototype,"cssText",{get:function(){var a;return a=this.selectorText?this.selectorText+" {"+this.style.cssText+"}":""},set:function(a){var b=d.CSSStyleRule.parse(a);this.style=b.style,this.selectorText=b.selectorText}}),d.CSSStyleRule.parse=function(a){for(var b,c,e,f=0,g="selector",h=f,i="",j={selector:!0,value:!0},k=new d.CSSStyleRule,l="";e=a.charAt(f);f++)switch(e){case" ":case"\t":case"\r":case"\n":case"\f":if(j[g])switch(a.charAt(f-1)){case" ":case"\t":case"\r":case"\n":case"\f":break;default:i+=" "}break;case'"':if(h=f+1,b=a.indexOf('"',h)+1,!b)throw'" is missing';i+=a.slice(f,b),f=b-1;break;case"'":if(h=f+1,b=a.indexOf("'",h)+1,!b)throw"' is missing";i+=a.slice(f,b),f=b-1;break;case"/":if("*"===a.charAt(f+1)){if(f+=2,b=a.indexOf("*/",f),-1===b)throw new SyntaxError("Missing */");f=b+1}else i+=e;break;case"{":"selector"===g&&(k.selectorText=i.trim(),i="",g="name");break;case":":"name"===g?(c=i.trim(),i="",g="value"):i+=e;break;case"!":"value"===g&&a.indexOf("!important",f)===f?(l="important",f+="important".length):i+=e;break;case";":"value"===g?(k.style.setProperty(c,i.trim(),l),l="",i="",g="name"):i+=e;break;case"}":if("value"===g)k.style.setProperty(c,i.trim(),l),l="",i="";else{if("name"===g)break;i+=e}g="selector";break;default:i+=e}return k},c.CSSStyleRule=d.CSSStyleRule},{"./CSSRule":16,"./CSSStyleDeclaration":17}],19:[function(a,b,c){var d={StyleSheet:a("./StyleSheet").StyleSheet,CSSStyleRule:a("./CSSStyleRule").CSSStyleRule};d.CSSStyleSheet=function(){d.StyleSheet.call(this),this.cssRules=[]},d.CSSStyleSheet.prototype=new d.StyleSheet,d.CSSStyleSheet.prototype.constructor=d.CSSStyleSheet,d.CSSStyleSheet.prototype.insertRule=function(a,b){if(0>b||b>this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");var c=d.parse(a).cssRules[0];return c.parentStyleSheet=this,this.cssRules.splice(b,0,c),b},d.CSSStyleSheet.prototype.deleteRule=function(a){if(0>a||a>=this.cssRules.length)throw new RangeError("INDEX_SIZE_ERR");this.cssRules.splice(a,1)},d.CSSStyleSheet.prototype.toString=function(){for(var a="",b=this.cssRules,c=0;c<b.length;c++)a+=b[c].cssText+"\n";return a},c.CSSStyleSheet=d.CSSStyleSheet,d.parse=a("./parse").parse},{"./CSSStyleRule":18,"./StyleSheet":24,"./parse":27}],20:[function(a,b,c){var d={};d.CSSValue=function(){},d.CSSValue.prototype={constructor:d.CSSValue,(set cssText(a){var b=this._getConstructorName();throw new Exception('DOMException: property "cssText" of "'+b+'" is readonly!')}),(get cssText(){var a=this._getConstructorName();throw new Exception('getter "cssText" of "'+a+'" is not implemented!')}),_getConstructorName:function(){var a=this.constructor.toString(),b=a.match(/function\s([^\(]+)/),c=b[1];return c}},c.CSSValue=d.CSSValue},{}],21:[function(a,b,c){var d={CSSValue:a("./CSSValue").CSSValue};d.CSSValueExpression=function(a,b){this._token=a,this._idx=b},d.CSSValueExpression.prototype=new d.CSSValue,d.CSSValueExpression.prototype.constructor=d.CSSValueExpression,d.CSSValueExpression.prototype.parse=function(){for(var a,b=this._token,c=this._idx,d="",e="",f="",g=[];;++c){if(d=b.charAt(c),""==d){f="css expression error: unfinished expression!";break}switch(d){case"(":g.push(d),e+=d;break;case")":g.pop(d),e+=d;break;case"/":(a=this._parseJSComment(b,c))?a.error?f="css expression error: unfinished comment in expression!":c=a.idx:(a=this._parseJSRexExp(b,c))?(c=a.idx,e+=a.text):e+=d;break;case"'":case'"':a=this._parseJSString(b,c,d),a?(c=a.idx,e+=a.text):e+=d;break;default:e+=d}if(f)break;if(0==g.length)break}var h;return h=f?{error:f}:{idx:c,expression:e}},d.CSSValueExpression.prototype._parseJSComment=function(a,b){var c,d=a.charAt(b+1);if("/"==d||"*"==d){var e,f,g=b;return"/"==d?f="\n":"*"==d&&(f="*/"),e=a.indexOf(f,g+1+1),-1!==e?(e=e+f.length-1,c=a.substring(b,e+1),{idx:e,text:c}):(error="css expression error: unfinished comment in expression!",{error:error})}return!1},d.CSSValueExpression.prototype._parseJSString=function(a,b,c){var d,e=this._findMatchedIdx(a,b,c);return-1===e?!1:(d=a.substring(b,e+c.length),{idx:e,text:d})},d.CSSValueExpression.prototype._parseJSRexExp=function(a,b){var c=a.substring(0,b).replace(/\s+$/,""),d=[/^$/,/\($/,/\[$/,/\!$/,/\+$/,/\-$/,/\*$/,/\/\s+/,/\%$/,/\=$/,/\>$/,/\<$/,/\&$/,/\|$/,/\^$/,/\~$/,/\?$/,/\,$/,/delete$/,/in$/,/instanceof$/,/new$/,/typeof$/,/void$/],e=d.some(function(a){return a.test(c)});if(e){var f="/";return this._parseJSString(a,b,f)}return!1},d.CSSValueExpression.prototype._findMatchedIdx=function(a,b,c){for(var d,e=b,f=-1;;){if(d=a.indexOf(c,e+1),-1===d){d=f;break}var g=a.substring(b+1,d),h=g.match(/\\+$/);if(!h||h[0]%2==0)break;e=d}var i=a.indexOf("\n",b+1);return d>i&&(d=f),d},c.CSSValueExpression=d.CSSValueExpression},{"./CSSValue":20}],22:[function(a,b,c){var d={};d.MatcherList=function(){this.length=0},d.MatcherList.prototype={constructor:d.MatcherList,(get matcherText(){return Array.prototype.join.call(this,", ")}),(set matcherText(a){for(var b=a.split(","),c=this.length=b.length,d=0;c>d;d++)this[d]=b[d].trim()}),appendMatcher:function(a){-1===Array.prototype.indexOf.call(this,a)&&(this[this.length]=a,this.length++)},deleteMatcher:function(a){var b=Array.prototype.indexOf.call(this,a);-1!==b&&Array.prototype.splice.call(this,b,1)}},c.MatcherList=d.MatcherList},{}],23:[function(a,b,c){var d={};d.MediaList=function(){this.length=0},d.MediaList.prototype={constructor:d.MediaList,(get mediaText(){return Array.prototype.join.call(this,", ")}),(set mediaText(a){for(var b=a.split(","),c=this.length=b.length,d=0;c>d;d++)this[d]=b[d].trim()}),appendMedium:function(a){-1===Array.prototype.indexOf.call(this,a)&&(this[this.length]=a,this.length++)},deleteMedium:function(a){var b=Array.prototype.indexOf.call(this,a);-1!==b&&Array.prototype.splice.call(this,b,1)}},c.MediaList=d.MediaList},{}],24:[function(a,b,c){var d={};d.StyleSheet=function(){this.parentStyleSheet=null},c.StyleSheet=d.StyleSheet},{}],25:[function(a,b,c){var d={CSSStyleSheet:a("./CSSStyleSheet").CSSStyleSheet,CSSStyleRule:a("./CSSStyleRule").CSSStyleRule,CSSMediaRule:a("./CSSMediaRule").CSSMediaRule,CSSStyleDeclaration:a("./CSSStyleDeclaration").CSSStyleDeclaration,CSSKeyframeRule:a("./CSSKeyframeRule").CSSKeyframeRule,CSSKeyframesRule:a("./CSSKeyframesRule").CSSKeyframesRule};d.clone=function e(a){var b=new d.CSSStyleSheet,c=a.cssRules;if(!c)return b;for(var f={1:d.CSSStyleRule,4:d.CSSMediaRule,8:d.CSSKeyframesRule,9:d.CSSKeyframeRule},g=0,h=c.length;h>g;g++){var i=c[g],j=b.cssRules[g]=new f[i.type],k=i.style;if(k){for(var l=j.style=new d.CSSStyleDeclaration,m=0,n=k.length;n>m;m++){var o=l[m]=k[m];l[o]=k[o],l._importants[o]=k.getPropertyPriority(o)}l.length=k.length}i.hasOwnProperty("keyText")&&(j.keyText=i.keyText),i.hasOwnProperty("selectorText")&&(j.selectorText=i.selectorText),i.hasOwnProperty("mediaText")&&(j.mediaText=i.mediaText),i.hasOwnProperty("cssRules")&&(j.cssRules=e(i).cssRules)}return b},c.clone=d.clone},{"./CSSKeyframeRule":13,"./CSSKeyframesRule":14,"./CSSMediaRule":15,"./CSSStyleDeclaration":17,"./CSSStyleRule":18,"./CSSStyleSheet":19}],26:[function(a,b,c){"use strict",c.CSSStyleDeclaration=a("./CSSStyleDeclaration").CSSStyleDeclaration,c.CSSRule=a("./CSSRule").CSSRule,c.CSSStyleRule=a("./CSSStyleRule").CSSStyleRule,c.MediaList=a("./MediaList").MediaList,c.CSSMediaRule=a("./CSSMediaRule").CSSMediaRule,c.CSSImportRule=a("./CSSImportRule").CSSImportRule,c.CSSFontFaceRule=a("./CSSFontFaceRule").CSSFontFaceRule,c.StyleSheet=a("./StyleSheet").StyleSheet,c.CSSStyleSheet=a("./CSSStyleSheet").CSSStyleSheet,c.CSSKeyframesRule=a("./CSSKeyframesRule").CSSKeyframesRule,c.CSSKeyframeRule=a("./CSSKeyframeRule").CSSKeyframeRule,c.MatcherList=a("./MatcherList").MatcherList,c.CSSDocumentRule=a("./CSSDocumentRule").CSSDocumentRule,c.CSSValue=a("./CSSValue").CSSValue,c.CSSValueExpression=a("./CSSValueExpression").CSSValueExpression,c.parse=a("./parse").parse,c.clone=a("./clone").clone},{"./CSSDocumentRule":10,"./CSSFontFaceRule":11,"./CSSImportRule":12,"./CSSKeyframeRule":13,"./CSSKeyframesRule":14,"./CSSMediaRule":15,"./CSSRule":16,"./CSSStyleDeclaration":17,"./CSSStyleRule":18,"./CSSStyleSheet":19,"./CSSValue":20,"./CSSValueExpression":21,"./MatcherList":22,"./MediaList":23,"./StyleSheet":24,"./clone":25,"./parse":27}],27:[function(a,b,c){var d={};d.parse=function(a){for(var b,c,e,f,g,h,i,j,k,l,m=0,n="before-selector",o="",p={selector:!0,value:!0,atRule:!0,"importRule-begin":!0,importRule:!0,atBlock:!0,"documentRule-begin":!0},q=new d.CSSStyleSheet,r=q,s="",t=/@(-(?:\w+-)+)?keyframes/g,u=function(b){var c=a.substring(0,m).split("\n"),d=c.length,e=c.pop().length+1,f=new Error(b+" (line "+d+", char "+e+")");throw f.line=d,f.char=e,f.styleSheet=q,f};l=a.charAt(m);m++)switch(l){case" ":case"\t":case"\r":case"\n":case"\f":p[n]&&(o+=l);break;case'"':b=m+1;do b=a.indexOf('"',b)+1,b||u('Unmatched "');while("\\"===a[b-2]);switch(o+=a.slice(m,b),m=b-1,n){case"before-value":n="value";break;case"importRule-begin":n="importRule"}break;case"'":b=m+1;do b=a.indexOf("'",b)+1,b||u("Unmatched '");while("\\"===a[b-2]);switch(o+=a.slice(m,b),m=b-1,n){case"before-value":n="value";break;case"importRule-begin":n="importRule"}break;case"/":"*"===a.charAt(m+1)?(m+=2,b=a.indexOf("*/",m),-1===b?u("Missing */"):m=b+1):o+=l,"importRule-begin"===n&&(o+=" ",n="importRule");break;case"@":if(a.indexOf("@-moz-document",m)===m){n="documentRule-begin",k=new d.CSSDocumentRule,k.__starts=m,m+="-moz-document".length,o="";break}if(a.indexOf("@media",m)===m){n="atBlock",g=new d.CSSMediaRule,g.__starts=m,m+="media".length,o="";break}if(a.indexOf("@import",m)===m){n="importRule-begin",m+="import".length,o+="@import";break}if(a.indexOf("@font-face",m)===m){n="fontFaceRule-begin",m+="font-face".length,i=new d.CSSFontFaceRule,i.__starts=m,o="";break}t.lastIndex=m;var v=t.exec(a);if(v&&v.index===m){n="keyframesRule-begin",j=new d.CSSKeyframesRule,j.__starts=m,j._vendorPrefix=v[1],m+=v[0].length-1,o="";break}"selector"==n&&(n="atRule"),o+=l;break;case"{":"selector"===n||"atRule"===n?(f.selectorText=o.trim(),f.style.__starts=m,o="",n="before-name"):"atBlock"===n?(g.media.mediaText=o.trim(),r=c=g,g.parentStyleSheet=q,o="",n="before-selector"):"fontFaceRule-begin"===n?(c&&(i.parentRule=c),i.parentStyleSheet=q,f=i,o="",n="before-name"):"keyframesRule-begin"===n?(j.name=o.trim(),c&&(j.parentRule=c),j.parentStyleSheet=q,r=c=j,o="",n="keyframeRule-begin"):"keyframeRule-begin"===n?(f=new d.CSSKeyframeRule,f.keyText=o.trim(),f.__starts=m,o="",n="before-name"):"documentRule-begin"===n&&(k.matcher.matcherText=o.trim(),c&&(k.parentRule=c),r=c=k,k.parentStyleSheet=q,o="",n="before-selector");break;case":":"name"===n?(e=o.trim(),o="",n="before-value"):o+=l;break;case"(":if("value"===n)if("expression"==o.trim()){var w=(new d.CSSValueExpression(a,m)).parse();w.error?u(w.error):(o+=w.expression,m=w.idx)}else b=a.indexOf(")",m+1),-1===b&&u('Unmatched "("'),o+=a.slice(m,b+1),m=b;else o+=l;break;case"!":"value"===n&&a.indexOf("!important",m)===m?(s="important",m+="important".length):o+=l;break;case";":switch(n){case"value":f.style.setProperty(e,o.trim(),s),s="",o="",n="before-name";break;case"atRule":o="",n="before-selector";break;case"importRule":h=new d.CSSImportRule,h.parentStyleSheet=h.styleSheet.parentStyleSheet=q,h.cssText=o+l,q.cssRules.push(h),o="",n="before-selector";break;default:o+=l}break;case"}":switch(n){case"value":f.style.setProperty(e,o.trim(),s),s="";case"before-name":case"name":f.__ends=m+1,c&&(f.parentRule=c),f.parentStyleSheet=q,r.cssRules.push(f),o="",n=r.constructor===d.CSSKeyframesRule?"keyframeRule-begin":"before-selector";break;case"keyframeRule-begin":case"before-selector":case"selector":c||u("Unexpected }"),r.__ends=m+1,q.cssRules.push(r),r=q,c=null,o="",n="before-selector"}break;default:switch(n){case"before-selector":n="selector",f=new d.CSSStyleRule,f.__starts=m;break;case"before-name":n="name";break;case"before-value":n="value";break;case"importRule-begin":n="importRule"}o+=l}return q},c.parse=d.parse,d.CSSStyleSheet=a("./CSSStyleSheet").CSSStyleSheet,d.CSSStyleRule=a("./CSSStyleRule").CSSStyleRule,d.CSSImportRule=a("./CSSImportRule").CSSImportRule,d.CSSMediaRule=a("./CSSMediaRule").CSSMediaRule,d.CSSFontFaceRule=a("./CSSFontFaceRule").CSSFontFaceRule,d.CSSStyleDeclaration=a("./CSSStyleDeclaration").CSSStyleDeclaration,d.CSSKeyframeRule=a("./CSSKeyframeRule").CSSKeyframeRule,d.CSSKeyframesRule=a("./CSSKeyframesRule").CSSKeyframesRule,d.CSSValueExpression=a("./CSSValueExpression").CSSValueExpression,d.CSSDocumentRule=a("./CSSDocumentRule").CSSDocumentRule},{"./CSSDocumentRule":10,"./CSSFontFaceRule":11,"./CSSImportRule":12,"./CSSKeyframeRule":13,"./CSSKeyframesRule":14,"./CSSMediaRule":15,"./CSSStyleDeclaration":17,"./CSSStyleRule":18,"./CSSStyleSheet":19,"./CSSValueExpression":21}],28:[function(a,b,c){"use strict";var d=a("./cssSupport"),e=function(a){var b=/^[\t\r\f\n ]*(.+?)[\t\r\f\n ]*$/;return a.replace(b,"$1")};c.extractCssUrl=function(a){var b,c=/^url\(([^\)]+)\)/;if(!c.test(a))throw new Error("Invalid url");return b=c.exec(a)[1],d.unquoteString(e(b))};var f=function(a){var b,c="\\s*(?:\"[^\"]*\"|'[^']*'|[^\\(]+)\\s*",d="(url\\("+c+"\\)|[^,\\s]+)",e="(?:\\s*"+d+")+",f="^\\s*("+e+")(?:\\s*,\\s*("+e+"))*\\s*$",g=new RegExp(e,"g"),h=[],i=function(a){var b,c=new RegExp(d,"g"),e=[];for(b=c.exec(a);b;)e.push(b[1]),b=c.exec(a);return e};if(a.match(new RegExp(f))){for(b=g.exec(a);b;)h.push(i(b[0])),b=g.exec(a);return h}return[]},g=function(a){var b,d;for(b=0;b<a.length;b++)try{return d=c.extractCssUrl(a[b]),{url:d,idx:b}}catch(e){}};c.parse=function(a){var b=f(a);return b.map(function(a){var b=g(a);return b?{preUrl:a.slice(0,b.idx),url:b.url,postUrl:a.slice(b.idx+1)}:{preUrl:a}})},c.serialize=function(a){var b=a.map(function(a){var b=[].concat(a.preUrl);return a.url&&b.push('url("'+a.url+'")'),a.postUrl&&(b=b.concat(a.postUrl)),b.join(" ")});return b.join(", ")}},{"./cssSupport":29}],29:[function(a,b,c){"use strict";var d=a("cssom");c.unquoteString=function(a){var b=/^"(.*)"$/,c=/^'(.*)'$/;return b.test(a)?a.replace(b,"$1"):c.test(a)?a.replace(c,"$1"):a};var e=function(a){var b,c=document.implementation.createHTMLDocument(""),d=document.createElement("style");return d.textContent=a,c.body.appendChild(d),b=d.sheet.cssRules,Array.prototype.slice.call(b)},f=function(){var a=e("a{background:url(i)}");return!a.length||a[0].cssText.indexOf("url()")>=0}();c.rulesForCssText=function(a){return f&&d.parse?d.parse(a).cssRules:e(a)},c.cssRulesToText=function(a){return a.reduce(function(a,b){return a+b.cssText},"")},c.exchangeRule=function(a,b,c){var d=a.indexOf(b),e=b.parentStyleSheet;e.insertRule(c,d+1),e.deleteRule(d),a[d]=e.cssRules[d]},c.changeFontFaceRuleSrc=function(a,b,d){var e="@font-face { font-family: "+b.style.getPropertyValue("font-family")+"; ";b.style.getPropertyValue("font-style")&&(e+="font-style: "+b.style.getPropertyValue("font-style")+"; "),b.style.getPropertyValue("font-weight")&&(e+="font-weight: "+b.style.getPropertyValue("font-weight")+"; "),e+="src: "+d+"}",c.exchangeRule(a,b,e)}},{cssom:26}],30:[function(a,b,c){"use strict";var d=a("./util"),e=a("./inlineImage"),f=a("./inlineScript"),g=a("./inlineCss"),h=a("./cssSupport"),i=function(a){return d.joinUrl(a,".")},j=function(a){var b=a.map(function(b,c){return c===a.length-1&&(b={baseUrl:i(b.baseUrl)}),JSON.stringify(b)});return b},k=function(a,b){return b.cache!==!1&&"none"!==b.cache&&b.cacheBucket?d.memoize(a,j,b.cacheBucket):a},l=function(a,b,c){var d=h.rulesForCssText(a);return g.loadCSSImportsForRules(d,b,c).then(function(b){return g.loadAndInlineCSSResourcesForRules(d,c).then(function(c){var e=b.errors.concat(c.errors),f=b.hasChanges||c.hasChanges;return f&&(a=h.cssRulesToText(d)),{hasChanges:f,content:a,errors:e}})})},m=function(a,b,c){var e=a.textContent,f=k(l,b);return f(e,c,b).then(function(b){return b.hasChanges&&(a.childNodes[0].nodeValue=b.content),d.cloneArray(b.errors)})},n=function(a){var b=a.getElementsByTagName("style");return Array.prototype.filter.call(b,function(a){return!a.attributes.type||"text/css"===a.attributes.type.nodeValue})};c.loadAndInlineStyles=function(a,b){var c,e=n(a),f=[],g=[];return c=d.clone(b),c.baseUrl=c.baseUrl||d.getDocumentBaseUrl(a),d.all(e.map(function(a){return m(a,c,g).then(function(a){f=f.concat(a)})})).then(function(){return f})};var o=function(a,b){var c,d=a.parentNode;b=b.trim(),b&&(c=a.ownerDocument.createElement("style"),c.type="text/css",c.appendChild(a.ownerDocument.createTextNode(b)),d.insertBefore(c,a)),d.removeChild(a)},p=function(a,b){return d.ajax(a,b).then(function(a){var b=h.rulesForCssText(a);return{content:a,cssRules:b}}).then(function(b){var c=g.adjustPathsOfCssResources(a,b.cssRules);return{content:b.content,cssRules:b.cssRules,hasChanges:c}}).then(function(a){return g.loadCSSImportsForRules(a.cssRules,[],b).then(function(b){return{content:a.content,cssRules:a.cssRules,hasChanges:a.hasChanges||b.hasChanges,errors:b.errors}})}).then(function(a){return g.loadAndInlineCSSResourcesForRules(a.cssRules,b).then(function(b){return{content:a.content,cssRules:a.cssRules,hasChanges:a.hasChanges||b.hasChanges,errors:a.errors.concat(b.errors)}})}).then(function(a){var b=a.content;return a.hasChanges&&(b=h.cssRulesToText(a.cssRules)),{content:b,errors:a.errors}})},q=function(a,b){var c=a.attributes.href.nodeValue,e=d.getDocumentBaseUrl(a.ownerDocument),f=d.clone(b);!f.baseUrl&&e&&(f.baseUrl=e);var g=k(p,b);return g(c,f).then(function(a){return{content:a.content,errors:d.cloneArray(a.errors)}})},r=function(a){var b=a.getElementsByTagName("link");return Array.prototype.filter.call(b,function(a){return a.attributes.rel&&"stylesheet"===a.attributes.rel.nodeValue&&(!a.attributes.type||"text/css"===a.attributes.type.nodeValue)})};c.loadAndInlineCssLinks=function(a,b){var c=r(a),e=[];return d.all(c.map(function(a){return q(a,b).then(function(b){o(a,b.content+"\n"),e=e.concat(b.errors)},function(a){e.push({resourceType:"stylesheet",url:a.url,msg:"Unable to load stylesheet "+a.url})})})).then(function(){return e})},c.loadAndInlineImages=e.inline,c.loadAndInlineScript=f.inline,c.inlineReferences=function(a,b){var e=[],f=[c.loadAndInlineImages,c.loadAndInlineStyles,c.loadAndInlineCssLinks];return b.inlineScripts!==!1&&f.push(c.loadAndInlineScript),d.all(f.map(function(c){return c(a,b).then(function(a){e=e.concat(a)})})).then(function(){return e})}},{"./cssSupport":29,"./inlineCss":31,"./inlineImage":32,"./inlineScript":33,"./util":34}],31:[function(a,b,c){"use strict";var d=a("ayepromise"),e=a("./util"),f=a("./cssSupport"),g=a("./backgroundValueParser"),h=a("css-font-face-src"),i=function(a,b,c){a.style.setProperty(b,c,a.style.getPropertyPriority(b))},j=function(a){return a.filter(function(a){return a.type===window.CSSRule.STYLE_RULE&&(a.style.getPropertyValue("background-image")||a.style.getPropertyValue("background"))})},k=function(a){var b=[];return a.forEach(function(a){a.style.getPropertyValue("background-image")?b.push({property:"background-image",value:a.style.getPropertyValue("background-image"),rule:a}):a.style.getPropertyValue("background")&&b.push({property:"background",value:a.style.getPropertyValue("background"),rule:a})}),b},l=function(a){return a.filter(function(a){return a.type===window.CSSRule.FONT_FACE_RULE&&a.style.getPropertyValue("src")})},m=function(a){return a.filter(function(a){return a.type===window.CSSRule.IMPORT_RULE&&a.href})},n=function(a){var b=[];return a.forEach(function(a,c){a.url&&!e.isDataUri(a.url)&&b.push(c)}),b},o=function(a){var b=[];return a.forEach(function(a,c){a.url&&!e.isDataUri(a.url)&&b.push(c)}),b};c.adjustPathsOfCssResources=function(a,b){var c=j(b),d=k(c),p=!1;return d.forEach(function(b){var c,d=g.parse(b.value),f=n(d);f.length>0&&(f.forEach(function(b){var c=d[b].url,f=e.joinUrl(a,c);d[b].url=f}),c=g.serialize(d),i(b.rule,b.property,c),p=!0)}),l(b).forEach(function(c){var d,g,i=c.style.getPropertyValue("src");try{d=h.parse(i)}catch(j){return}g=o(d),g.length>0&&(g.forEach(function(b){var c=d[b].url,f=e.joinUrl(a,c);d[b].url=f}),f.changeFontFaceRuleSrc(b,c,h.serialize(d)),p=!0)}),m(b).forEach(function(c){var d=c.href,g=e.joinUrl(a,d);f.exchangeRule(b,c,"@import url("+g+");"),p=!0}),p};var p=function(a,b,c){var d=a.indexOf(b);a.splice(d,1),c.forEach(function(b,c){a.splice(d+c,0,b)})},q=function(a){var b=d.defer();return b.resolve(a),b.promise},r=function(a,b,d,g){var h,i=b.href;return i=f.unquoteString(i),h=e.joinUrl(g.baseUrl,i),d.indexOf(h)>=0?(p(a,b,[]),q([])):(d.push(h),e.ajax(i,g).then(function(e){var h=f.rulesForCssText(e);return c.loadCSSImportsForRules(h,d,g).then(function(d){return c.adjustPathsOfCssResources(i,h),p(a,b,h),d.errors})},function(a){throw{resourceType:"stylesheet",url:a.url,msg:"Unable to load stylesheet "+a.url}}))};c.loadCSSImportsForRules=function(a,b,c){var d=m(a),f=[],g=!1;return e.all(d.map(function(d){return r(a,d,b,c).then(function(a){f=f.concat(a),g=!0},function(a){f.push(a)})})).then(function(){return{hasChanges:g,errors:f}})};var s=function(a,b){var c=g.parse(a),d=n(c),f=!1;return e.collectAndReportErrors(d.map(function(a){var d=c[a].url;return e.getDataURIForImageURL(d,b).then(function(b){c[a].url=b,f=!0},function(a){throw{resourceType:"backgroundImage",url:a.url,msg:"Unable to load background-image "+a.url}})})).then(function(a){return{backgroundValue:g.serialize(c),hasChanges:f,errors:a}})},t=function(a,b){var c=j(a),d=k(c),f=[],g=!1;return e.all(d.map(function(a){return s(a.value,b).then(function(b){b.hasChanges&&(i(a.rule,a.property,b.backgroundValue),g=!0),f=f.concat(b.errors)})})).then(function(){return{hasChanges:g,errors:f}})},u=function(a,b){var c,d,f=!1;try{c=h.parse(a)}catch(g){c=[]}return d=o(c),e.collectAndReportErrors(d.map(function(a){var d=c[a],g=d.format||"woff";return e.binaryAjax(d.url,b).then(function(a){var b=btoa(a);d.url="data:font/"+g+";base64,"+b,f=!0},function(a){throw{resourceType:"fontFace",url:a.url,msg:"Unable to load font-face "+a.url}})})).then(function(a){return{srcDeclarationValue:h.serialize(c),hasChanges:f,errors:a}})},v=function(a,b){var c=l(a),d=[],g=!1;return e.all(c.map(function(c){var e=c.style.getPropertyValue("src");return u(e,b).then(function(b){b.hasChanges&&(f.changeFontFaceRuleSrc(a,c,b.srcDeclarationValue),g=!0),d=d.concat(b.errors)})})).then(function(){return{hasChanges:g,errors:d}})};c.loadAndInlineCSSResourcesForRules=function(a,b){var c=!1,d=[];return e.all([t,v].map(function(e){return e(a,b).then(function(a){c=c||a.hasChanges,d=d.concat(a.errors)})})).then(function(){return{hasChanges:c,errors:d}})}},{"./backgroundValueParser":28,"./cssSupport":29,"./util":34,ayepromise:2,"css-font-face-src":8}],32:[function(a,b,c){"use strict";var d=a("./util"),e=function(a,b){var c=a.attributes.src?a.attributes.src.nodeValue:null,e=d.getDocumentBaseUrl(a.ownerDocument),f=d.clone(b);return!f.baseUrl&&e&&(f.baseUrl=e),d.getDataURIForImageURL(c,f).then(function(a){return a},function(a){throw{resourceType:"image",url:a.url,msg:"Unable to load image "+a.url}})},f=function(a){return a.filter(function(a){var b=a.attributes.src?a.attributes.src.nodeValue:null;return null!==b&&!d.isDataUri(b)})},g=function(a){return Array.prototype.filter.call(a,function(a){return"image"===a.type})},h=function(a){return Array.prototype.slice.call(a)};c.inline=function(a,b){var c=h(a.getElementsByTagName("img")),i=g(a.getElementsByTagName("input")),j=f(c.concat(i));return d.collectAndReportErrors(j.map(function(a){return e(a,b).then(function(b){a.attributes.src.nodeValue=b})}))}},{"./util":34}],33:[function(a,b,c){"use strict";var d=a("./util"),e=function(a,b){var c=a.attributes.src.nodeValue,e=d.getDocumentBaseUrl(a.ownerDocument),f=d.clone(b);return!f.baseUrl&&e&&(f.baseUrl=e),d.ajax(c,f).fail(function(a){throw{resourceType:"script",url:a.url,msg:"Unable to load script "+a.url}})},f=function(a){return a.replace(/<\//g,"<\\/")},g=function(a,b){a.attributes.removeNamedItem("src"),a.textContent=f(b)},h=function(a){var b=a.getElementsByTagName("script");return Array.prototype.filter.call(b,function(a){return!!a.attributes.src})};c.inline=function(a,b){var c=h(a);return d.collectAndReportErrors(c.map(function(a){return e(a,b).then(function(b){g(a,b)})}))}},{"./util":34}],34:[function(a,b,c){"use strict";var d=a("url"),e=a("ayepromise");c.getDocumentBaseUrl=function(a){return"about:blank"!==a.baseURI?a.baseURI:null},c.clone=function(a){var b,c={};for(b in a)a.hasOwnProperty(b)&&(c[b]=a[b]);return c},c.cloneArray=function(a){return Array.prototype.slice.apply(a,[0])},c.joinUrl=function(a,b){return a?d.resolve(a,b):b},c.isDataUri=function(a){return/^data:/.test(a)},c.all=function(a){var b=e.defer(),c=a.length,d=[];return 0===a.length?(b.resolve([]),b.promise):(a.forEach(function(a,e){a.then(function(a){c-=1,d[e]=a,0===c&&b.resolve(d)},function(a){b.reject(a)})}),b.promise)},c.collectAndReportErrors=function(a){var b=[];return c.all(a.map(function(a){return a.fail(function(a){b.push(a)})})).then(function(){return b})};var f=null,g=function(a,b){return b===!1||"none"===b||"repeated"===b?((null===f||"repeated"!==b)&&(f=Date.now()),a+"?_="+f):a};c.ajax=function(a,b){var d,f=new window.XMLHttpRequest,h=e.defer(),i=c.joinUrl(b.baseUrl,a),j=function(){h.reject({msg:"Unable to load url",url:i})};d=g(i,b.cache),f.addEventListener("load",function(){200===f.status||0===f.status?h.resolve(f.response):j()},!1),f.addEventListener("error",j,!1);try{f.open("GET",d,!0),f.overrideMimeType(b.mimeType),f.send(null)}catch(k){j()}return h.promise},c.binaryAjax=function(a,b){var d=c.clone(b);return d.mimeType="text/plain; charset=x-user-defined",c.ajax(a,d).then(function(a){for(var b="",c=0;c<a.length;c++)b+=String.fromCharCode(255&a.charCodeAt(c));return b})};var h=function(a){var b=function(a,b){return a.substring(0,b.length)===b};return b(a,"<?xml")||b(a,"<svg")?"image/svg+xml":"image/png"};c.getDataURIForImageURL=function(a,b){return c.binaryAjax(a,b).then(function(a){var b=btoa(a),c=h(a);return"data:"+c+";base64,"+b})};var i=[],j=function(a){return i.indexOf(a)<0&&i.push(a),i.indexOf(a)};c.memoize=function(a,b,c){if("object"!=typeof c)throw new Error("cacheBucket is not an object");return function(){var d,e=Array.prototype.slice.call(arguments),f=b(e),g=j(a);return c[g]&&c[g][f]?c[g][f]:(d=a.apply(null,e),c[g]=c[g]||{},c[g][f]=d,d)}}},{ayepromise:2,url:"j37I/u"}],url:[function(a,b){b.exports=a("j37I/u")},{}],"j37I/u":[function(a,b,c){function d(){this.protocol=null,this.slashes=null,this.auth=null,this.host=null,this.port=null,this.hostname=null,this.hash=null,this.search=null,this.query=null,this.pathname=null,this.path=null,this.href=null}function e(a,b,c){if(a&&j(a)&&a instanceof d)return a;var e=new d;return e.parse(a,b,c),e}function f(a){return i(a)&&(a=e(a)),a instanceof d?a.format():d.prototype.format.call(a)}function g(a,b){return e(a,!1,!0).resolve(b)}function h(a,b){return a?e(a,!1,!0).resolveObject(b):b}function i(a){return"string"==typeof a}function j(a){return"object"==typeof a&&null!==a}function k(a){return null===a}function l(a){return null==a}var m=a("punycode");c.parse=e,c.resolve=g,c.resolveObject=h,c.format=f,c.Url=d;var n=/^([a-z0-9.+-]+:)/i,o=/:[0-9]*$/,p=["<",">",'"',"`"," ","\r","\n","\t"],q=["{","}","|","\\","^","`"].concat(p),r=["'"].concat(q),s=["%","/","?",";","#"].concat(r),t=["/","?","#"],u=255,v=/^[a-z0-9A-Z_-]{0,63}$/,w=/^([a-z0-9A-Z_-]{0,63})(.*)$/,x={javascript:!0,"javascript:":!0},y={javascript:!0,"javascript:":!0},z={http:!0,https:!0,ftp:!0,gopher:!0,file:!0,"http:":!0,"https:":!0,"ftp:":!0,"gopher:":!0,"file:":!0},A=a("querystring");d.prototype.parse=function(a,b,c){if(!i(a))throw new TypeError("Parameter 'url' must be a string, not "+typeof a);var d=a;d=d.trim();var e=n.exec(d);if(e){e=e[0];var f=e.toLowerCase();this.protocol=f,d=d.substr(e.length)}if(c||e||d.match(/^\/\/[^@\/]+@[^@\/]+/)){var g="//"===d.substr(0,2);!g||e&&y[e]||(d=d.substr(2),this.slashes=!0)}if(!y[e]&&(g||e&&!z[e])){for(var h=-1,j=0;j<t.length;j++){var k=d.indexOf(t[j]);-1!==k&&(-1===h||h>k)&&(h=k)}var l,o;o=-1===h?d.lastIndexOf("@"):d.lastIndexOf("@",h),-1!==o&&(l=d.slice(0,o),d=d.slice(o+1),this.auth=decodeURIComponent(l)),h=-1;for(var j=0;j<s.length;j++){var k=d.indexOf(s[j]);-1!==k&&(-1===h||h>k)&&(h=k)}-1===h&&(h=d.length),this.host=d.slice(0,h),d=d.slice(h),this.parseHost(),this.hostname=this.hostname||"";var p="["===this.hostname[0]&&"]"===this.hostname[this.hostname.length-1];if(!p)for(var q=this.hostname.split(/\./),j=0,B=q.length;B>j;j++){var C=q[j];if(C&&!C.match(v)){for(var D="",E=0,F=C.length;F>E;E++)D+=C.charCodeAt(E)>127?"x":C[E];if(!D.match(v)){var G=q.slice(0,j),H=q.slice(j+1),I=C.match(w);I&&(G.push(I[1]),H.unshift(I[2])),H.length&&(d="/"+H.join(".")+d),this.hostname=G.join(".");break}}}if(this.hostname=this.hostname.length>u?"":this.hostname.toLowerCase(),!p){for(var J=this.hostname.split("."),K=[],j=0;j<J.length;++j){var L=J[j];K.push(L.match(/[^A-Za-z0-9_-]/)?"xn--"+m.encode(L):L)}this.hostname=K.join(".")}var M=this.port?":"+this.port:"",N=this.hostname||"";this.host=N+M,this.href+=this.host,p&&(this.hostname=this.hostname.substr(1,this.hostname.length-2),"/"!==d[0]&&(d="/"+d))}if(!x[f])for(var j=0,B=r.length;B>j;j++){var O=r[j],P=encodeURIComponent(O);P===O&&(P=escape(O)),d=d.split(O).join(P)}var Q=d.indexOf("#");-1!==Q&&(this.hash=d.substr(Q),d=d.slice(0,Q));var R=d.indexOf("?");if(-1!==R?(this.search=d.substr(R),this.query=d.substr(R+1),b&&(this.query=A.parse(this.query)),d=d.slice(0,R)):b&&(this.search="",this.query={}),d&&(this.pathname=d),z[f]&&this.hostname&&!this.pathname&&(this.pathname="/"),this.pathname||this.search){var M=this.pathname||"",L=this.search||"";this.path=M+L}return this.href=this.format(),this},d.prototype.format=function(){var a=this.auth||"";a&&(a=encodeURIComponent(a),a=a.replace(/%3A/i,":"),a+="@");var b=this.protocol||"",c=this.pathname||"",d=this.hash||"",e=!1,f="";this.host?e=a+this.host:this.hostname&&(e=a+(-1===this.hostname.indexOf(":")?this.hostname:"["+this.hostname+"]"),this.port&&(e+=":"+this.port)),this.query&&j(this.query)&&Object.keys(this.query).length&&(f=A.stringify(this.query));var g=this.search||f&&"?"+f||"";return b&&":"!==b.substr(-1)&&(b+=":"),this.slashes||(!b||z[b])&&e!==!1?(e="//"+(e||""),c&&"/"!==c.charAt(0)&&(c="/"+c)):e||(e=""),d&&"#"!==d.charAt(0)&&(d="#"+d),g&&"?"!==g.charAt(0)&&(g="?"+g),c=c.replace(/[?#]/g,function(a){return encodeURIComponent(a)}),g=g.replace("#","%23"),b+e+c+g+d},d.prototype.resolve=function(a){return this.resolveObject(e(a,!1,!0)).format()},d.prototype.resolveObject=function(a){if(i(a)){var b=new d;b.parse(a,!1,!0),a=b}var c=new d;if(Object.keys(this).forEach(function(a){c[a]=this[a]},this),c.hash=a.hash,""===a.href)return c.href=c.format(),c;if(a.slashes&&!a.protocol)return Object.keys(a).forEach(function(b){"protocol"!==b&&(c[b]=a[b])}),z[c.protocol]&&c.hostname&&!c.pathname&&(c.path=c.pathname="/"),c.href=c.format(),c;if(a.protocol&&a.protocol!==c.protocol){if(!z[a.protocol])return Object.keys(a).forEach(function(b){c[b]=a[b]}),c.href=c.format(),c;if(c.protocol=a.protocol,a.host||y[a.protocol])c.pathname=a.pathname;else{for(var e=(a.pathname||"").split("/");e.length&&!(a.host=e.shift()););a.host||(a.host=""),a.hostname||(a.hostname=""),""!==e[0]&&e.unshift(""),e.length<2&&e.unshift(""),c.pathname=e.join("/")}if(c.search=a.search,c.query=a.query,c.host=a.host||"",c.auth=a.auth,c.hostname=a.hostname||a.host,c.port=a.port,c.pathname||c.search){var f=c.pathname||"",g=c.search||"";c.path=f+g}return c.slashes=c.slashes||a.slashes,c.href=c.format(),c}var h=c.pathname&&"/"===c.pathname.charAt(0),j=a.host||a.pathname&&"/"===a.pathname.charAt(0),m=j||h||c.host&&a.pathname,n=m,o=c.pathname&&c.pathname.split("/")||[],e=a.pathname&&a.pathname.split("/")||[],p=c.protocol&&!z[c.protocol];if(p&&(c.hostname="",c.port=null,c.host&&(""===o[0]?o[0]=c.host:o.unshift(c.host)),c.host="",a.protocol&&(a.hostname=null,a.port=null,a.host&&(""===e[0]?e[0]=a.host:e.unshift(a.host)),a.host=null),m=m&&(""===e[0]||""===o[0])),j)c.host=a.host||""===a.host?a.host:c.host,c.hostname=a.hostname||""===a.hostname?a.hostname:c.hostname,c.search=a.search,c.query=a.query,o=e;else if(e.length)o||(o=[]),o.pop(),o=o.concat(e),c.search=a.search,c.query=a.query;else if(!l(a.search)){if(p){c.hostname=c.host=o.shift();var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return c.search=a.search,c.query=a.query,k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.href=c.format(),c}if(!o.length)return c.pathname=null,c.path=c.search?"/"+c.search:null,c.href=c.format(),c;for(var r=o.slice(-1)[0],s=(c.host||a.host)&&("."===r||".."===r)||""===r,t=0,u=o.length;u>=0;u--)r=o[u],"."==r?o.splice(u,1):".."===r?(o.splice(u,1),t++):t&&(o.splice(u,1),t--);if(!m&&!n)for(;t--;t)o.unshift("..");!m||""===o[0]||o[0]&&"/"===o[0].charAt(0)||o.unshift(""),s&&"/"!==o.join("/").substr(-1)&&o.push("");var v=""===o[0]||o[0]&&"/"===o[0].charAt(0);if(p){c.hostname=c.host=v?"":o.length?o.shift():"";var q=c.host&&c.host.indexOf("@")>0?c.host.split("@"):!1;q&&(c.auth=q.shift(),c.host=c.hostname=q.shift())}return m=m||c.host&&o.length,m&&!v&&o.unshift(""),o.length?c.pathname=o.join("/"):(c.pathname=null,c.path=null),k(c.pathname)&&k(c.search)||(c.path=(c.pathname?c.pathname:"")+(c.search?c.search:"")),c.auth=a.auth||c.auth,c.slashes=c.slashes||a.slashes,c.href=c.format(),c},d.prototype.parseHost=function(){var a=this.host,b=o.exec(a);b&&(b=b[0],":"!==b&&(this.port=b.substr(1)),a=a.substr(0,a.length-b.length)),a&&(this.hostname=a)}},{punycode:3,querystring:6}],37:[function(a,b,c){var d=function(a){return a.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F]/g,"")},e=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&apos;")},f=function(a){return a.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},g=function(a){var b=a.value;return" "+a.name+'="'+e(b)+'"'},h=function(a){var b=a.tagName;return"http://www.w3.org/1999/xhtml"===a.namespaceURI&&(b=b.toLowerCase()),b},i=function(a){var b=Array.prototype.map.call(a.attributes||a.attrs,function(a){return a.name}).indexOf("xmlns")>=0;return"html"!==h(a)||b?"":' xmlns="'+a.namespaceURI+'"'},j=function(a){return Array.prototype.map.call(a.childNodes,function(a){return n(a)}).join("")},k=function(a){var b="<"+h(a);return b+=i(a),Array.prototype.forEach.call(a.attributes||a.attrs,function(a){b+=g(a)}),a.childNodes.length>0?(b+=">",b+=j(a),b+="</"+h(a)+">"):b+="/>",b},l=function(a){var b=a.nodeValue||a.value||"";return f(b)},m=function(a){return"<!--"+a.data.replace(/-/g,"&#45;")+"-->"},n=function(a){return"#document"===a.nodeName||"#document-fragment"===a.nodeName?j(a):a.tagName?k(a):"#text"===a.nodeName?l(a):"#comment"===a.nodeName?m(a):void 0};c.serializeToString=function(a){return d(n(a))}},{}]},{},[1])(1)}),c.exports||d}),require.define("http://dev1.lpcandy.ru/lib/templater/client/app.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return window.ui=teacss.ui,window.$=teacss.jQuery,window._t=function(a){return window._t.hash[a]||a},window._t.hash={},window._t.load=function(a){$.extend(window._t.hash,a)},b("./style.css"),b("./controls/component.js"),b("./controls/previewFrame.js"),b("./controls/serializeObject.js"),window.rasterizeHTML=b("./controls/rasterizeHTML.js"),$.each_deep=function(a,b){a&&a.children&&$.each(a.children,function(c){b.call(this,c,a),this&&this.children&&$.each_deep(this,b)})},window.eachComponent=function(a,b){b||(b=a,a=!1);var c=Component.app;$.each(c.settings.templates,function(){var c=this;$.each_deep(c,function(d,e){console.log(this.value.id),(!a||this.value.type==a)&&b(this,this.value.id,e==c?!1:e,this.value.type)})})},window.reloadScript=window.reloadScript||function(a,b){var c=teacss.tea.Script.list,d=c[c.length-1];if(a&&d&&d.isCode){var e=JSON.stringify(b),f=reloadScript.hash[a];reloadScript.hash[a]=e;if(f!=e){var g=Component.previewFrame.$f("#script_templater_makefile_tea").length;if(g){var h=Component.previewFrame.frame[0].contentWindow;h.eval(d.what)}}}},reloadScript.hash=reloadScript.hash||{},ui.alert=ui.alert||function(a){teacss.jQuery.type(a)=="string"&&(a={text:a}),a.title=a.title||_t("Alert"),window.alertDialog||(window.alertDialog=ui.dialog({modal:!0,width:300,minHeight:50,resizable:!1,draggable:!1,dialogClass:"alert",position:{my:"center top",at:"center top+25%",of:window},buttons:{OK:function(){$(this).dialog("close")}}}),$(document).click(".ui-widget-overlay",function(){window.alertDialog.close()})),window.alertDialog.element.dialog("option","title",a.title),window.alertDialog.element.empty().append($("<i>").addClass("ui-icon ui-icon-circle-check"),$("<p>").html(a.text)),window.alertDialog.open()},ui.confirm=ui.confirm||function(a,b){teacss.jQuery.type(a)=="string"&&(a={text:a}),a.title=a.title||_t("Confirm"),a.yes=a.yes||_t("Yes"),a.no=a.no||_t("Cancel"),window.confirmDialog||(window.confirmDialog=ui.dialog({modal:!0,width:300,minHeight:50,resizable:!1,draggable:!1,dialogClass:"confirm",position:{my:"center top",at:"center top+25%",of:window}}),$(document).click(".ui-widget-overlay",function(){window.confirmDialog.close(),b&&b(!1)})),window.confirmDialog.element.dialog("option","title",a.title),window.confirmDialog.element.dialog("option","buttons",[{text:a.yes,click:function(){$(this).dialog("close"),b&&b(!0)}},{text:a.no,click:function(){$(this).dialog("close"),b&&b(!0)}}]),window.confirmDialog.element.empty().append($("<i>").addClass("ui-icon ui-icon-help"),$("<p>").html(a.text)),window.confirmDialog.open()},d=ui.Control.extend({init:function(a){var c=this;this._super($.extend({allowSkipType:!0},a)),this.styles=[],this.staticStyles=[],this.options.template=this.options.template||"default",this.options.modules=this.options.modules||["core"],Component.app=this,teacss.jQuery(function(){c.request("load",{cache:0},function(a){try{a=a||{},c.settings={},c.settings.templates=$.parseJSON(a.templates||"{}"),c.settings.theme=$.parseJSON(a.theme||"{}"),teacss.functions.settings=c.settings,c.components=a.components,c.settings.upload=a.upload;var d=a.cached;for(var e in d)teacss.files[teacss.path.absolute(e)]=d[e],window.require.cache.files[teacss.path.absolute(e)]=d[e];delete c.settings.cached}catch(f){alert(a)}var g=[];$.each(c.options.modules,function(a,b){b[0]!="/"?g.push("../modules/"+b+"/"+b+".js"):g.push(b)}),g.push(function(){window.dayside&&(dayside.editor=ui.control(),dayside.core=ui.control(),FileApi.file=function(a,b){var d=FileApi.cache[a]=c.settings.theme.extra_js||"";b({data:d})},FileApi.save=function(a,b,d){FileApi.cache[a]=b,c.settings.theme.extra_js=b,Component.previewFrame.reloadScript=!0,teacss.parsed["templater_makefile.tea"]=!1,c.reloadTeaNow(),c.trigger("change"),d({data:"ok"})}),c.initUI()}),b.apply(b,g)})}),this.bind("change",function(){if(c.skipSave)return;c.request("save",{templates:JSON.stringify(c.settings.templates),theme:JSON.stringify(c.settings.theme,undefined,2)})})},request:function(a,b,c){var d=this;d.pending_request=a,$.ajax({url:this.options.ajax_url,type:"POST",data:$.extend({},{_type:a,_modules:d.options.modules,_project:d.options.project},b),success:function(a){if(c){try{var b=$.parseJSON(a)}catch(e){alert(a)}c(b),d.pending_request&&d.pending_request.call&&d.pending_request(),d.pending_request=!1}}})},initUI:function(){var a=this,b=350,c=400,d=ui.panel();d.element.css({zIndex:2,position:"absolute",left:0,width:b,top:0,height:57}),d.element.addClass("preview-toolbar"),d.push(a.closeButton=ui.button({label:_t("Preview"),margin:"15px 0 0 0",icons:{primary:"ui-icon-close"},click:function(){var b=a.frame.layoutModeEnabled;a.frame.layoutMode(!b),$("body").toggleClass("view-layout",b),a.closeButton.element.button("option",b?{label:_t("Editor"),icons:{primary:"ui-icon-gear"}}:{label:_t("Preview"),icons:{primary:"ui-icon-close"}})}}),a.view3dButton=ui.check({label:"3D",margin:"15px 0 0 5px",change:function(){a.frame.view3dMode(this.value)}}),a.publishButton=ui.button({label:_t("Publish"),margin:"15px 5px 0",icons:{primary:"ui-icon-circle-triangle-e"},click:function(){a.publish()}})),a.closeButton.element.addClass("close-button"),a.publishButton.element.css({position:"absolute",right:0,top:0});var e=ui.panel();e.element.css({position:"absolute",left:0,width:0,top:57,bottom:0,zIndex:999}).addClass("editor-sidebar"),a.templateTabs=ui.tabPanel({margin:0}),a.templateTabs.element.addClass("preview-tabs"),a.templateTabs.element.css({position:"absolute",left:b,right:0,top:0,height:57}),a.templateTabs.element.find(".ui-tabs-nav:first").sortable("destroy"),a.templateTabs.element.click(function(){Component.previewFrame.select(!1)});var f=ui.panel();f.element.css({position:"fixed",left:0,top:0,right:0,bottom:0,margin:0}).addClass("editor-panel"),f.element.appendTo(teacss.ui.layer),f.push(a.templateTabs,d,e),a.frame=ui.previewFrame(),a.frame.element.css({position:"absolute",left:c,right:0,margin:0,top:57,bottom:0}).addClass("frame-panel"),a.frame.bind("init",function(){a.templateTabs.bind("select",function(b,c){a.frameReady&&a.selectTemplate(c.template,c)}),a.initTabs(),a.frameReady=!0,a.selectTemplate(a.options.template)}),a.frame.bind("loaded",function(){a.updateUI()}),a.frame.bind("change",function(){a.settings.templates[a.currentTemplate]=this.getValue().template,a.trigger("change")}),f.push(a.frame),a.componentPanel=ui.panel({}),a.componentPanel.element.css({position:"absolute",top:0,bottom:0,left:0,height:"",width:c,margin:0}).addClass("ui-button-tabs-content"),a.stylePanel=ui.panel({}),a.stylePanel.element.css({position:"absolute",top:0,bottom:0,left:0,right:0,margin:0}).appendTo(a.componentPanel.element),e.push(a.componentPanel),a.trigger("initUI")},initTabs:function(){var a=this;a.tabList=a.tabList||[],a.tabHash={},a.breadcrumbs=a.breadcrumbs||$("<span>"),a.breadcrumbs.detach(),$.each(a.tabList,function(){a.templateTabs.closeTab(this)});var b=this.options.template;while(b){var c=ui.panel({label:b});c.template=b,a.tabHash[b]=c,a.templateTabs.push(c),a.tabList.push(c);var d=$("<div class='template-status'>").on("click",{tpl:b},function(b){b.preventDefault(),b.stopPropagation(),a.editParentTemplate(b.data.tpl)}).appendTo(c.element);b=this.settings.templates[b]||{value:{}},b=b.value.parentTemplate;var e=$("<a href='#'>");b?e.text("Child template for "+b):e.text("Standalone template"),d.append(e)}},editParentTemplate:function(a){var b=this,c=this.settings.templates[a],d=c?c.value.parentTemplate||"":"",e=prompt("Enter template name in form /some/path/name",d);e!==null&&e!==d&&(this.settings.templates[a]={value:{parentTemplate:e||undefined}},b.trigger("change"),b.initTabs())},selectTemplate:function(a){var b=this;if(b.currentTemplate==a)return;b.currentTemplate=a,this.frame.setValue({template:b.settings.templates[a]||{},data:!1}),b.tabHash[a].element.find(".template-status").append(b.breadcrumbs)},publish:function(){var a=this;teacss.build("templater_makefile.tea",{callback:function(b){function d(){a.request("publish",{files:b},function(){ui.alert({title:_t("Publish success"),text:_t("Your page was successfully published and now is available to your customers")})})}if(a.options.publishScreenshot){var c=document.createElement("canvas");c.width=1920,c.height=1080,a.frame.$f("script").remove(),rasterizeHTML.drawDocument(a.frame.document,c,{width:1920,height:1080}).then(function(){var e=document.createElement("canvas"),f=e.getContext("2d");e.width=600,e.height=450;var g=parseFloat(a.settings.theme.sheet.width);g=(g||1024)*1.05;var h=e.width/g,i=(c.width-g)*.5*h;f.drawImage(c,-i,0,c.width*h,c.height*h);var j=e.toDataURL();b["/screenshot.png"]=j,d()})}else d()}})},updateComponentUI:function(a,b){var c=this,d=this.form,e=teacss.ui.form.activeForm,f=teacss.ui.form.activeForm={newItems:[]};a.controls=a.controls||[],c.trigger("component-controls",{cmp:a}),teacss.ui.form.activeForm=e;for(var g=0;g<f.newItems.length;g++){var h=f.newItems[g];d.registerItem(h,b)}},reloadTeaNow:function(){clearTimeout(this.form.processTimeout),this.frame.reloadTea()},updateUI:function(){var a=this,b=[],c={};a.stylePanel.element.empty();var d=this.form=ui.form(function(){var b=a.frame.componentsHash;for(var c in b)b[c].controls=[],b[c].overlayControls=[];a.trigger("common-controls")});d.setValue(a.settings.theme),d.bind("change",function(b,c){teacss.functions.theme=a.settings.theme=this.value,clearTimeout(d.processTimeout),d.processTimeout=setTimeout(function(){a.frame.reloadTea()},50),clearTimeout(d.saveTimeout),d.saveTimeout=setTimeout(function(){a.trigger("change")},500)})}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/editor_ru.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return window._t.load({"Add Section":"Добавить секцию","Select component type":"Выбрать тип","Document alert":"",Preview:"Просмотр",Editor:"Констуктор",Publish:"Публиковать","Your page was successfully published and now is available to your customers":"Ваша страница успешно опубликована и сейчас доступна для пользователей","Publish success":"Публикация успешна","Sure to remove component?":"Уверены, что хотите удалить компонент?",Settings:"Настройки","Add Item":"Добавить",Logotype:"Логотип","Image logo":"Изображение","Text name logo":"Текст","Upload file":"Загрузить файл","Company name:":"Название компании:","Font settings:":"Настройки шрифта:","Size:":"Размер:",Icons:"Иконки",Text:"Текст","Field label":"Заголовок поля","Field description":"Описание поля","Is required?":"Обязательное для ввода?","Text area":"Текстовое поле",Checkbox:"Галочка",Select:"Выпадающее меню","Вариант 1\\nВариант 2\\nВариант 3":"",Options:"Опции",Radio:"Переключатель",File:"Файл",Form:"Форма","Add Field":"Добавить поле","Button text:":"Текст кнопки:","Button color:":"Цвет кнопки:","Show success window":"Окно благодарности",Image:"Изображение","Select image file":"Выбирите изображение","Upload image file":"Загрузить изображение","Order button":"Кнопка заказа","Button behavior after click:":"Поведение кнопки после клика:","Show order form":"Показать форму заказа","Go to the link":"Перейти по ссылке",Link:"Ссылка","Show form":"Показать форму","Media files":"Медиафайлы",Video:"Видео","Video url (youtube or vimeo):":"Видео ссылка:","example: www.youtube.com/embed/xbK8rl9wH4Q":"пример: www.youtube.com/embed/xbK8rl9wH4Q","Exact date":"Дата окончания","Every month":"Ежемесячно","Every week":"Еженедельно","Every day":"Ежедневно","Date:":"Дата:","Day:":"День:","Day of week:":"День недели:","Time:":"Время:","Image title:":"Заголовок изображения:","Image description:":"Подзаголовок изображения:","Upload image":"Загрузить изображение","Show description and order button":"Описание и кнопка заказа","Show order button":"Кнопка заказа","Background color:":"Цвет фона:","Background image:":"Фоновое изображение:","Add noise":"Добавить шум","Show text above the button":"Текст над кнопкой","Add arrow":"Добавить стрелочку","Show text under the form title":"Подзаголовок формы","Show second title":"Подзаголовок","Show third title":"Доп. подзаголовок","Show text under the form":"Текст под формой","Show border from media":"Края у медиа","Show list box":"Список","Form align:":"Положение формы:","Move left<br>":"слева<br>","Move center<br>":"по центру<br>","Move right":"справа","Background texture:":"Текстура фона:","Show first title":"Заголовок","Show border from icon":"Края у иконки","Show name benefit":"Название преимущества","Show description benefit":"Описание преимущества","Show border from image":"Края у изображения","Show image":"Показывать изображение","Show name":"Назваие","Show description":"Описание","Show price":"Цена","Show text above order button":"Показывать ","Show shadow":"Добавить тень","Image size:":"Размер изображения:","middle<br>":"средний<br>",large:"большой","Image format:":"Форма изображения:","circle<br>":"круг<br>",square:"квадрат","Show image name":"Название изображения","Show image signature":"Подпись изображения","Show image descroption":"Описание изображение","Show big image (enable fancybox)":"Увеличивать при клике(вкл. fancybox)","Grayscale logo":"Обесцветить лого","Show name company":"Название компании","Show branch company":"Направление компании","Show name step":"Название шага","Show description step":"Описание шага","Add placemark":"Добавить метку",center:"центр","Show text":"Показать текст",Name:"Название",Address:"Адрес",Color:"Цвет","Show policy":"Политика конфиденциальности","Show copyright":"Права","Show second text title":"Текст под заголовом","Show border":"Добавить рамку","Video size:":"Размер видео:","small<br>":"маленький<br>","medium<br>":"средний<br>","Show list":"Добавить список","Show name cell":"Название","Show description cell":"","Icons color:":"Цвет иконок:",black:"",grey:"серый",white:"","Digits color:":"Цвет цифр:","Background:":"Фон:","Countdown color:":"Цвет таймера:","Second title color:":"Цвет подзаголовка:","Show second name":"Подзаголовок","Show image border":"Рамка у картинки","Media file":"Медиа файл","example: www.youtube.com/embed/P55qVX3y134":"","Select file":"Выбрать файл","Countdown settings":"Настройки таймера","Exact date<br>":"Дата окончания<br>","Every month<br>":"Ежемесячно<br>","Every week<br>":"Еженедельно<br>","Every day<br>":"Ежедневно<br>",Monday:"Понедельник",Tuesday:"Вторник",Wednesday:"Среда",Thursday:"Четверг",Friday:"Пятница",Saturday:"Суббота",Sunday:"Воскресенье","Option 1\\nOption 2\\nOption 3":"Вариант 1\\nВариант 2\\nВариант 3","Remove confirmation":"Подтвердите удаление","Show icon around":"Линия вокруг иконки","Show image around":"Рамка у изображения","Show image shadow":"Добавить тень","Show shadow under image":"Тень под изображением","Image shape:":"Форма изображения:","Show noise":"Добавить шум к изображению","Show arrow":"Стрелочка к кнопке","left<br>":"слева<br>","center<br>":"по центру<br>",right:"справа","Show image title":"Название изображения","Show block with text":"Блок с текстом","Show image description":"Описание изображения","black<br>":"черный<br>","white<br>":"белый<br>","Numbers color:":"Цвет цифр:"}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/editor.css",!0),require.define("http://dev1.lpcandy.ru/view/editor/style/font-awesome.css",!0),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/checkbox.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return ui.checkbox=ui.check.extend({init:function(a){this._super(a),this.element.addClass("ui-checkbox")}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/block.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return window.lp={},lp.formComposite=teacss.ui.composite.extend({setValue:function(a){if(!this.innerForm)return;this.innerForm.setValue(a||{})}}),lp.block=teacss.ui.control.extend({init:function(a){this._super(a);var b=this;this.cmp=this.options.cmp,this.element=this.cmp.element,this.variantValues={},this.variantDefault={},this.options.configForm?this.configButton=$("<div class='fa fa-gear lp-button right'>").click(function(){b.config({my:"right top",at:"right top",of:b.configButton})}):this.configButton="",this.dragButton=$("<div class='fa fa-arrows lp-button right draggable'>").data("component",b.cmp),this.removeButton=$("<div class='fa fa-trash-o lp-button right'>"),this.prevButton=$("<div class='fa fa-chevron-left lp-button'>"),this.nextButton=$("<div class='fa fa-chevron-right lp-button'>"),this.variantLabel=$("<div class='lp-variant-label'>"),this.dragButton.click(function(){}),this.removeButton.click(function(){b.remove()}),this.prevButton.mousedown(function(a){b.prev(),a.preventDefault()}),this.nextButton.mousedown(function(a){b.next(),a.preventDefault()}),b.options.init&&b.options.init.call(b)},setValue:function(a){this._super(a),this.id=a.id,this.type=a.type;var b=this;this.cmp.componentHandle.detach();if(this.controls)return;b.element=b.cmp.element,b.controls=$("<div class='cmp-controls'>").appendTo(this.cmp.element),b.variants=this.cmp.element.children("[data-variant]").each(function(){var a=$.parseJSON($(this).attr("data-default")),c=$(this).attr("data-variant");b.variantDefault[c]=$.extend(a||{},{variant:parseInt(c)}),$(this).attr("data-default",null)}),b.variants.length>1?(b.current=this.cmp.element.attr("data-current"),b.controls.append(this.prevButton,this.nextButton,this.variantLabel)):b.current=1,b.bindEditors(),b.showCurrent(a),b.controls.append(this.configButton,this.dragButton,this.removeButton)},reloadHtml:function(){var a=this;a.controls.detach(),a.controls=null,a.cmp.reloadHtml(a.getValue())},remove:function(){var a=this;ui.confirm({title:_t("Remove confirmation"),text:_t("Sure to remove component?")},function(b){b&&a.cmp.remove()})},prev:function(){this.variantValues[this.current]=this.value,this.current=(this.current-2+this.variants.length)%this.variants.length+1,this.showCurrent(),this.editorChange("variant",this.current)},next:function(){this.variantValues[this.current]=this.value,this.current=this.current%this.variants.length+1,this.showCurrent(),this.editorChange("variant",this.current)},config:function(a){function e(){var a=d.form;if(!a.innerForm)return;var b=a.getValue();$.each(a.innerForm.items,function(a,c){var d=c.options.showWhen;if(d){var e=!0;for(var f in d)$.isArray(d[f])?jQuery.inArray(b[f],d[f])==-1&&(e=!1):d[f]!=b[f]&&(e=!1);e?c.element.show():c.element.hide()}})}var b=this,c=b.options.configForm.id||"dialog",d=b.Class[c];if(!d){var f=500,g=undefined,h;b.options.configForm.width&&(f=b.options.configForm.width,delete b.options.configForm.width),b.options.configForm.height&&(g=b.options.configForm.height,delete b.options.configForm.height),b.options.configForm.item?h=b.options.configForm.item({}):h=lp.formComposite(b.options.configForm),d=this.Class[c]=teacss.ui.dialog({width:f,height:g,modal:!1,title:b.options.configForm.title||_t("Settings"),resizable:!1,items:[h],open:function(){d.detached.appendTo(d.element),lp.configOverlay||(lp.configOverlay=$("<div>").css({position:"absolute",left:0,right:0,top:0,bottom:0,zIndex:2e4}).click(function(){$(".ui-dialog-content:visible").dialog("close"),$(".button-select-panel:visible").hide()}),Component.previewFrame.$f("body").append(lp.configOverlay)),lp.configOverlay.show()},close:function(){lp.configOverlay.hide()}}),h.bind("change",function(){b.Class.current.value=h.getValue(),e(),b.Class.current.trigger("change")}),d.form=h}d.form.setValue(this.value),this.Class.current=this,e(),d.detached=d.element.children().detach();if(a){a=$.extend({},a);var i=a.of.offset(),j=$(Component.previewFrame.window).scrollTop(),k=Component.previewFrame.frame.offset(),l=Math.floor(k.top-j);a.at=a.at.replace("top","top+"+l+"px"),d.element.dialog("option","position",a)}$(".ui-dialog-content:visible").dialog("close"),d.open()},getDefault:function(a){return a===undefined&&(a=this.current),this.variantDefault[a]},showCurrent:function(a){var b=this,c=this.variants.hide().eq(this.current-1),d=this.getDefault();a&&(this.variantValues[this.current]=a),this.value=$.extend(!0,{},d,this.variantValues[this.current]||{type:b.type,id:b.id}),c.show(),b.variant=c,$.each(b.editors,function(a,c){var d=teacss.ui.prop(b.value,c.options.name);c.setValue(d)}),this.variantLabel.text(this.current+"/"+this.variants.length)},bindEditors:function(a){var b=this;b.editors=[],this.variants.each(function(c,d){var e=$(this).attr("data-variant");$(this).find("[data-editor]:not([data-dummy] *)").each(function(){var c=$(this).attr("data-editor"),d=$(this).attr("data-name"),f=$(this).data("editor-control");if(!f&&d){var g=$(this).attr("data-options");g=g?JSON.parse(g):{},$(this).removeAttr("data-options"),f=Component.classFromName(c)($.extend(g,{element:$(this)})),$(this).data("editor-control",f),f.options.name=d,f.options.block=b,f.options.variant=e,f.bind("change",function(){b.editorChange(f.options.name,f.getValue(),f)})}if(f){if(a){var h=teacss.ui.prop(b.value,f.options.name);f.setValue(h)}b.editors.push(f)}})})},editorChange:function(a,b,c){var d=this;this.value=this.value||{},teacss.ui.prop(this.value,a,b),c&&$.each(d.editors,function(e,f){f!=c&&a==f.options.name&&d.value.variant==f.options.variant&&(f.setValue(b),f.options.change&&f.options.change.call(f))}),this.trigger("change")}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/repeater.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.repeater=teacss.ui.control.extend({init:function(a){this._super($.extend({addItemText:_t("Add Item"),sortable:!0},a)),this.element=this.options.element,this.options.name=this.element.data("name"),this.addCovers();var b=this;this.element.on("click",".lp-config-button",function(){var a=$(this).parents(".item_block").eq(0);b.config({my:"left top",at:"right top",of:$(this)},a)}),this.element.on("click",".lp-remove-button",function(){var a=$(this).parents(".item_block").eq(0);b.remove(a)}),this.element.on("mouseover",".lp-remove-button",function(){$(this).parents(".item_block").eq(0).find(".cmp-remove-cover").show()}),this.element.on("mouseout",".lp-remove-button",function(){$(this).parents(".item_block").eq(0).find(".cmp-remove-cover").hide()})},itemIndex:function(a){a=$(a),this.refreshItems();var b=this.items.index(a);if(b==-1){var b=a.index(),c=this.items.last().index();return b>c?b-c-1-1:c-b+1}return b},indexItems:function(a){var b=this.items.last().index(),c=this.element.children();return this.items.eq(a).add(c.eq(b+a+1+1)).filter(".item_block:not([data-dummy])")},config:function(a,b){var c=this,d=c.itemIndex(b),e=c.value[d];lp.block.prototype.config.call({Class:c.Class,options:{configForm:c.options.configForm},value:e,trigger:function(a){if(a!="change")return;c.value[d]=this.value;if(c.options.itemChange){var b=this.value;c.indexItems(d).each(function(){c.options.itemChange.call(c,b,$(this))})}c.trigger("change")}},a)},addAfter:function(a){var b=this.options.block,c=teacss.ui.prop(b.getDefault(),this.options.name),d=$.extend(!0,{},c[0]),e=a?this.itemIndex(a):-1;e==this.items.length-1||e==-1?this.value.push(d):this.value.splice(e+1,0,d);var f=this.element.find("> [data-dummy]"),g=f.clone().removeAttr("data-dummy");a?g.insertAfter(a):g.insertBefore(f),this.trigger("change"),this.addCovers(),this.bindEditors()},remove:function(a){var b=this.itemIndex(a);this.indexItems(b).remove(),this.value.splice(b,1),this.trigger("change"),this.refreshItems(),this.bindEditors()},refreshItems:function(){this.items=this.element.children("[class=item_block]:not([data-dummy])")},addCovers:function(){var a=this;a.refreshItems(),a.items.each(function(b){var c=$(this);c.find("> .cmp-repeater-cover").length==0&&(c.append(c.cover=$("<div class='cmp-repeater-cover'>"),c.removeCover=$("<div class='cmp-cover cmp-remove-cover fa fa-trash-o'>").css({opacity:1}).hide(),c.dragCover=$("<div class='cmp-cover cmp-drag-cover fa fa-arrows'>").css({opacity:1}).hide(),c.addCover=$("<div class='cmp-cover cmp-add-cover'>").css({opacity:1}).hide()),a.options.configForm&&c.cover.append($("<div class='fa fa-gear lp-button lp-config-button'>")),a.options.inline?(c.cover.addClass("cmp-repeater-cover-inline"),a.options.sortable&&c.cover.append($("<div class='fa fa-arrows lp-button lp-drag-handle'>").mouseover(function(){c.dragCover.show()}).mouseout(function(){c.dragCover.hide()}))):c.cover.append($("<div class='fa fa-plus lp-button'>").mouseover(function(){c.addCover.show()}).mouseout(function(){c.addCover.hide()}).click(function(){a.addAfter(c)})),c.cover.append($("<div class='fa fa-trash-o lp-button lp-remove-button'>")))}),!a.addButton&&a.options.inline&&a.element.append(a.addButtonWrap=$("<div class='lp-button-repeater-add-wrap'>").append(a.addButton=$("<div class='fa fa-plus lp-button lp-button-repeater-add'>").text(a.options.addItemText).click(function(){a.addAfter()}))),a.options.inline&&a.initSorting()},initSorting:function(){var a=this,b=!1,c=null,d=!1,e=0;a.items.find(".lp-drag-handle").unbind("mousedown mouseup").mousedown(function(){b=!0}).mouseup(function(){b=!1}),a.items.unbind("dragstart dragover dragenter drop dragend").attr("draggable","true").bind("dragstart",function(d){if(!b)return!1;b=!1;var f=d.originalEvent.dataTransfer;f.effectAllowed="move",f.setData("Text","dummy"),c=this,a.element.addClass("dragging"),e=a.itemIndex(c)}).bind("dragend",function(b){var d=a.itemIndex(c);c=null,a.element.find(".cmp-drag-cover").hide(),a.element.removeClass("dragging"),e!=d&&(a.value.splice(d,0,a.value.splice(e,1)[0]),a.trigger("change"))}).bind("dragover",function(b){b.preventDefault(),b.originalEvent.dataTransfer.dropEffect="none";if(this==c)return;if(d)return;return a.itemIndex(c)<a.itemIndex(this)?$(c).insertAfter(this):$(c).insertBefore(this),d=!0,setTimeout(function(){d=!1},100),!1})},bindEditors:function(){var a=this;a.items.each(function(b){$(this).find("[data-editor]").each(function(){var c=$(this).data("name");if(c.indexOf(a.options.name)!==0)return;var d=c.substring((a.options.name+".").length),e=d.split(".");e[0]=b;var f=a.options.name+"."+e.join(".");if(f!=c){$(this).attr("data-name",f);var g=$(this).data("editor-control");g&&(g.options.name=f)}})}),this.options.block.bindEditors(!0)}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/lib/spacedText/spacedText.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return function(a){typeof $document=="undefined"&&($document=a(document)),a.fn.spacedClickOut=function(b,c){var d=".spacedClickOut_"+Math.floor(Math.random()*9e3+1e3);return setTimeout(a.proxy(function(){$document.on("click"+d,a.proxy(function(e){!a(e.target).is(this)&&this.has(e.target).length===0&&($document.off("click"+d),e.delegateTarget=this.get(),c===undefined?b.call(this,e):c.call(this,e))},this))},this),50),"click"+d}}(jQuery),function(a){typeof $document=="undefined"&&($document=a(document));var b=function(b,c){return this.$item=a(b),this.is_inner=typeof c.append_to!="undefined",this.opts=a.extend({value:"#FFFFFF",gradient_value:!1,type:"fill",show:!1,append_to:!1,change:function(){},on_done:function(){},on_cancel:function(){}},c),this.data={},this.event_scope=".spacedColors_"+Math.floor(Math.random()*9e3+1e3),this.init(),this};b.prototype={is_inner:!1,gradient_scale:1.75,colorname_table:{black:"#000000",gray:"#808080",grey:"#808080",silver:"#C0C0C0",lightgray:"#D3D3D3",white:"#FFFFFF",red:"#FF0000",pink:"#FFC0CB",orange:"#FFA500",yellow:"#FFFF00",violet:"#EE82EE",purple:"#800080",magenta:"#FF00FF",brown:"#A52A2A",maroon:"#800000",olive:"#808000",lime:"#00FF00",green:"#008000",aqua:"#00FFFF",blue:"#0000FF",navy:"#000080"},init:function(){typeof this.opts.value=="object"?this.data.value=this.opts.value.value:this.opts.value?this.data.value=this.opts.value:this.data.value="#FFFFFF",this.data.value=="transparent"&&(this.data.value="#FFFFFF"),this.is_hex(this.data.value)?this.data.hex=this.expandHex(this.data.value):this.data.hex=this.color2hex(this.data.value),this.data.hsb=this.hex2hsb(this.data.hex),this.data.opacity=this.color2opacity(this.data.value),this.data.opacity>1?this.data.opacity=1:this.data.opacity<0&&(this.data.opacity=0),(this.is_inner||this.opts.show)&&this.show()},destroy:function(){this.$selector&&this.$selector.remove(),a(document).off(this.event_scope)},show:function(){this.$selector=a('<div class="spacedColors spacedColors-selector"></div>'),this.$selector.append('<div class="spacedColors-hues"><div class="spacedColors-huePicker"></div></div>').append('<div class="spacedColors-colors" style="background-color: #FFF;"><div class="spacedColors-colorPicker"><div class="spacedColors-colorPicker-inner"></div></div>').hide();if(this.is_inner)this.$selector.addClass("is_inner");else{var b=a('<div class="spacedColors-buttons"><a class="spacedColors-buttons_done" data-value="done"><span>Готово</span></a><a class="spacedColors-buttons_cancel" data-value="cancel"><span>Отмена</span></a></div>');this.$selector.append(b),b.on("click","a",a.proxy(function(b){var c=a(b.currentTarget).attr("data-value");c=="done"&&typeof this.opts.on_done=="function"?this.opts.on_done(this.data):c=="cancel"&&typeof this.opts.on_cancel=="function"&&this.opts.on_cancel(this.data),this.destroy()},this)),this.$selector.spacedClickOut(a.proxy(function(){this.opts.on_done(this.data),this.destroy()},this))}this.$color_picker=this.$selector.find(".spacedColors-colorPicker"),this.$hue_picker=this.$selector.find(".spacedColors-huePicker"),this.show_opacity(),this.show_input(),this.show_gradient();var c=this.data.hsb;this.$selector.find(".spacedColors-colors").css("backgroundColor","#"+this.hsb2hex({h:c.h,s:100,b:100})).end().find(".spacedColors-opacity").css("backgroundColor","#"+this.hsb2hex({h:c.h,s:c.s,b:c.b})).end(),this.colorPosition=this.getColorPositionFromHSB(this.data.hsb),this.huePosition=this.getHuePositionFromHSB(this.data.hsb),this.opacityPosition=this.getOpacityPositionFromAlpha(this.data.opacity),this.$color_picker.css("top",this.colorPosition.y+"px").css("left",this.colorPosition.x+"px"),this.$hue_picker.css("top",this.huePosition+"px"),this.$opacity_picker&&this.$opacity_picker.css("left",this.opacityPosition+"px"),this.mousebutton=0;var d=this.is_inner?this.opts.append_to:"body";a(d).append(this.$selector);if(!this.is_inner){var e=300,f=600;if(this.opts.element){var g=a(this.opts.element).offset(),h=a(this.opts.element).closest("body").scrollTop();e=g.top-h,f=g.left,this.opts.element_offset&&(e+=this.opts.element_offset.top||0,f+=this.opts.element_offset.left||0),e=e-this.$selector.height()+8,e<50&&(e=50)}this.$selector.css({top:e,left:f})}this.$selector.fadeIn(100),this.$selector.on("selectstart",function(){return!1}),this.$selector.on("mousedown"+this.event_scope+" touchstart"+this.event_scope,a.proxy(function(b){if(a(b.target).is('input[type="text"]'))return!0;this.mousebutton=1;var c=a(b.target).parents().andSelf();c.hasClass("spacedColors-colors")&&(b.preventDefault(),this.moving="colors",this.move_color(b)),c.hasClass("spacedColors-hues")&&(b.preventDefault(),this.moving="hues",this.move_hue(b)),c.hasClass("spacedColors-opacity")&&(b.preventDefault(),this.moving="opacity",this.move_opacity(b));if(c.hasClass("color_gradient_pick_line")&&this.opts.type=="gradient"){var d=a(b.target);d.is(".color_gradient_pick_line")?(b.preventDefault(),this.addGadientPointEvent(b)):(d.is(".color_gradient_pick_value")&&(d=a(b.target).parent()),d.is(".color_gradient_pick")&&(b.preventDefault(),this.$moving_gradient_pick=d,this.moving="gradient",this.setGradientPointActive(d),this.move_gradient(b)))}if(c.hasClass("spacedColors-selector")){b.preventDefault();return}if(c.hasClass("spacedColors"))return;this.is_inner||this.hide()},this)),a(document).on("mouseup"+this.event_scope+" touchend"+this.event_scope,a.proxy(function(a){this.mousebutton=0,this.moving=undefined},this)),a(document).on("mousemove"+this.event_scope+" touchmove"+this.event_scope,a.proxy(function(b){if(a(b.target).is('input[type="text"]'))return!0;this.mousebutton===1&&(b.preventDefault(),this.moving==="colors"&&this.move_color(b),this.moving==="hues"&&this.move_hue(b),this.moving==="opacity"&&this.move_opacity(b),this.moving==="gradient"&&this.move_gradient(b))},this))},show_input:function(){this.$input_text=a('<input type="text">').val(this.data.value),this.$selector.append(this.$input_text),this.$selector.addClass("is_show_input"),this.$input_text.on("keyup",a.proxy(function(b){var c=a(b.currentTarget).val(),d=this.color2hex(c),e=this.color2opacity(c);if(d===!1)return this.$input_text.addClass("is_invalid"),!0;this.$input_text.is(".is_invalid")&&this.$input_text.removeClass("is_invalid"),this.data.value=c,this.data.opacity=e,this.opts.opacity&&(this.opacityPosition=this.getOpacityPositionFromAlpha(this.data.opacity),this.$opacity_picker.css("left",this.opacityPosition+"px")),this.inputTextlock=!0;var f=this.hex2hsb(d);this.set_color(f)},this)),this.$input_text.wrap('<div class="spacedColors-input"></div>')},show_opacity:function(){return this.opts.opacity?(this.$selector.addClass("is_show_opacity"),this.$selector.prepend('<div class="spacedColors-opacity"><div class="spacedColors-opacityPicker"></div></div><div class="spacedColors-opacityText">Прозрачность</div>'),this.$opacity_picker=this.$selector.find(".spacedColors-opacityPicker"),!0):!1},show_gradient:function(){if(this.opts.type!="gradient")return!1;this.$selector.addClass("is_show_gradient");var b=a('<div class="spacedColors-gradient"></div>');this.$gradient_line=a('<div class="color_gradient_line"></div>'),this.$gradient_pick_list=a('<div class="color_gradient_pick_line"></div>'),this.$gradient_btn=a('<div class="color_gradient_btn"></div>');var c=a('<a class="color_gradient_pick_remove" title="Удалить активную точку градиента"></a>');b.append('<div class="spacedColors-gradientText">Направление градиента</div>'),this.$gradient_btn.append('<a class="edit_btn" data-value="top" title="Вниз"></a>'),this.$gradient_btn.append('<a class="edit_btn" data-value="top_left" title="В правый нижний угол"></a>'),this.$gradient_btn.append('<a class="edit_btn" data-value="top_right" title="В правый верхний угол"></a>'),this.$gradient_btn.append('<a class="edit_btn" data-value="left" title="Вправо"></a>'),this.$gradient_btn.append('<a class="edit_btn" data-value="radial" title="Радиальный"></a>'),this.gradient_type=this.opts.gradient_value.type,this.gradient_values=this.opts.gradient_value.values,typeof this.gradient_values!="object"&&(this.gradient_values={0:this.data.value,100:this.data.value}),a.each(this.gradient_values,a.proxy(function(a,b){this.addGadientPoint(a,b)},this)),c.on("click touchstart",a.proxy(function(a){a.preventDefault();if(this.$gradient_current_point.siblings().length<2){alert("Нельзя удалить основные точки");return}this.removeGadientPoint(this.$gradient_current_point)},this)),this.$gradient_btn.on("click touchstart","a.edit_btn",a.proxy(function(b){b.preventDefault(),this.setGradientType(a(b.target).attr("data-value"))},this));var d=this.$gradient_pick_list.find("div.color_gradient_pick:eq(0)");return this.setGradientPointActive(d),this.$gradient_btn.append(c),typeof this.gradient_type!="string"&&(this.gradient_type="top"),this.setGradientType(this.gradient_type),b.append(this.$gradient_btn).append(this.$gradient_line).append(this.$gradient_pick_list),this.$selector.append(b),this.updateGradient(),!0},hide:function(){this.$selector.fadeOut(100,a.proxy(function(){this.$selector.remove()},this)),a(document).off(this.event_scope)},move_color:function(a){this.$color_picker.hide();var b={x:a.pageX,y:a.pageY};a.originalEvent.changedTouches&&(b.x=a.originalEvent.changedTouches[0].pageX,b.y=a.originalEvent.changedTouches[0].pageY),b.x=b.x-this.$selector.find(".spacedColors-colors").offset().left-6,b.y=b.y-this.$selector.find(".spacedColors-colors").offset().top-6,b.x<=-5&&(b.x=-5),b.x>=144&&(b.x=144),b.y<=-5&&(b.y=-5),b.y>=144&&(b.y=144),this.colorPosition=b,this.$color_picker.css("left",b.x).css("top",b.y).show();var c=Math.round((b.x+5)*.67);c<0&&(c=0),c>100&&(c=100);var d=100-Math.round((b.y+5)*.67);d<0&&(d=0),d>100&&(d=100);var e=this.data.hsb;e.s=c,e.b=d,this.set_color(e)},move_hue:function(a){this.$hue_picker.hide();var b=a.pageY;a.originalEvent.changedTouches&&(b=a.originalEvent.changedTouches[0].pageY),b=b-this.$selector.find(".spacedColors-colors").offset().top-1,b<=-1&&(b=-1),b>=149&&(b=149),this.huePosition=b,this.$hue_picker.css("top",b).show();var c=Math.round((150-b-1)*2.4);c<0&&(c=0),c>360&&(c=360);var d=this.data.hsb;d.h=c,this.set_color(d)},move_opacity:function(a){this.$opacity_picker.hide();var b=a.pageX;a.originalEvent.changedTouches&&(b=a.originalEvent.changedTouches[0].pageX),b=b-this.$selector.find(".spacedColors-colors").offset().left-1;var c=175;b<=-1&&(b=-1),b>=c-1&&(b=c-1),this.opacityPosition=b,this.$opacity_picker.css("left",b).show(),this.data.opacity=parseFloat((c-b-1)/c).toFixed(2),this.data.opacity<0&&(this.data.opacity=0),this.data.opacity>1&&(this.data.opacity=1),this.set_color(this.data.hsb)},move_gradient:function(a){if(!this.$moving_gradient_pick||!this.$moving_gradient_pick.is(".color_gradient_pick"))return;if(a.offsetY>70&&this.$moving_gradient_pick.parent().children().length>2){this.removeGadientPoint(this.$moving_gradient_pick);return}var b=a.pageX;a.originalEvent.changedTouches&&(b=a.originalEvent.changedTouches[0].pageX),b=b-this.$selector.find(".spacedColors-colors").offset().left-1;var c=175;b<=-1&&(b=-1),b>=c-1&&(b=c-1),this.$moving_gradient_pick.css("left",b),this.last_change=Math.random(),this.change()},addGadientPointEvent:function(a){var b=a.pageX;a.originalEvent.changedTouches&&(b=a.originalEvent.changedTouches[0].pageX),b=b-this.$selector.find(".spacedColors-colors").offset().left-1;var c=175;b<=-1&&(b=-1),b>=c-1&&(b=c-1);var d=parseInt(b/this.gradient_scale),e="#FFFFFF",f=this.addGadientPoint(d,e);this.setGradientPointActive(f)},addGadientPoint:function(b,c){var d=parseInt(b*this.gradient_scale),e=a('<div class="color_gradient_pick" style="left:'+d+'px"><div class="color_gradient_pick_value" style="background-color: '+c+';"></div></div>');return this.$gradient_pick_list.append(e),e.data("value",c),e},setGradientPointActive:function(a){a.siblings().removeClass("is_active"),a.addClass("is_active"),this.$gradient_current_point=a,this.last_change=Math.random();var b=this.hex2hsb(this.$gradient_current_point.data("value"));this.set_color(b),this.colorPosition=this.getColorPositionFromHSB(this.data.hsb),this.huePosition=this.getHuePositionFromHSB(this.data.hsb),this.opacityPosition=this.getOpacityPositionFromAlpha(this.data.opacity),this.$color_picker.css("top",this.colorPosition.y+"px").css("left",this.colorPosition.x+"px"),this.$hue_picker.css("top",this.huePosition+"px"),this.$opacity_picker&&this.$opacity_picker.css("left",this.opacityPosition+"px")},setGradientType:function(a){this.gradient_type=a,this.$gradient_btn.find(".edit_btn").removeClass("is_active"),this.$gradient_btn.find('.edit_btn[data-value="'+a+'"]').addClass("is_active"),this.last_change=Math.random(),this.change()},removeGadientPoint:function(a){a.remove();var b=this.$gradient_pick_list.find("div.color_gradient_pick").eq(0);this.setGradientPointActive(b)},set_color:function(a){this.data.hsb=a;var b=this.hsb2rgb(a),c=this.hsb2hex(a);this.opts.opacity&&this.data.opacity!=1?this.data.value="rgba("+b.r+","+b.g+","+b.b+","+parseFloat(this.data.opacity)+")":this.data.value="#"+c,this.$selector&&this.$selector.find(".spacedColors-colors").css("backgroundColor","#"+this.hsb2hex({h:a.h,s:100,b:100})).end().find(".spacedColors-opacity").css("backgroundColor","#"+c).end(),this.change()},change:function(){this.opts.type=="gradient"&&typeof this.$gradient_current_point!="undefined"&&(this.$gradient_current_point.find("div").css("background-color",this.data.value),this.$gradient_current_point.data("value",this.data.value),this.updateGradient()),this.inputTextlock?this.inputTextlock=!1:this.$input_text&&this.$input_text.val(this.data.value),this.last_change=this.data.value,this.$item&&this.$item.val(this.data.value),typeof this.opts.change=="function"&&this.opts.change(this.data,this.data.gradient_code)},updateGradient:function(){var b={};a.each(this.$gradient_pick_list.find("div.color_gradient_pick"),a.proxy(function(c,d){var f=a(d),g=parseInt(parseInt(f.css("left"))/this.gradient_scale);b[g]=f.data("value")},this)),this.gradient_data=b,this.data.gradient_code=this.getGradientCode();var c=this.getGradientCode(!0),d="";a.each(c.preview,function(a,b){d+="background: "+b+"; "}),this.$gradient_line.attr("style",d)},getGradient:function(){return this.gradient_data},getGradientCode:function(b){typeof b=="undefined"&&(b=!1);var c=this.gradient_type;b&&(c="left");var d=c=="radial"?"radial":"linear",e="",f="";a.each(this.getGradient(),a.proxy(function(a,b){c=="top"?a=a*10+"px":a+="%",e=b;var d=","+b+" "+a;f+=d},this));var g="-webkit-"+d+"-gradient("+this.getGradientCodeType("webkit",c)+f+") no-repeat",h="-moz-"+d+"-gradient("+this.getGradientCodeType("moz",c)+f+") no-repeat",i="-o-"+d+"-gradient("+this.getGradientCodeType("o",c)+f+") no-repeat",j="-ms-"+d+"-gradient("+this.getGradientCodeType("ms",c)+f+") no-repeat",k=d+"-gradient("+this.getGradientCodeType("main",c)+f+") no-repeat",l=[e,g,h,i,j,k];return b?{type:c,value:e,values:f,preview:l}:{type:c,value:e,values:f}},getGradientCodeType:function(a,b){if(a=="webkit_old")switch(b){case"left":return"linear, left top, right top";case"top":return"linear, left top, left bottom";case"top_left":return"linear, left top, right bottom";case"top_right":return"linear, left bottom, right top";case"radial":return"radial, center center, 0px, center center, 100%"}else if(a=="main")switch(b){case"left":return"to right";case"top":return"to bottom";case"top_left":return"135deg";case"top_right":return"225deg";case"radial":return"circle at top"}else switch(b){case"left":return"left";case"top":return"top";case"top_left":return"-45deg";case"top_right":return"225deg";case"radial":return"center top, circle cover"}},getColorPositionFromHSB:function(a){var b=Math.ceil(a.s/.67);b<0&&(b=0),b>150&&(b=150);var c=150-Math.ceil(a.b/.67);return c<0&&(c=0),c>150&&(c=150),{x:b-5,y:c-5}},getHuePositionFromHSB:function(a){var b=150-a.h/2.4;return b<0&&(h=0),b>150&&(h=150),b},getOpacityPositionFromAlpha:function(a){var b=175*a;return b<0&&(b=0),b>175&&(b=175),175-b},cleanHex:function(a){return typeof a!="string"?!1:a.replace(/[^A-F0-9]/ig,"")},expandHex:function(a){return a=this.cleanHex(a),a?(a.length===3&&(a=a[0]+a[0]+a[1]+a[1]+a[2]+a[2]),a.length===6?a:null):null},hsb2rgb:function(a){var b={},c=Math.round(a.h),d=Math.round(a.s*255/100),e=Math.round(a.b*255/100);if(d===0)b.r=b.g=b.b=e;else{var f=e,g=(255-d)*e/255,h=(f-g)*(c%60)/60;c===360&&(c=0),c<60?(b.r=f,b.b=g,b.g=g+h):c<120?(b.g=f,b.b=g,b.r=f-h):c<180?(b.g=f,b.r=g,b.b=g+h):c<240?(b.b=f,b.r=g,b.g=f-h):c<300?(b.b=f,b.g=g,b.r=g+h):c<360?(b.r=f,b.g=g,b.b=f-h):(b.r=0,b.g=0,b.b=0)}return{r:Math.round(b.r),g:Math.round(b.g),b:Math.round(b.b)}},rgb2hex:function(b){var c=[b.r.toString(16),b.g.toString(16),b.b.toString(16)];return a.each(c,function(a,b){b.length===1&&(c[a]="0"+b)}),c.join("")},hex2rgb:function(a){return a=parseInt(a.indexOf("#")>-1?a.substring(1):a,16),{r:a>>16,g:(a&65280)>>8,b:a&255}},rgb2hsb:function(a){var b={h:0,s:0,b:0},c=Math.min(a.r,a.g,a.b),d=Math.max(a.r,a.g,a.b),e=d-c;return b.b=d,b.s=d!==0?255*e/d:0,b.s!==0?a.r===d?b.h=(a.g-a.b)/e:a.g===d?b.h=2+(a.b-a.r)/e:b.h=4+(a.r-a.g)/e:b.h=-1,b.h*=60,b.h<0&&(b.h+=360),b.s*=100/255,b.b*=100/255,b},hex2hsb:function(a){var b=this.rgb2hsb(this.hex2rgb(a));return b.s===0&&(b.h=360),b},hsb2hex:function(a){return this.rgb2hex(this.hsb2rgb(a))},is_hex:function(b){return typeof b=="undefined"?!1:(b=a.trim(b),b=b.toLowerCase(),b.length<3||b.length>7?!1:(b.indexOf("#")>-1&&(b=b.substring(b.indexOf("#")+1)),/^([0-9a-f]{1,2}){3}$/i.test(b)))},is_rgb:function(b){return typeof b=="undefined"?!1:(b=a.trim(b),b=b.toLowerCase(),/\(([0-9]*)\,\s{0,1}([0-9]*)\,\s{0,1}([0-9]*)\,{0,1}\s{0,1}(.*){0,1}\)$/.test(b))},color2hex:function(b){b=b.toLowerCase(),b=a.trim(b);if(b.indexOf("#")>-1)return b.length>7?!1:b.substring(b.indexOf("#")+1);if(b.indexOf("rgb")>-1){var c=/\(([0-9]*)\,\s{0,1}([0-9]*)\,\s{0,1}([0-9]*)\,{0,1}\s{0,1}(.*){0,1}\)$/,d=c.exec(b);if(d!==null&&d.hasOwnProperty("1")&&d.hasOwnProperty("2")&&d.hasOwnProperty("3")){var e={};return e.r=parseInt(d[1]),e.g=parseInt(d[2]),e.b=parseInt(d[3]),e.r>255&&(e.r=255),e.g>255&&(e.g=255),e.b>255&&(e.b=255),e.r<0&&(e.r=0),e.g<0&&(e.g=0),e.b<0&&(e.b=0),this.rgb2hex(e)}return!1}return this.colorname_table.hasOwnProperty(b)?this.color2hex(this.colorname_table[b]):b.length==3||b.length==6?b:!1},color2opacity:function(b){b=b.toLowerCase(),b=a.trim(b);if(b.indexOf("#")>-1)return 1;if(b.indexOf("rgb")>-1){var c=/\(([0-9]*)\,\s{0,1}([0-9]*)\,\s{0,1}([0-9]*)\,{0,1}\s{0,1}(.*){0,1}\)$/,d=c.exec(b);if(d!==null&&d.hasOwnProperty("4")&&!isNaN(d[4])){var e=parseFloat(d[4]);return e>1?e=1:e<0&&(e=0),e}return 1}return 1}},a.fn.spacedColors=function(c){if(!(this.length<1))return this.each(function(){var d=a(this),e=d.data("spacedColors");e||(e=new b(d,c),d.data("spacedColors",e))});var d=a("<div></div>"),e=d.data("spacedColors");e||(e=new b(d,c),d.data("spacedColors",e))},a.fn.spacedColorsDestroy=function(){this.data("spacedColors")&&(this.data("spacedColors").destroy(),this.removeData("spacedColors"))},a.fn.spacedColorsSetColor=function(a){if(this.data("spacedColors")){var b=this.data("spacedColors"),c=b.hex2hsb(a);b.set_color(c)}},a.fn.spacedColorsGetColor=function(a){if(this.data("spacedColors"))return this.data("spacedColors").data}}(jQuery),function(a){typeof $document=="undefined"&&($document=a(document));var b=function(b,c){this.$editor=a(b),this.opts=a.extend({callback:!1,on_change:function(){},focus:!0,hotkeys:!0,convertLinks:!0,convertDivs:!1,toolbarExternal:!1,oneline:!1,htmlExternal:!1,allowedTags:["code","span","div","a","br","p","b","i","del","strike","u","img","blockquote","mark","cite","small","ul","ol","li","hr","dl","dt","dd","sup","sub","big","code","figure","figcaption","strong","em","table","tr","td","th","tbody","thead","tfoot","h1","h2","h3","h4","h5","h6"],allowedTagsPaste:["img","span","div","label","a","br","p","b","i","del","strike","u","small","ul","ol","li","hr","sup","sub","big","code","strong","em","h1","h2","h3","h4","h5","h6"],buttons:["bold","italic","underline","deleted","size","fontcolor","link","removeformat"],buttons_extra:["backcolor","alignleft","aligncenter","alignright","alignall","unorderedlist","orderedlist","outdent","indent","html"],activeButtons:["deleted","italic","bold","underline","unorderedlist","orderedlist","alignleft","aligncenter","alignright","alignall"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},emptyHtml:"<p><br></p>",buffer:!1,visual:!0,toolbar:{html:{title:"Редактор HTML",func:"toggle"},bold:{title:"Жирный",exec:"bold"},italic:{title:"Курсив",exec:"italic"},deleted:{title:"Зачеркнутый",exec:"strikethrough"},underline:{title:"Подчеркнутый",exec:"underline"},size:{title:"Размер",func:"show_size"},link:{title:"Вставить ссылку",func:"show_link"},fontcolor:{title:"Цвет текста",func:"show_color_font"},backcolor:{title:"Цвет фона",func:"show_color_back"},removeformat:{title:"Очистить форматирование",exec:"removeFormat"},unorderedlist:{title:"&bull; Ненумерованный список",exec:"insertunorderedlist"},orderedlist:{title:"1. Нумерованный список",exec:"insertorderedlist"},outdent:{title:"&lt; Сдвиг влево",exec:"outdent"},indent:{title:"&gt; Сдвиг вправо",exec:"indent"},alignleft:{title:"Выравнивание по левому краю",exec:"JustifyLeft"},aligncenter:{title:"Выравнивание по центру",exec:"JustifyCenter"},alignright:{title:"Выравнивание по правому краю",exec:"JustifyRight"},alignall:{title:"Выравнивание по ширине",exec:"JustifyFull"}}},c,this.$editor.data()),this.init()};b.prototype={init:function(){this.document=this.opts.document?this.opts.document:document,this.window=this.opts.window?this.opts.window:window,this.$html=a('<textarea class="spacedText_html" name="'+this.$editor.attr("id")+'"></textarea>'),this.$html.addClass("spacedText_html").hide(),a(this.opts.htmlExternal).html(this.$html),this.$editor.addClass("spacedText").attr("contenteditable",!0);var b=this.$editor.html();b=this.to_p(b),this.$editor.html(b),this.update(!0),this.build_toolbar();if(this.opts.activeButtons!==!1&&this.opts.toolbar!==!1){var c=a.proxy(function(){this.watch()},this);this.$editor.click(c).keyup(c)}this.is_mobile()===!1&&this.is_old_safari()===!1&&this.$editor.bind("paste",a.proxy(function(b){this.pasteRunning=!0,this.set_buff(),this.saveScroll=this.document.body.scrollTop;var c=this.extract_content();setTimeout(a.proxy(function(){var a=this.extract_content();this.$editor.append(c),this.restore_selection();var b=this.get_html_fragment(a);this.paste_clean_up(b),this.pasteRunning=!1},this),1)},this)),this.bind_keyup(),this.bind_keydown();if(this.browser("mozilla")){this.$editor.click(a.proxy(function(){this.save_selection()},this));try{this.document.execCommand("enableObjectResizing",!1,!1),this.document.execCommand("enableInlineTableEditing",!1,!1)}catch(d){}}this.opts.focus&&setTimeout(a.proxy(function(){this.$editor.focus()},this),1),typeof this.opts.callback=="function"&&this.opts.callback(this),this.$toolbar.find("a").attr("tabindex","-1"),this.$editor.on("click","a",a.proxy(function(a){this.show_link_menu(a)},this))},bind_keydown:function(){this.$editor.keydown(a.proxy(function(b){var c=b.keyCode||b.which,d=b.ctrlKey||b.metaKey;if(this.opts.oneline&&c===13)return b.preventDefault(),!1;d&&this.opts.hotkeys&&(c===90?this.opts.buffer!==!1?(b.preventDefault(),this.get_buff()):b.shiftKey?this.hotkey(b,"redo"):this.hotkey(b,"undo"):c===77?this.hotkey(b,"removeFormat"):c===66?this.hotkey(b,"bold"):c===73&&this.hotkey(b,"italic")),!d&&c!==90&&(this.opts.buffer=!1),this.opts.hotkeys&&!b.shiftKey&&c===9?this.hotkey(b,"indent"):this.opts.hotkeys&&b.shiftKey&&c===9&&this.hotkey(b,"outdent");if(this.browser("webkit")&&navigator.userAgent.indexOf("Chrome")===-1)return b.shiftKey&&c===13?(b.preventDefault(),this.insert_node_at_caret(a("<span><br /></span>").get(0)),this.update(),!1):!0},this))},bind_keyup:function(){this.$editor.keyup(a.proxy(function(a){var b=a.keyCode||a.which;this.browser("mozilla")&&!this.pasteRunning&&this.save_selection();if(b===8||b===46)return this.format_empty(a);b===13&&!a.shiftKey&&!a.ctrlKey&&!a.metaKey&&(this.browser("webkit")&&this.format_new_line(a),this.opts.convertLinks&&this.$editor.linkfinder()),this.update()},this))},build_toolbar:function(){if(this.opts.toolbar===!1)return!1;this.$toolbar=a("<ul>").addClass("spacedText_toolbar"),a(this.opts.toolbarExternal).html(this.$toolbar),a.each(this.opts.buttons,a.proxy(function(b,c){if(typeof this.opts.toolbar[c]!="undefined"){var d=this.opts.toolbar[c];this.$toolbar.append(a("<li>").append(this.build_btn(c,d)));if(c=="size"){var e=a('<ul class="size"><li><a href="javascript:void(0);" data-size="-3"></a></li><li><a href="javascript:void(0);" data-size="-2"></a></li><li><a href="javascript:void(0);" data-size="-1"></a></li><li><a href="javascript:void(0);" data-size="0"></a></li><li><a href="javascript:void(0);" data-size="+1"></a></li><li><a href="javascript:void(0);" data-size="+2"></a></li><li><a href="javascript:void(0);" data-size="+3"></a></li></ul>');e.on("mousedown","a",a.proxy(function(a){this.show_size_value(a)},this)),this.$toolbar.find(".spacedText_btn_size").parent().addClass("size").append(e)}}},this));if(this.opts.buttons_extra.length>0){a.each(this.opts.buttons_extra,a.proxy(function(b,c){if(typeof this.opts.toolbar[c]!="undefined"){var d=this.opts.toolbar[c];this.$toolbar.append(a('<li class="spacedText_extra_only">').append(this.build_btn(c,d)))}},this));var b=a('<li><a class="spacedText_extra_btn"></a></li>');this.$toolbar.append(b),b.find("a").on("mousedown",a.proxy(function(a){return this.$toolbar.toggleClass("is_extra"),a.preventDefault(),!1},this))}},build_btn:function(b,c){var d=a('<a href="javascript:void(0);" title="'+c.title+'" class="spacedText_btn_'+b+'"></a>');return typeof c.func=="undefined"?d.mousedown(a.proxy(function(){if(!this.opts.visual){alertify.log("Функция недоступна в режиме HTML");return}a.inArray(b,this.opts.activeButtons)!=-1&&(this.all_btn_inactive(),this.set_btn_active(b)),this.browser("mozilla")&&this.$editor.focus(),this.execCommand(c.exec,b)},this)):c.func!=="show"&&d.mousedown(a.proxy(function(a){if(!this.opts.visual&&c.func!=="toggle"){alertify.log("Функция недоступна в режиме HTML");return}this[c.func](a)},this)),typeof c.callback!="undefined"&&c.callback!==!1&&d.mousedown(a.proxy(function(a){if(!this.opts.visual){alertify.log("Функция недоступна в режиме HTML");return}c.callback(this,a,b)},this)),d},get_btn:function(b){return this.opts.toolbar===!1?!1:a(this.$toolbar.find("a.spacedText_btn_"+b))},set_btn_active:function(a){this.get_btn(a).parent().addClass("spacedText_act")},set_btn_inactive:function(a){this.get_btn(a).parent().removeClass("spacedText_act")},all_btn_inactive:function(){a.each(this.opts.activeButtons,a.proxy(function(a,b){this.set_btn_inactive(b)},this))},hotkey:function(a,b){a.preventDefault(),this.execCommand(b,!1)},change:function(){var a=this.get_code();typeof this.opts.on_change=="function"&&this.opts.on_change(a,this.$editor)},update:function(a){this.$html.val(this.$editor.html()),a||this.change()},set_code:function(a){a=this.strip_tags(a),this.$editor.html(a).focus(),this.update()},get_code:function(){var a="";return this.opts.visual?a=this.$editor.html():a=this.$html.val(),this.strip_tags(a)},paste_html_at_caret:function(a){var b,c;if(this.document.getSelection){b=this.window.getSelection();if(b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var d=this.document.createElement("div");d.innerHTML=a;var e=this.document.createDocumentFragment(),f,g;while(f=d.firstChild)g=e.appendChild(f);c.insertNode(e),g&&(c=c.cloneRange(),c.setStartAfter(g),c.collapse(!0),b.removeAllRanges(),b.addRange(c))}}else this.document.selection&&this.document.selection.type!="Control"&&this.document.selection.createRange().pasteHTML(a)},destroy:function(){var b=this.get_code();this.$editor.removeClass("spacedText").removeAttr("contenteditable").html(b).show(),a(this.opts.toolbarExternal).empty(),this.modal_link&&this.modal_link.close(),this.modal_link_edit&&this.modal_link_edit.close()},watch:function(){var b=this.get_current_node();this.wait_size_change&&this.show_size_value(),this.all_btn_inactive(),a.each(this.opts.activeButtonsStates,a.proxy(function(c,d){a(b).closest(c,this.$editor.get()[0]).length!=0&&this.set_btn_active(d)},this));var c=a(b).closest(["p","div","h1","h2","h3","h4","h5","h6","blockquote","td"]);if(typeof c[0]!="undefined"&&typeof c[0].elem!="undefined"&&a(c[0].elem).size()!=0){var d=a(c[0].elem).css("text-align");switch(d){case"right":this.set_btn_active("alignright");break;case"center":this.set_btn_active("aligncenter");break;case"justify":this.set_btn_active("alignall");break;default:this.set_btn_active("alignleft")}}},set_buff:function(){this.save_selection(),this.opts.buffer=this.$editor.html()},get_buff:function(){if(this.opts.buffer===!1)return!1;this.$editor.html(this.opts.buffer),this.browser("msie")||this.restore_selection(),this.opts.buffer=!1},execCommand:function(b,c){if(this.opts.visual==0)return this.$html.focus(),!1;try{var d;if(b==="inserthtml")this.browser("msie")?(this.$editor.focus(),this.document.selection.createRange().pasteHTML(c)):this.paste_html_at_caret(c);else if(b==="unlink")d=this.get_parent_node(),a(d).get(0).tagName==="A"?a(d).replaceWith(a(d).text()):this.exec(b,c);else if(b==="JustifyLeft"||b==="JustifyCenter"||b==="JustifyRight"||b==="JustifyFull"){d=this.get_current_node();var e=this.get_selection(),f=[];if(a(d).parents(".spacedText").size()==0){var g=a(e.anchorNode),h=a(e.focusNode);g.get(0).tagName!="P"&&(g=g.closest("p")),h.get(0).tagName!="P"?h=h.closest("p"):h=h.prev();if(g.length<1&&h.length<1){var i=a(e.anchorNode).parent();if(i.is(".spacedText")&&i.find("p").length<1){var j=a("<p></p>").html(i.html());i.html(j),g=h=j}}var k=g.parent();if(g.length!=1||h.length!=1||!k.is(".spacedText"))return!1;if(g.get(0).offsetTop>h.get(0).offsetTop){var l=g;g=h,h=l}if(g.get(0)==h.get(0))f.push(g);else{var m=!1;k.children("p").each(function(b,c){var d=a(c);c==g.get(0)?(m=!0,f.push(d)):c==h.get(0)?(m=!1,f.push(d)):m&&f.push(d)});if(f.length<1)return log("ERR: не смогли определить нужные элементы P для выравнивания"),!1}}else{if(a.inArray(a(d).get(0).tagName,["P","DIV","H1","H2","H3","H4","H5","H6","BLOCKQUOTE","TD"])!=-1){this.exec(b,c),this.update();return}f.push(a(d))}a.each(f,a.proxy(function(a,c){var d="left";b==="JustifyCenter"?d="center":b==="JustifyRight"?d="right":b==="JustifyFull"&&(d="justify"),d===!1?c.attr("align",""):c.attr("align",d)},this))}else if(b==="formatblock"&&c==="blockquote"){d=this.get_current_node();if(a(d).get(0).tagName==="BLOCKQUOTE")if(this.browser("msie")){var n=a("<p>"+a(d).html()+"</p>");a(d).replaceWith(n)}else this.exec(b,"p");else if(a(d).get(0).tagName==="P"){var o=a(d).parent();if(a(o).get(0).tagName==="BLOCKQUOTE"){var n=a("<p>"+a(d).html()+"</p>");a(o).replaceWith(n),this.set_selection(n[0],0,n[0],0)}else if(this.browser("msie")){var n=a("<blockquote>"+a(d).html()+"</blockquote>");a(d).replaceWith(n)}else this.exec(b,c)}else this.exec(b,c)}else b!=="formatblock"||c!=="pre"&&c!=="p"?(b==="formatblock"&&this.browser("mozilla")&&this.$editor.focus(),this.exec(b,c)):this.exec(b,c);this.update(),this.old_ie()&&this.$editor.focus()}catch(p){}},exec:function(a,b){a==="formatblock"&&this.browser("msie")&&(b="<"+b+">"),this.document.execCommand(a,!1,b)},format_new_line:function(b){var c=this.get_parent_node();if(c.nodeName==="DIV"&&c.className==="spacedText"){var d=a(this.get_current_node());if(d.get(0).tagName==="DIV"&&(d.html()===""||d.html()==="<br>")){var e=a("<p>").append(d.clone().get(0).childNodes);d.replaceWith(e),e.html("<br>"),this.set_selection(e[0],0,e[0],0)}}},format_empty:function(b){var c=a.trim(this.$editor.html());c=c.replace(/<br\s?\/?>/i,"");var d=c.replace(/<p>\s?<\/p>/gi,"");if(c===""||d===""){b.preventDefault();var e=a(this.opts.emptyHtml).get(0);return this.$editor.html(e),this.set_selection(e,0,e,0),this.update(),!1}this.update()},to_p:function(b){b=a.trim(b);if(b===""||b==="<p></p>")return this.opts.emptyHtml;this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"));var c=function(a,b,c){return a.replace(new RegExp(b,"g"),c)},d=function(a,d){return c(b,a,d)},e="(table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|math|style|script|object|input|param|p|h[1-6])";return b+="\n",d("<br />\\s*<br />","\n\n"),d("(<"+e+"[^>]*>)","\n$1"),d("(</"+e+">)","$1\n\n"),d("\r\n|\r","\n"),d("\n\n+","\n\n"),d("\n?((.|\n)+?)$","<p>$1</p>\n"),d("<p>\\s*?</p>",""),d("<p>(<div[^>]*>\\s*)","$1<p>"),d("<p>([^<]+)\\s*?(</(div|address|form)[^>]*>)","<p>$1</p>$2"),d("<p>\\s*(</?"+e+"[^>]*>)\\s*</p>","$1"),d("<p>(<li.+?)</p>","$1"),d("<p>\\s*(</?"+e+"[^>]*>)","$1"),d("(</?"+e+"[^>]*>)\\s*</p>","$1"),d("(</?"+e+"[^>]*>)\\s*<br />","$1"),d("<br />(\\s*</?(p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","$1"),b.indexOf("<pre")!=-1&&d("(<pre(.|\n)*?>)((.|\n)*?)</pre>",function(a,b,d,e){return c(b,"\\\\(['\"\\\\])","$1")+c(c(c(e,"<p>","\n"),"</p>|<br />",""),"\\\\(['\"\\\\])","$1")+"</pre>"}),d("\n</p>$","</p>")},strip_tags:function(b){var c=this.opts.allowedTags,d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return b.replace(d,function(b,d){return a.inArray(d.toLowerCase(),c)>"-1"?b:""})},paste_strip_tags:function(b){var c=this.opts.allowedTagsPaste,d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return b.replace(d,function(b,d){return a.inArray(d.toLowerCase(),c)>"-1"?b:""})},paste_clean_up:function(b){b=b.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,""),b=b.replace(/(&nbsp;){2,}/gi,"&nbsp;"),b=b.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),b=this.paste_strip_tags(b),b=b.replace(/<td><\/td>/gi,"[td]"),b=b.replace(/<td>&nbsp;<\/td>/gi,"[td]"),b=b.replace(/<td><br><\/td>/gi,"[td]"),b=b.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),b=b.replace(/<img(.*?) src="(.*?)"(.*?)>/gi,'[img src="$2"]'),b=b.replace(/<(\w+)([\w\W]*?)>/gi,"<$1>"),b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),b=b.replace(/\[td\]/gi,"<td>&nbsp;</td>"),b=b.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),b=b.replace(/\[img(.*?)\]/gi,"<img$1>"),this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>")),b=b.replace(/<span>([\w\W]*?)<\/span>/gi,"$1"),b=b.replace(/\n{3,}/gi,"\n"),b=b.replace(/<p><p>/gi,"<p>"),b=b.replace(/<\/p><\/p>/gi,"</p>"),this.browser("mozilla")&&(b=b.replace(/<br>$/gi,"")),this.execCommand("inserthtml",b),a(this.document.body).scrollTop(this.saveScroll)},format_remove:function(b){var c=[],d=b.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return d!==null&&a.each(d,function(a,d){b=b.replace(d,"prebuffer_"+a),c.push(d)}),b=b.replace(/\s{2,}/g," "),b=b.replace(/\n/g," "),b=b.replace(/[\t]*/g,""),b=b.replace(/\n\s*\n/g,"\n"),b=b.replace(/^[\s\n]*/g,""),b=b.replace(/[\s\n]*$/g,""),b=b.replace(/>\s+</g,"><"),c&&(a.each(c,function(a,c){b=b.replace("prebuffer_"+a,c)}),c=[]),b},toggle:function(){var a;if(this.opts.visual){var b=this.$editor.innerHeight();this.$editor.hide(),a=this.$editor.html(),this.$html.height(b).val(a).show().focus(),this.set_btn_active("html"),this.opts.visual=!1}else this.$html.hide(),a=this.$html.val(),this.$editor.html(a).show(),this.$editor.html()===""&&this.set_code(this.opts.emptyHtml),this.$editor.focus(),this.set_btn_inactive("html"),this.opts.visual=!0,this.update()},get_html_fragment:function(a){var b=a.cloneNode(!0),c=this.document.createElement("div");return c.appendChild(b),c.innerHTML},extract_content:function(){var a=this.$editor.get(0),b=this.document.createDocumentFragment(),c;while(c=a.firstChild)b.appendChild(c);return b},save_selection:function(){this.$editor.focus(),this.savedSel=this.get_origin(),this.savedSelObj=this.get_focus()},restore_selection:function(){typeof this.savedSel!="undefined"&&this.savedSel!==null&&this.savedSelObj!==null&&this.savedSel[0].tagName!=="BODY"?a(this.savedSel[0]).closest(".spacedText").size()==0?this.$editor.focus():(this.browser("opera")&&this.$editor.focus(),this.set_selection(this.savedSel[0],this.savedSel[1],this.savedSelObj[0],this.savedSelObj[1]),this.browser("mozilla")&&this.$editor.focus()):this.$editor.focus()},get_selection:function(){var a=this.document;return this.window.getSelection?this.window.getSelection():a.getSelection?a.getSelection():a.selection.createRange()},has_selection:function(){if(!this.old_ie()){var a;return(a=this.get_selection())&&a.focusNode!=null&&a.anchorNode!=null}var b=this.$editor.get(0),c;return b.focus(),b.document.selection?(c=b.document.selection.createRange(),c&&c.parentElement().document===b.document):!1},get_origin:function(){if(!this.old_ie()){var a;return!(a=this.get_selection())||a.anchorNode==null?null:[a.anchorNode,a.anchorOffset]}var b=this.$editor.get(0),c;return b.focus(),this.has_selection()?(c=b.document.selection.createRange(),this._get_boundary(b.document,c,!0)):null},get_focus:function(){if(!this.old_ie()){var a;return!(a=this.get_selection())||a.focusNode==null?null:[a.focusNode,a.focusOffset]}var b=this.$editor.get(0),c;return b.focus(),this.has_selection()?(c=b.document.selection.createRange(),this._get_boundary(b.document,c,!1)):null},set_selection:function(a,b,c,d){c==null&&(c=a),d==null&&(d=b);if(!!this.old_ie()){var g=this.$editor.get(0),h=g.document.body.createTextRange();return this._move_boundary(g.document,h,!1,c,d),this._move_boundary(g.document,h,!0,a,b),h.select()}var e=this.get_selection();if(!e)return;if(e.collapse&&e.extend)e.collapse(a,b),e.extend(c,d);else{r=this.document.createRange(),r.setStart(a,b),r.setEnd(c,d);try{e.removeAllRanges()}catch(f){}e.addRange(r)}},get_current_node:function(){if(typeof this.window.getSelection!="undefined")return this.get_selected_node().parentNode;if(typeof this.document.selection!="undefined")return this.get_selection().parentElement()},get_parent_node:function(){return a(this.get_current_node()).parent()[0]},get_selected_node:function(){if(this.old_ie())return this.get_selection().parentElement();if(typeof this.window.getSelection!="undefined"){var a=this.window.getSelection();return a.rangeCount>0?this.get_selection().getRangeAt(0).commonAncestorContainer:!1}if(typeof this.document.selection!="undefined")return this.get_selection()},_get_boundary:function(a,b,c){var d,e,f,g,h;e=a.createElement("a"),d=b.duplicate(),d.collapse(c),h=d.parentElement();for(;;){h.insertBefore(e,e.previousSibling),d.moveToElementText(e);if(!(d.compareEndPoints(c?"StartToStart":"StartToEnd",b)>0&&e.previousSibling!=null))break}return d.compareEndPoints(c?"StartToStart":"StartToEnd",b)===-1&&e.nextSibling?(d.setEndPoint(c?"EndToStart":"EndToEnd",b),f=e.nextSibling,g=d.text.length):(f=e.parentNode,g=this._get_child_index(e)),e.parentNode.removeChild(e),[f,g]},_move_boundary:function(a,b,c,d,e){var f,g,h,i,j;return j=0,f=this._is_text(d)?d:d.childNodes[e],g=this._is_text(d)?d.parentNode:d,this._is_text(d)&&(j=e),i=a.createElement("a"),g.insertBefore(i,f||null),h=a.body.createTextRange(),h.moveToElementText(i),i.parentNode.removeChild(i),b.setEndPoint(c?"StartToStart":"EndToEnd",h),b[c?"moveStart":"moveEnd"]("character",j)},_is_text:function(a){return a!=null?a.nodeType==3:!1},_get_child_index:function(a){var b=0;while(a=a.previousSibling)b++;return b},insert_node_at_caret:function(a){if(this.window.getSelection){var b=this.get_selection();if(b.rangeCount){var c=b.getRangeAt(0);c.collapse(!1),c.insertNode(a),c=c.cloneRange(),c.selectNodeContents(a),c.collapse(!1),b.removeAllRanges(),b.addRange(c)}}else if(this.document.selection){var d=a.nodeType===1?a.outerHTML:a.data,e="marker_"+(""+Math.random()).slice(2);d+='<span id="'+e+'"></span>';var f=this.get_selection();f.collapse(!1),f.pasteHTML(d);var g=this.document.getElementById(e);f.moveToElementText(g),f.select(),g.parentNode.removeChild(g)}},show_size:function(a){return!1},show_size_value:function(b){this.execCommand("FontSize",2);if(this.$editor.find('font[size="2"]').length>0){if(this.wait_size_change){var c=this.wait_size_change_btn;this.wait_size_change=!1}else var c=a(b.currentTarget);var d=parseInt(c.attr("data-size"))+parseInt(this.$editor.css("font-size"))+"px";this.$editor.find('font[size="2"]').replaceWith(function(){var b=a(this);return b.find('[style*="font-size"]').each(function(b,c){var d=a(this),e=d.attr("style");e=e.replace(/font-size:\s{0,3}([0-9]*){1,3}(px|pt|%|em);{0,1}/gi,""),d.attr("style",e)}),a('<span style="font-size: '+d+';">'+b.html()+"</span>")}),this.update()}else this.wait_size_change=!0,this.wait_size_change_btn=a(b.currentTarget)},show_color_font:function(b){var c=a(b.currentTarget),d,e=a(this.get_current_node()).eq(0).css("color");a.fn.spacedColors({value:e,element:c,element_offset:{top:50,left:257},opacity:!1,show:!0,change:a.proxy(function(a){d?(d.css("color",a.value),this.update()):d=this.set_color("font",a.value)},this),on_done:a.proxy(function(){},this),on_cancel:a.proxy(function(){d?(d.css("color",e),this.update()):d=this.set_color("font",e)},this)})},show_color_back:function(b){var c=a(b.currentTarget),d,e=a(this.get_current_node()).eq(0).css("background-color");a.fn.spacedColors({value:e,element:c,element_offset:{top:50,left:257},opacity:!1,show:!0,change:a.proxy(function(a){d?(d.css("background-color",a.value),this.update()):d=this.set_color("back",a.value)},this),on_done:a.proxy(function(){},this),on_cancel:a.proxy(function(){d?(d.css("background-color",e),this.update()):d=this.set_color("back",e)},this)})},set_color:function(b,c){var d;b==="back"?this.browser("msie")?d="BackColor":d="hilitecolor":d="forecolor",this.execCommand(d,c);var e=!1;if(d==="forecolor")return this.$editor.find("font").replaceWith(function(){var b=a('<span style="color: '+a(this).attr("color")+';">'+a(this).html()+"</span>");return e=e?e.add(b):b,b}),this.update(),e;if(this.browser("msie")&&d==="BackColor")return this.$editor.find("font").replaceWith(function(){var b=a('<span style="color: '+a(this).attr("style")+';">'+a(this).html()+"</span>");return e=e?e.add(b):b,b}),this.update(),e},show_link_menu:function(b){var c=a(b.currentTarget),d=c.attr("target")=="blank"?'target="_blank"':"",e=a("<div></div>"),f=a('<a style="margin-left: 15px">Редактировать</a>'),g=a("<a>удалить</a>");e.append('<a href="'+c.attr("href")+'" '+d+' title="Перейти по ссылке" class="is_link">'+c.attr("href")+"</a>").append(f).append("&nbsp;или&nbsp;").append(g);var h=spaced.modal.create({name:"spacedText_link",light:!0,width:"auto",data:e});this.modal_link=h,f.on("click",a.proxy(function(){h.close(),this.show_link(undefined,!0)},this)),g.on("click",a.proxy(function(){var b=this.get_selection();b.anchorNode&&a(b.anchorNode.parentNode).get(0).tagName==="A"?a(b.anchorNode.parentNode).replaceWith(a(b.anchorNode.parentNode).text()):this.exec("unlink",!1),h.close(),this.change()},this)),b.stopImmediatePropagation()},show_link:function(b,c){this.save_selection(),this.insert_link_node=!1;var d=this.get_selection(),e="",f="",g="";if(this.browser("msie")){var h=this.get_parent_node();h.nodeName==="A"?(this.insert_link_node=a(h),f=this.insert_link_node.text(),e=this.insert_link_node.attr("href"),g=this.insert_link_node.attr("target")):this.old_ie()?f=d.text:f=d.toString()}else d&&d.anchorNode&&d.anchorNode.parentNode.tagName==="A"?(e=d.anchorNode.parentNode.href,f=d.anchorNode.parentNode.text,g=d.anchorNode.parentNode.target,d.toString()===""&&(this.insert_link_node=d.anchorNode.parentNode)):f=d.toString();c&&(e=spaced.regex.link.get_link(e));var i=spaced.modal.create({name:"spacedText_link_edit",light:!0,width:270,options:{url:{type:"text",title:"URL",focus:!0,value:e,autocomplete:{source:"/admin/edit/link_search",minLength:1}},text:{type:"text",title:"Текст",value:f},is_blank:{type:"checkbox",title:"Открывать в новой вкладке",value:g=="_blank"}},buttons:{create:{title:c?"Изменить":"Создать",style:"light",click:a.proxy(function(a){if(a.url&&a.url.length){var b=spaced.regex.link.get_link(a.url);a.text.length<1&&(a.text=b),this.insert_link({url:b,is_blank:a.is_blank,text:a.text}),i.close()}},this)},cancel:{title:"Отмена",style:"cancel",width:104,align:"right",click:a.proxy(function(){},this)}},cancel:a.proxy(function(){},this)});this.modal_link_edit=i},insert_link:function(b){var c="",d="";b.is_blank&&(c=' target="_blank"',d="_blank");var e='<a href="'+b.url+'"'+c+">"+b.text+"</a>";this.$editor.focus(),this.restore_selection(),b.text!==""&&(this.insert_link_node?(a(this.insert_link_node).text(b.text),a(this.insert_link_node).attr("href",b.url),d!==""?a(this.insert_link_node).attr("target",d):a(this.insert_link_node).removeAttr("target"),this.update()):this.execCommand("inserthtml",e))},browser:function(a){var b=navigator.userAgent.toLowerCase(),c=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||/(trident) ([\w.]+)/.exec(b)||b.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return a=="version"?c[2]:a=="webkit"?c[1]=="chrome"||c[1]=="webkit":c[1]==a},old_ie:function(){return this.browser("msie")&&parseInt(this.browser("version"),10)<9?!0:!1},is_mobile:function(){return/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent)?!0:/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)?!0:!1},is_old_safari:function(){var a=!1;if(this.browser("webkit")&&navigator.userAgent.indexOf("Chrome")===-1){var b=this.browser("version").split(".");b[0]<536&&(a=!0)}return a}},a.fn.spacedText=function(c){return this.each(function(){var d=a(this),e=d.data("spacedText");e||d.data("spacedText",e=new b(this,c))})},a.fn.spacedTextDestroy=function(){this.each(function(){typeof a(this).data("spacedText")!="undefined"&&(a(this).data("spacedText").destroy(),a(this).removeData("spacedText"))})},a.fn.spacedTextGetCode=function(){return a.trim(this.data("spacedText").get_code())},a.fn.spacedTextSetCode=function(a){this.data("spacedText").set_code(a)},a.fn.spacedTextSetFocus=function(){this.data("spacedText").$editor.focus()}}(jQuery),function(a){var b="http://",c=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,d=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,e=function(){var f=this.childNodes,g=f.length;while(g--){var h=f[g];if(h.nodeType===3){var i=h.nodeValue;i&&(i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(c,'$1<a href="'+b+'$2">$2</a>$3').replace(d,'$1<a href="$2">$2</a>$5'),a(h).after(i).remove())}else h.nodeType===1&&!/^(a|button|textarea)$/i.test(h.tagName)&&e.call(h)}};a.fn.linkfinder=function(){this.each(e)}}(jQuery),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/lib/spacedText/spacedText.css",!0),require.define("http://dev1.lpcandy.ru/view/editor/lib/datetimePicker/jquery.datetimepicker.css",!0),require.define("http://dev1.lpcandy.ru/view/editor/lib/datetimePicker/jquery.datetimepicker.js",function(path){var require=window.require.factory(path),module={exports:!1},exports={};return function(a){"use strict";var b={i18n:{ar:{months:["كانون الثاني","شباط","آذار","نيسان","مايو","حزيران","تموز","آب","أيلول","تشرين الأول","تشرين الثاني","كانون الأول"],dayOfWeek:["ن","ث","ع","خ","ج","س","ح"]},ro:{months:["ianuarie","februarie","martie","aprilie","mai","iunie","iulie","august","septembrie","octombrie","noiembrie","decembrie"],dayOfWeek:["l","ma","mi","j","v","s","d"]},id:{months:["Januari","Februari","Maret","April","Mei","Juni","Juli","Agustus","September","Oktober","November","Desember"],dayOfWeek:["Sen","Sel","Rab","Kam","Jum","Sab","Min"]},bg:{months:["Януари","Февруари","Март","Април","Май","Юни","Юли","Август","Септември","Октомври","Ноември","Декември"],dayOfWeek:["Нд","Пн","Вт","Ср","Чт","Пт","Сб"]},fa:{months:["فروردین","اردیبهشت","خرداد","تیر","مرداد","شهریور","مهر","آبان","آذر","دی","بهمن","اسفند"],dayOfWeek:["یکشنبه","دوشنبه","سه شنبه","چهارشنبه","پنجشنبه","جمعه","شنبه"]},ru:{months:["Январь","Февраль","Март","Апрель","Май","Июнь","Июль","Август","Сентябрь","Октябрь","Ноябрь","Декабрь"],dayOfWeek:["Вск","Пн","Вт","Ср","Чт","Пт","Сб"]},uk:{months:["Січень","Лютий","Березень","Квітень","Травень","Червень","Липень","Серпень","Вересень","Жовтень","Листопад","Грудень"],dayOfWeek:["Ндл","Пнд","Втр","Срд","Чтв","Птн","Сбт"]},en:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},el:{months:["Ιανουάριος","Φεβρουάριος","Μάρτιος","Απρίλιος","Μάιος","Ιούνιος","Ιούλιος","Αύγουστος","Σεπτέμβριος","Οκτώβριος","Νοέμβριος","Δεκέμβριος"],dayOfWeek:["Κυρ","Δευ","Τρι","Τετ","Πεμ","Παρ","Σαβ"]},de:{months:["Januar","Februar","März","April","Mai","Juni","Juli","August","September","Oktober","November","Dezember"],dayOfWeek:["So","Mo","Di","Mi","Do","Fr","Sa"]},nl:{months:["januari","februari","maart","april","mei","juni","juli","augustus","september","oktober","november","december"],dayOfWeek:["zo","ma","di","wo","do","vr","za"]},tr:{months:["Ocak","Şubat","Mart","Nisan","Mayıs","Haziran","Temmuz","Ağustos","Eylül","Ekim","Kasım","Aralık"],dayOfWeek:["Paz","Pts","Sal","Çar","Per","Cum","Cts"]},fr:{months:["Janvier","Février","Mars","Avril","Mai","Juin","Juillet","Août","Septembre","Octobre","Novembre","Décembre"],dayOfWeek:["Dim","Lun","Mar","Mer","Jeu","Ven","Sam"]},es:{months:["Enero","Febrero","Marzo","Abril","Mayo","Junio","Julio","Agosto","Septiembre","Octubre","Noviembre","Diciembre"],dayOfWeek:["Dom","Lun","Mar","Mié","Jue","Vie","Sáb"]},th:{months:["มกราคม","กุมภาพันธ์","มีนาคม","เมษายน","พฤษภาคม","มิถุนายน","กรกฎาคม","สิงหาคม","กันยายน","ตุลาคม","พฤศจิกายน","ธันวาคม"],dayOfWeek:["อา.","จ.","อ.","พ.","พฤ.","ศ.","ส."]},pl:{months:["styczeń","luty","marzec","kwiecień","maj","czerwiec","lipiec","sierpień","wrzesień","październik","listopad","grudzień"],dayOfWeek:["nd","pn","wt","śr","cz","pt","sb"]},pt:{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sab"]},ch:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},se:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},kr:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},it:{months:["Gennaio","Febbraio","Marzo","Aprile","Maggio","Giugno","Luglio","Agosto","Settembre","Ottobre","Novembre","Dicembre"],dayOfWeek:["Dom","Lun","Mar","Mer","Gio","Ven","Sab"]},da:{months:["January","Februar","Marts","April","Maj","Juni","July","August","September","Oktober","November","December"],dayOfWeek:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},no:{months:["Januar","Februar","Mars","April","Mai","Juni","Juli","August","September","Oktober","November","Desember"],dayOfWeek:["Søn","Man","Tir","Ons","Tor","Fre","Lør"]},ja:{months:["1月","2月","3月","4月","5月","6月","7月","8月","9月","10月","11月","12月"],dayOfWeek:["日","月","火","水","木","金","土"]},vi:{months:["Tháng 1","Tháng 2","Tháng 3","Tháng 4","Tháng 5","Tháng 6","Tháng 7","Tháng 8","Tháng 9","Tháng 10","Tháng 11","Tháng 12"],dayOfWeek:["CN","T2","T3","T4","T5","T6","T7"]},sl:{months:["Januar","Februar","Marec","April","Maj","Junij","Julij","Avgust","September","Oktober","November","December"],dayOfWeek:["Ned","Pon","Tor","Sre","Čet","Pet","Sob"]},cs:{months:["Leden","Únor","Březen","Duben","Květen","Červen","Červenec","Srpen","Září","Říjen","Listopad","Prosinec"],dayOfWeek:["Ne","Po","Út","St","Čt","Pá","So"]},hu:{months:["Január","Február","Március","Április","Május","Június","Július","Augusztus","Szeptember","Október","November","December"],dayOfWeek:["Va","Hé","Ke","Sze","Cs","Pé","Szo"]},az:{months:["Yanvar","Fevral","Mart","Aprel","May","Iyun","Iyul","Avqust","Sentyabr","Oktyabr","Noyabr","Dekabr"],dayOfWeek:["B","Be","Ça","Ç","Ca","C","Ş"]},bs:{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeek:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"]},ca:{months:["Gener","Febrer","Març","Abril","Maig","Juny","Juliol","Agost","Setembre","Octubre","Novembre","Desembre"],dayOfWeek:["Dg","Dl","Dt","Dc","Dj","Dv","Ds"]},"en-GB":{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},et:{months:["Jaanuar","Veebruar","Märts","Aprill","Mai","Juuni","Juuli","August","September","Oktoober","November","Detsember"],dayOfWeek:["P","E","T","K","N","R","L"]},eu:{months:["Urtarrila","Otsaila","Martxoa","Apirila","Maiatza","Ekaina","Uztaila","Abuztua","Iraila","Urria","Azaroa","Abendua"],dayOfWeek:["Ig.","Al.","Ar.","Az.","Og.","Or.","La."]},fi:{months:["Tammikuu","Helmikuu","Maaliskuu","Huhtikuu","Toukokuu","Kesäkuu","Heinäkuu","Elokuu","Syyskuu","Lokakuu","Marraskuu","Joulukuu"],dayOfWeek:["Su","Ma","Ti","Ke","To","Pe","La"]},gl:{months:["Xan","Feb","Maz","Abr","Mai","Xun","Xul","Ago","Set","Out","Nov","Dec"],dayOfWeek:["Dom","Lun","Mar","Mer","Xov","Ven","Sab"]},hr:{months:["Siječanj","Veljača","Ožujak","Travanj","Svibanj","Lipanj","Srpanj","Kolovoz","Rujan","Listopad","Studeni","Prosinac"],dayOfWeek:["Ned","Pon","Uto","Sri","Čet","Pet","Sub"]},ko:{months:["1월","2월","3월","4월","5월","6월","7월","8월","9월","10월","11월","12월"],dayOfWeek:["일","월","화","수","목","금","토"]},lt:{months:["Sausio","Vasario","Kovo","Balandžio","Gegužės","Birželio","Liepos","Rugpjūčio","Rugsėjo","Spalio","Lapkričio","Gruodžio"],dayOfWeek:["Sek","Pir","Ant","Tre","Ket","Pen","Šeš"]},lv:{months:["Janvāris","Februāris","Marts","Aprīlis ","Maijs","Jūnijs","Jūlijs","Augusts","Septembris","Oktobris","Novembris","Decembris"],dayOfWeek:["Sv","Pr","Ot","Tr","Ct","Pk","St"]},mk:{months:["јануари","февруари","март","април","мај","јуни","јули","август","септември","октомври","ноември","декември"],dayOfWeek:["нед","пон","вто","сре","чет","пет","саб"]},mn:{months:["1-р сар","2-р сар","3-р сар","4-р сар","5-р сар","6-р сар","7-р сар","8-р сар","9-р сар","10-р сар","11-р сар","12-р сар"],dayOfWeek:["Дав","Мяг","Лха","Пүр","Бсн","Бям","Ням"]},"pt-BR":{months:["Janeiro","Fevereiro","Março","Abril","Maio","Junho","Julho","Agosto","Setembro","Outubro","Novembro","Dezembro"],dayOfWeek:["Dom","Seg","Ter","Qua","Qui","Sex","Sáb"]},sk:{months:["Január","Február","Marec","Apríl","Máj","Jún","Júl","August","September","Október","November","December"],dayOfWeek:["Ne","Po","Ut","St","Št","Pi","So"]},sq:{months:["January","February","March","April","May","June","July","August","September","October","November","December"],dayOfWeek:["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]},"sr-YU":{months:["Januar","Februar","Mart","April","Maj","Jun","Jul","Avgust","Septembar","Oktobar","Novembar","Decembar"],dayOfWeek:["Ned","Pon","Uto","Sre","čet","Pet","Sub"]},sr:{months:["јануар","фебруар","март","април","мај","јун","јул","август","септембар","октобар","новембар","децембар"],dayOfWeek:["нед","пон","уто","сре","чет","пет","суб"]},sv:{months:["Januari","Februari","Mars","April","Maj","Juni","Juli","Augusti","September","Oktober","November","December"],dayOfWeek:["Sön","Mån","Tis","Ons","Tor","Fre","Lör"]},"zh-TW":{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},zh:{months:["一月","二月","三月","四月","五月","六月","七月","八月","九月","十月","十一月","十二月"],dayOfWeek:["日","一","二","三","四","五","六"]},he:{months:["ינואר","פברואר","מרץ","אפריל","מאי","יוני","יולי","אוגוסט","ספטמבר","אוקטובר","נובמבר","דצמבר"],dayOfWeek:["א'","ב'","ג'","ד'","ה'","ו'","שבת"]}},value:"",lang:"en",format:"Y/m/d H:i",formatTime:"H:i",formatDate:"Y/m/d",startDate:!1,step:60,monthChangeSpinner:!0,closeOnDateSelect:!1,closeOnWithoutClick:!0,closeOnInputClick:!0,timepicker:!0,datepicker:!0,weeks:!1,defaultTime:!1,defaultDate:!1,minDate:!1,maxDate:!1,minTime:!1,maxTime:!1,allowTimes:[],opened:!1,initTime:!0,inline:!1,theme:"",onSelectDate:function(){},onSelectTime:function(){},onChangeMonth:function(){},onChangeYear:function(){},onChangeDateTime:function(){},onShow:function(){},onClose:function(){},onGenerate:function(){},withoutCopyright:!0,inverseButton:!1,hours12:!1,next:"xdsoft_next",prev:"xdsoft_prev",dayOfWeekStart:0,parentID:"body",timeHeightInTimePicker:25,timepickerScrollbar:!0,todayButton:!0,defaultSelect:!0,scrollMonth:!0,scrollTime:!0,scrollInput:!0,lazyInit:!1,mask:!1,validateOnBlur:!0,allowBlank:!0,yearStart:1950,yearEnd:2050,style:"",id:"",fixed:!1,roundTime:"round",className:"",weekends:[],disabledDates:[],yearOffset:0,beforeShowDay:null,enterLikeTab:!0};Array.prototype.indexOf||(Array.prototype.indexOf=function(a,b){var c,d;for(c=b||0,d=this.length;c<d;c+=1)if(this[c]===a)return c;return-1}),Date.prototype.countDaysInMonth=function(){return(new Date(this.getFullYear(),this.getMonth()+1,0)).getDate()},a.fn.xdsoftScroller=function(b){return this.each(function(){var c=a(this),d=function(a){var b={x:0,y:0},c;if(a.type==="touchstart"||a.type==="touchmove"||a.type==="touchend"||a.type==="touchcancel")c=a.originalEvent.touches[0]||a.originalEvent.changedTouches[0],b.x=c.clientX,b.y=c.clientY;else if(a.type==="mousedown"||a.type==="mouseup"||a.type==="mousemove"||a.type==="mouseover"||a.type==="mouseout"||a.type==="mouseenter"||a.type==="mouseleave")b.x=a.clientX,b.y=a.clientY;return b},e=0,f,g,h,i,j,k=100,l=!1,m=0,n=0,o=0,p=!1,q=0,r=function(){};if(b==="hide"){c.find(".xdsoft_scrollbar").hide();return}a(this).hasClass("xdsoft_scroller_box")||(f=c.children().eq(0),g=c[0].clientHeight,h=f[0].offsetHeight,i=a('<div class="xdsoft_scrollbar"></div>'),j=a('<div class="xdsoft_scroller"></div>'),i.append(j),c.addClass("xdsoft_scroller_box").append(i),r=function(b){var e=d(b).y-m+q;e<0&&(e=0),e+j[0].offsetHeight>o&&(e=o-j[0].offsetHeight),c.trigger("scroll_element.xdsoft_scroller",[k?e/k:0])},j.on("touchstart.xdsoft_scroller mousedown.xdsoft_scroller",function(e){g||c.trigger("resize_scroll.xdsoft_scroller",[b]),m=d(e).y,q=parseInt(j.css("margin-top"),10),o=i[0].offsetHeight,e.type==="mousedown"?(document&&a(document.body).addClass("xdsoft_noselect"),a([document.body,window]).on("mouseup.xdsoft_scroller",function f(){a([document.body,window]).off("mouseup.xdsoft_scroller",f).off("mousemove.xdsoft_scroller",r).removeClass("xdsoft_noselect")}),a(document.body).on("mousemove.xdsoft_scroller",r)):(p=!0,e.stopPropagation(),e.preventDefault())}).on("touchmove",function(a){p&&(a.preventDefault(),r(a))}).on("touchend touchcancel",function(a){p=!1,q=0}),c.on("scroll_element.xdsoft_scroller",function(a,b){g||c.trigger("resize_scroll.xdsoft_scroller",[b,!0]),b=b>1?1:b<0||isNaN(b)?0:b,j.css("margin-top",k*b),setTimeout(function(){f.css("marginTop",-parseInt((f[0].offsetHeight-g)*b,10))},10)}).on("resize_scroll.xdsoft_scroller",function(a,b,d){var e,l;g=c[0].clientHeight,h=f[0].offsetHeight,e=g/h,l=e*i[0].offsetHeight,e>1?j.hide():(j.show(),j.css("height",parseInt(l>10?l:10,10)),k=i[0].offsetHeight-j[0].offsetHeight,d!==!0&&c.trigger("scroll_element.xdsoft_scroller",[b||Math.abs(parseInt(f.css("marginTop"),10))/(h-g)]))}),c.on("mousewheel",function(a){var b=Math.abs(parseInt(f.css("marginTop"),10));return b-=a.deltaY*20,b<0&&(b=0),c.trigger("scroll_element.xdsoft_scroller",[b/(h-g)]),a.stopPropagation(),!1}),c.on("touchstart",function(a){l=d(a),n=Math.abs(parseInt(f.css("marginTop"),10))}),c.on("touchmove",function(a){if(l){a.preventDefault();var b=d(a);c.trigger("scroll_element.xdsoft_scroller",[(n-(b.y-l.y))/(h-g)])}}),c.on("touchend touchcancel",function(a){l=!1,n=0})),c.trigger("resize_scroll.xdsoft_scroller",[b])})},a.fn.datetimepicker=function(c){var d=48,e=57,f=96,g=105,h=17,i=46,j=13,k=27,l=8,m=37,n=38,o=39,p=40,q=9,r=116,s=65,t=67,u=86,v=90,w=89,x=!1,y=a.isPlainObject(c)||!c?a.extend(!0,{},b,c):a.extend(!0,{},b),z=0,A,B,C,D=function(a){a.on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function b(c){if(a.is(":disabled")||a.is(":hidden")||!a.is(":visible")||a.data("xdsoft_datetimepicker"))return;clearTimeout(z),z=setTimeout(function(){a.data("xdsoft_datetimepicker")||A(a),a.off("open.xdsoft focusin.xdsoft mousedown.xdsoft",b).trigger("open.xdsoft")},100)})};return A=function(b){function S(){var a=!1,c;return y.startDate?a=C.strToDate(y.startDate):(a=y.value||(b&&b.val&&b.val()?b.val():""),a?a=C.strToDateTime(a):y.defaultDate&&(a=C.strToDate(y.defaultDate),y.defaultTime&&(c=C.strtotime(y.defaultTime),a.setHours(c.getHours()),a.setMinutes(c.getMinutes())))),a&&C.isValidDate(a)?z.data("changed",!0):a="",a||0}var z=a("<div "+(y.id?'id="'+y.id+'"':"")+" "+(y.style?'style="'+y.style+'"':"")+' class="xdsoft_datetimepicker xdsoft_'+y.theme+" xdsoft_noselect "+(y.weeks?" xdsoft_showweeks":"")+y.className+'"></div>'),A=a('<div class="xdsoft_copyright"><a target="_blank" href="http://xdsoft.net/jqplugins/datetimepicker/">xdsoft.net</a></div>'),B=a('<div class="xdsoft_datepicker active"></div>'),D=a('<div class="xdsoft_mounthpicker"><button type="button" class="xdsoft_prev"></button><button type="button" class="xdsoft_today_button"></button><div class="xdsoft_label xdsoft_month"><span></span><i></i></div><div class="xdsoft_label xdsoft_year"><span></span><i></i></div><button type="button" class="xdsoft_next"></button></div>'),E=a('<div class="xdsoft_calendar"></div>'),F=a('<div class="xdsoft_timepicker active"><button type="button" class="xdsoft_prev"></button><div class="xdsoft_time_box"></div><button type="button" class="xdsoft_next"></button></div>'),G=F.find(".xdsoft_time_box").eq(0),H=a('<div class="xdsoft_time_variant"></div>'),I=a('<div class="xdsoft_select xdsoft_monthselect"><div></div></div>'),J=a('<div class="xdsoft_select xdsoft_yearselect"><div></div></div>'),K=!1,L,M,N,O,P,Q=0,R=0;D.find(".xdsoft_month span").after(I),D.find(".xdsoft_year span").after(J),D.find(".xdsoft_month,.xdsoft_year").on("mousedown.xdsoft",function(b){var c=a(this).find(".xdsoft_select").eq(0),d=0,e=0,f=c.is(":visible"),g,h;D.find(".xdsoft_select").hide(),C.currentTime&&(d=C.currentTime[a(this).hasClass("xdsoft_month")?"getMonth":"getFullYear"]()),c[f?"hide":"show"]();for(g=c.find("div.xdsoft_option"),h=0;h<g.length;h+=1){if(g.eq(h).data("value")===d)break;e+=g[0].offsetHeight}return c.xdsoftScroller(e/(c.children()[0].offsetHeight-c[0].clientHeight)),b.stopPropagation(),!1}),D.find(".xdsoft_select").xdsoftScroller().on("mousedown.xdsoft",function(a){a.stopPropagation(),a.preventDefault()}).on("mousedown.xdsoft",".xdsoft_option",function(b){var c=C.currentTime.getFullYear();C&&C.currentTime&&C.currentTime[a(this).parent().parent().hasClass("xdsoft_monthselect")?"setMonth":"setFullYear"](a(this).data("value")),a(this).parent().parent().hide(),z.trigger("xchange.xdsoft"),y.onChangeMonth&&a.isFunction(y.onChangeMonth)&&y.onChangeMonth.call(z,C.currentTime,z.data("input")),c!==C.currentTime.getFullYear()&&a.isFunction(y.onChangeYear)&&y.onChangeYear.call(z,C.currentTime,z.data("input"))}),z.setOptions=function(c){y=a.extend(!0,{},y,c),c.allowTimes&&a.isArray(c.allowTimes)&&c.allowTimes.length&&(y.allowTimes=a.extend(!0,[],c.allowTimes)),c.weekends&&a.isArray(c.weekends)&&c.weekends.length&&(y.weekends=a.extend(!0,[],c.weekends)),c.disabledDates&&a.isArray(c.disabledDates)&&c.disabledDates.length&&(y.disabledDates=a.extend(!0,[],c.disabledDates)),(y.open||y.opened)&&!y.inline&&b.trigger("open.xdsoft"),y.inline&&(K=!0,z.addClass("xdsoft_inline"),b.after(z).hide()),y.inverseButton&&(y.next="xdsoft_prev",y.prev="xdsoft_next"),y.datepicker?B.addClass("active"):B.removeClass("active"),y.timepicker?F.addClass("active"):F.removeClass("active"),y.value&&(b&&b.val&&b.val(y.value),C.setCurrentTime(y.value)),isNaN(y.dayOfWeekStart)?y.dayOfWeekStart=0:y.dayOfWeekStart=parseInt(y.dayOfWeekStart,10)%7,y.timepickerScrollbar||G.xdsoftScroller("hide"),y.minDate&&/^-(.*)$/.test(y.minDate)&&(y.minDate=C.strToDateTime(y.minDate).dateFormat(y.formatDate)),y.maxDate&&/^\+(.*)$/.test(y.maxDate)&&(y.maxDate=C.strToDateTime(y.maxDate).dateFormat(y.formatDate)),D.find(".xdsoft_today_button").css("visibility",y.todayButton?"visible":"hidden");if(y.mask){var A,E=function(a){try{if(document.selection&&document.selection.createRange){var b=document.selection.createRange();return b.getBookmark().charCodeAt(2)-2}if(a.setSelectionRange)return a.selectionStart}catch(c){return 0}},H=function(a,b){a=typeof a=="string"||a instanceof String?document.getElementById(a):a;if(!a)return!1;if(a.createTextRange){var c=a.createTextRange();return c.collapse(!0),c.moveEnd("character",b),c.moveStart("character",b),c.select(),!0}return a.setSelectionRange?(a.setSelectionRange(b,b),!0):!1},I=function(a,b){var c=a.replace(/([\[\]\/\{\}\(\)\-\.\+]{1})/g,"\\$1").replace(/_/g,"{digit+}").replace(/([0-9]{1})/g,"{digit$1}").replace(/\{digit([0-9]{1})\}/g,"[0-$1_]{1}").replace(/\{digit[\+]\}/g,"[0-9_]{1}");return(new RegExp(c)).test(b)};b.off("keydown.xdsoft"),y.mask===!0&&(y.mask=y.format.replace(/Y/g,"9999").replace(/F/g,"9999").replace(/m/g,"19").replace(/d/g,"39").replace(/H/g,"29").replace(/i/g,"59").replace(/s/g,"59")),a.type(y.mask)==="string"&&(I(y.mask,b.val())||b.val(y.mask.replace(/[0-9]/g,"_")),b.on("keydown.xdsoft",function(c){var z=this.value,A=c.which,B,C;if(A>=d&&A<=e||A>=f&&A<=g||A===l||A===i){B=E(this),C=A!==l&&A!==i?String.fromCharCode(f<=A&&A<=g?A-d:A):"_",(A===l||A===i)&&B&&(B-=1,C="_");while(/[^0-9_]/.test(y.mask.substr(B,1))&&B<y.mask.length&&B>0)B+=A===l||A===i?-1:1;z=z.substr(0,B)+C+z.substr(B+1);if(a.trim(z)==="")z=y.mask.replace(/[0-9]/g,"_");else if(B===y.mask.length)return c.preventDefault(),!1;B+=A===l||A===i?0:1;while(/[^0-9_]/.test(y.mask.substr(B,1))&&B<y.mask.length&&B>0)B+=A===l||A===i?-1:1;I(y.mask,z)?(this.value=z,H(this,B)):a.trim(z)===""?this.value=y.mask.replace(/[0-9]/g,"_"):b.trigger("error_input.xdsoft")}else if([s,t,u,v,w].indexOf(A)!==-1&&x||[k,n,p,m,o,r,h,q,j].indexOf(A)!==-1)return!0;return c.preventDefault(),!1}))}y.validateOnBlur&&b.off("blur.xdsoft").on("blur.xdsoft",function(){y.allowBlank&&!a.trim(a(this).val()).length?(a(this).val(null),z.data("xdsoft_datetime").empty()):Date.parseDate(a(this).val(),y.format)?z.data("xdsoft_datetime").setCurrentTime(a(this).val()):(a(this).val(C.now().dateFormat(y.format)),z.data("xdsoft_datetime").setCurrentTime(a(this).val())),z.trigger("changedatetime.xdsoft")}),y.dayOfWeekStartPrev=y.dayOfWeekStart===0?6:y.dayOfWeekStart-1,z.trigger("xchange.xdsoft").trigger("afterOpen.xdsoft")},z.data("options",y).on("mousedown.xdsoft",function(a){return a.stopPropagation(),a.preventDefault(),J.hide(),I.hide(),!1}),G.append(H),G.xdsoftScroller(),z.on("afterOpen.xdsoft",function(){G.xdsoftScroller()}),z.append(B).append(F),y.withoutCopyright!==!0&&z.append(A),B.append(D).append(E),a(y.parentID).append(z),L=function(){var b=this;b.now=function(a){var c=new Date,d,e;return!a&&y.defaultDate&&(d=b.strToDate(y.defaultDate),c.setFullYear(d.getFullYear()),c.setMonth(d.getMonth()),c.setDate(d.getDate())),y.yearOffset&&c.setFullYear(c.getFullYear()+y.yearOffset),!a&&y.defaultTime&&(e=b.strtotime(y.defaultTime),c.setHours(e.getHours()),c.setMinutes(e.getMinutes())),c},b.isValidDate=function(a){return Object.prototype.toString.call(a)!=="[object Date]"?!1:!isNaN(a.getTime())},b.setCurrentTime=function(a){b.currentTime=typeof a=="string"?b.strToDateTime(a):b.isValidDate(a)?a:b.now(),z.trigger("xchange.xdsoft")},b.empty=function(){b.currentTime=null},b.getCurrentTime=function(a){return b.currentTime},b.nextMonth=function(){var c=b.currentTime.getMonth()+1,d;return c===12&&(b.currentTime.setFullYear(b.currentTime.getFullYear()+1),c=0),d=b.currentTime.getFullYear(),b.currentTime.setDate(Math.min((new Date(b.currentTime.getFullYear(),c+1,0)).getDate(),b.currentTime.getDate())),b.currentTime.setMonth(c),y.onChangeMonth&&a.isFunction(y.onChangeMonth)&&y.onChangeMonth.call(z,C.currentTime,z.data("input")),d!==b.currentTime.getFullYear()&&a.isFunction(y.onChangeYear)&&y.onChangeYear.call(z,C.currentTime,z.data("input")),z.trigger("xchange.xdsoft"),c},b.prevMonth=function(){var c=b.currentTime.getMonth()-1;return c===-1&&(b.currentTime.setFullYear(b.currentTime.getFullYear()-1),c=11),b.currentTime.setDate(Math.min((new Date(b.currentTime.getFullYear(),c+1,0)).getDate(),b.currentTime.getDate())),b.currentTime.setMonth(c),y.onChangeMonth&&a.isFunction(y.onChangeMonth)&&y.onChangeMonth.call(z,C.currentTime,z.data("input")),z.trigger("xchange.xdsoft"),c},b.getWeekOfYear=function(a){var b=new Date(a.getFullYear(),0,1);return Math.ceil(((a-b)/864e5+b.getDay()+1)/7)},b.strToDateTime=function(a){var c=[],d,e;return a&&a instanceof Date&&b.isValidDate(a)?a:(c=/^(\+|\-)(.*)$/.exec(a),c&&(c[2]=Date.parseDate(c[2],y.formatDate)),c&&c[2]?(d=c[2].getTime()-c[2].getTimezoneOffset()*6e4,e=new Date(C.now().getTime()+parseInt(c[1]+"1",10)*d)):e=a?Date.parseDate(a,y.format):b.now(),b.isValidDate(e)||(e=b.now()),e)},b.strToDate=function(a){if(a&&a instanceof Date&&b.isValidDate(a))return a;var c=a?Date.parseDate(a,y.formatDate):b.now(!0);return b.isValidDate(c)||(c=b.now(!0)),c},b.strtotime=function(a){if(a&&a instanceof Date&&b.isValidDate(a))return a;var c=a?Date.parseDate(a,y.formatTime):b.now(!0);return b.isValidDate(c)||(c=b.now(!0)),c},b.str=function(){return b.currentTime.dateFormat(y.format)},b.currentTime=this.now()},C=new L,D.find(".xdsoft_today_button").on("mousedown.xdsoft",function(){z.data("changed",!0),C.setCurrentTime(0),z.trigger("afterOpen.xdsoft")}).on("dblclick.xdsoft",function(){b.val(C.str()),z.trigger("close.xdsoft")}),D.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var b=a(this),c=0,d=!1;(function e(a){var f=C.currentTime.getMonth();b.hasClass(y.next)?C.nextMonth():b.hasClass(y.prev)&&C.prevMonth(),y.monthChangeSpinner&&(d||(c=setTimeout(e,a||100)))})(500),a([document.body,window]).on("mouseup.xdsoft",function f(){clearTimeout(c),d=!0,a([document.body,window]).off("mouseup.xdsoft",f)})}),F.find(".xdsoft_prev,.xdsoft_next").on("mousedown.xdsoft",function(){var b=a(this),c=0,d=!1,e=110;(function f(a){var g=G[0].clientHeight,h=H[0].offsetHeight,i=Math.abs(parseInt(H.css("marginTop"),10));b.hasClass(y.next)&&h-g-y.timeHeightInTimePicker>=i?H.css("marginTop","-"+(i+y.timeHeightInTimePicker)+"px"):b.hasClass(y.prev)&&i-y.timeHeightInTimePicker>=0&&H.css("marginTop","-"+(i-y.timeHeightInTimePicker)+"px"),G.trigger("scroll_element.xdsoft_scroller",[Math.abs(parseInt(H.css("marginTop"),10)/(h-g))]),e=e>10?10:e-10,d||(c=setTimeout(f,a||e))})(500),a([document.body,window]).on("mouseup.xdsoft",function g(){clearTimeout(c),d=!0,a([document.body,window]).off("mouseup.xdsoft",g)})}),M=0,z.on("xchange.xdsoft",function(b){clearTimeout(M),M=setTimeout(function(){var b="",d=new Date(C.currentTime.getFullYear(),C.currentTime.getMonth(),1,12,0,0),e=0,f,g=C.now(),h=!1,i=!1,j,k,l,m,n=[],o,p=!0,q="",r="",s;while(d.getDay()!==y.dayOfWeekStart)d.setDate(d.getDate()-1);b+="<table><thead><tr>",y.weeks&&(b+="<th></th>");for(f=0;f<7;f+=1)b+="<th>"+y.i18n[y.lang].dayOfWeek[(f+y.dayOfWeekStart)%7]+"</th>";b+="</tr></thead>",b+="<tbody>",y.maxDate!==!1&&(h=C.strToDate(y.maxDate),h=new Date(h.getFullYear(),h.getMonth(),h.getDate(),23,59,59,999)),y.minDate!==!1&&(i=C.strToDate(y.minDate),i=new Date(i.getFullYear(),i.getMonth(),i.getDate()));while(e<C.currentTime.countDaysInMonth()||d.getDay()!==y.dayOfWeekStart||C.currentTime.getMonth()===d.getMonth())n=[],e+=1,j=d.getDate(),k=d.getFullYear(),l=d.getMonth(),m=C.getWeekOfYear(d),n.push("xdsoft_date"),y.beforeShowDay&&a.isFunction(y.beforeShowDay.call)?o=y.beforeShowDay.call(z,d):o=null,h!==!1&&d>h||i!==!1&&d<i||o&&o[0]===!1?n.push("xdsoft_disabled"):y.disabledDates.indexOf(d.dateFormat(y.formatDate))!==-1&&n.push("xdsoft_disabled"),o&&o[1]!==""&&n.push(o[1]),C.currentTime.getMonth()!==l&&n.push("xdsoft_other_month"),(y.defaultSelect||z.data("changed"))&&C.currentTime.dateFormat(y.formatDate)===d.dateFormat(y.formatDate)&&n.push("xdsoft_current"),g.dateFormat(y.formatDate)===d.dateFormat(y.formatDate)&&n.push("xdsoft_today"),(d.getDay()===0||d.getDay()===6||y.weekends.indexOf(d.dateFormat(y.formatDate))===-1)&&n.push("xdsoft_weekend"),y.beforeShowDay&&a.isFunction(y.beforeShowDay)&&n.push(y.beforeShowDay(d)),p&&(b+="<tr>",p=!1,y.weeks&&(b+="<th>"+m+"</th>")),b+='<td data-date="'+j+'" data-month="'+l+'" data-year="'+k+'"'+' class="xdsoft_date xdsoft_day_of_week'+d.getDay()+" "+n.join(" ")+'">'+"<div>"+j+"</div>"+"</td>",d.getDay()===y.dayOfWeekStartPrev&&(b+="</tr>",p=!0),d.setDate(j+1);b+="</tbody></table>",E.html(b),D.find(".xdsoft_label span").eq(0).text(y.i18n[y.lang].months[C.currentTime.getMonth()]),D.find(".xdsoft_label span").eq(1).text(C.currentTime.getFullYear()),q="",r="",l="",s=function(b,c){var d=C.now();d.setHours(b),b=parseInt(d.getHours(),10),d.setMinutes(c),c=parseInt(d.getMinutes(),10),n=[],(y.maxTime!==!1&&C.strtotime(y.maxTime).getTime()<d.getTime()||y.minTime!==!1&&C.strtotime(y.minTime).getTime()>d.getTime())&&n.push("xdsoft_disabled"),(y.initTime||y.defaultSelect||z.data("changed"))&&parseInt(C.currentTime.getHours(),10)===parseInt(b,10)&&(y.step>59||Math[y.roundTime](C.currentTime.getMinutes()/y.step)*y.step===parseInt(c,10))&&(y.defaultSelect||z.data("changed")?n.push("xdsoft_current"):y.initTime&&n.push("xdsoft_init_time")),parseInt(g.getHours(),10)===parseInt(b,10)&&parseInt(g.getMinutes(),10)===parseInt(c,10)&&n.push("xdsoft_today"),q+='<div class="xdsoft_time '+n.join(" ")+'" data-hour="'+b+'" data-minute="'+c+'">'+d.dateFormat(y.formatTime)+"</div>"};if(!y.allowTimes||!a.isArray(y.allowTimes)||!y.allowTimes.length)for(e=0,f=0;e<(y.hours12?12:24);e+=1)for(f=0;f<60;f+=y.step)r=(e<10?"0":"")+e,l=(f<10?"0":"")+f,s(r,l);else for(e=0;e<y.allowTimes.length;e+=1)r=C.strtotime(y.allowTimes[e]).getHours(),l=C.strtotime(y.allowTimes[e]).getMinutes(),s(r,l);H.html(q),c="",e=0;for(e=parseInt(y.yearStart,10)+y.yearOffset;e<=parseInt(y.yearEnd,10)+y.yearOffset;e+=1)c+='<div class="xdsoft_option '+(C.currentTime.getFullYear()===e?"xdsoft_current":"")+'" data-value="'+e+'">'+e+"</div>";J.children().eq(0).html(c);for(e=0,c="";e<=11;e+=1)c+='<div class="xdsoft_option '+(C.currentTime.getMonth()===e?"xdsoft_current":"")+'" data-value="'+e+'">'+y.i18n[y.lang].months[e]+"</div>";I.children().eq(0).html(c),a(z).trigger("generate.xdsoft")},10),b.stopPropagation()}).on("afterOpen.xdsoft",function(){if(y.timepicker){var a,b,c,d;H.find(".xdsoft_current").length?a=".xdsoft_current":H.find(".xdsoft_init_time").length&&(a=".xdsoft_init_time"),a?(b=G[0].clientHeight,c=H[0].offsetHeight,d=H.find(a).index()*y.timeHeightInTimePicker+1,c-b<d&&(d=c-b),G.trigger("scroll_element.xdsoft_scroller",[parseInt(d,10)/(c-b)])):G.trigger("scroll_element.xdsoft_scroller",[0])}}),N=0,E.on("click.xdsoft","td",function(c){c.stopPropagation(),N+=1;var d=a(this),e=C.currentTime;if(e===undefined||e===null)C.currentTime=C.now(),e=C.currentTime;if(d.hasClass("xdsoft_disabled"))return!1;e.setDate(1),e.setFullYear(d.data("year")),e.setMonth(d.data("month")),e.setDate(d.data("date")),z.trigger("select.xdsoft",[e]),b.val(C.str()),(N>1||y.closeOnDateSelect===!0||y.closeOnDateSelect===0&&!y.timepicker)&&!y.inline&&z.trigger("close.xdsoft"),y.onSelectDate&&a.isFunction(y.onSelectDate)&&y.onSelectDate.call(z,C.currentTime,z.data("input"),c),z.data("changed",!0),z.trigger("xchange.xdsoft"),z.trigger("changedatetime.xdsoft"),setTimeout(function(){N=0},200)}),H.on("click.xdsoft","div",function(b){b.stopPropagation();var c=a(this),d=C.currentTime;if(d===undefined||d===null)C.currentTime=C.now(),d=C.currentTime;if(c.hasClass("xdsoft_disabled"))return!1;d.setHours(c.data("hour")),d.setMinutes(c.data("minute")),z.trigger("select.xdsoft",[d]),z.data("input").val(C.str()),y.inline||z.trigger("close.xdsoft"),y.onSelectTime&&a.isFunction(y.onSelectTime)&&y.onSelectTime.call(z,C.currentTime,z.data("input"),b),z.data("changed",!0),z.trigger("xchange.xdsoft"),z.trigger("changedatetime.xdsoft")}),B.on("mousewheel.xdsoft",function(a){return y.scrollMonth?(a.deltaY<0?C.nextMonth():C.prevMonth(),!1):!0}),b.on("mousewheel.xdsoft",function(a){if(!y.scrollInput)return!0;if(!y.datepicker&&y.timepicker)return O=H.find(".xdsoft_current").length?H.find(".xdsoft_current").eq(0).index():0,O+a.deltaY>=0&&O+a.deltaY<H.children().length&&(O+=a.deltaY),H.children().eq(O).length&&H.children().eq(O).trigger("mousedown"),!1;if(y.datepicker&&!y.timepicker)return B.trigger(a,[a.deltaY,a.deltaX,a.deltaY]),b.val&&b.val(C.str()),z.trigger("changedatetime.xdsoft"),!1}),z.on("changedatetime.xdsoft",function(b){if(y.onChangeDateTime&&a.isFunction(y.onChangeDateTime)){var c=z.data("input");y.onChangeDateTime.call(z,C.currentTime,c,b),delete y.value,c.trigger("change")}}).on("generate.xdsoft",function(){y.onGenerate&&a.isFunction(y.onGenerate)&&y.onGenerate.call(z,C.currentTime,z.data("input")),K&&(z.trigger("afterOpen.xdsoft"),K=!1)}).on("click.xdsoft",function(a){a.stopPropagation()}),O=0,P=function(){var b=z.data("input").offset(),c=b.top+z.data("input")[0].offsetHeight-1,d=b.left,e="absolute";y.fixed?(c-=a(window).scrollTop(),d-=a(window).scrollLeft(),e="fixed"):(c+z[0].offsetHeight>a(window).height()+a(window).scrollTop()&&(c=b.top-z[0].offsetHeight+1),c<0&&(c=0),d+z[0].offsetWidth>a(window).width()&&(d=a(window).width()-z[0].offsetWidth)),z.css({left:d,top:c,position:e})},z.on("open.xdsoft",function(b){var c=!0;y.onShow&&a.isFunction(y.onShow)&&(c=y.onShow.call(z,C.currentTime,z.data("input"),b)),c!==!1&&(z.show(),P(),a(window).off("resize.xdsoft",P).on("resize.xdsoft",P),y.closeOnWithoutClick&&a([document.body,window]).on("mousedown.xdsoft",function d(){z.trigger("close.xdsoft"),a([document.body,window]).off("mousedown.xdsoft",d)}))}).on("close.xdsoft",function(b){var c=!0;D.find(".xdsoft_month,.xdsoft_year").find(".xdsoft_select").hide(),y.onClose&&a.isFunction(y.onClose)&&(c=y.onClose.call(z,C.currentTime,z.data("input"),b)),c!==!1&&!y.opened&&!y.inline&&z.hide(),b.stopPropagation()}).on("toggle.xdsoft",function(a){z.is(":visible")?z.trigger("close.xdsoft"):z.trigger("open.xdsoft")}).data("input",b),Q=0,R=0,z.data("xdsoft_datetime",C),z.setOptions(y),C.setCurrentTime(S()),b.data("xdsoft_datetimepicker",z).on("open.xdsoft focusin.xdsoft mousedown.xdsoft",function(a){if(b.is(":disabled")||b.is(":hidden")||!b.is(":visible")||b.data("xdsoft_datetimepicker").is(":visible")&&y.closeOnInputClick)return;clearTimeout(Q),Q=setTimeout(function(){if(b.is(":disabled")||b.is(":hidden")||!b.is(":visible"))return;K=!0,C.setCurrentTime(S()),z.trigger("open.xdsoft")},100)}).on("keydown.xdsoft",function(b){var c=this.value,d,e=b.which;if([j].indexOf(e)!==-1&&y.enterLikeTab)return d=a("input:visible,textarea:visible"),z.trigger("close.xdsoft"),d.eq(d.index(this)+1).focus(),!1;if([q].indexOf(e)!==-1)return z.trigger("close.xdsoft"),!0})},B=function(b){var c=b.data("xdsoft_datetimepicker");c&&(c.data("xdsoft_datetime",null),c.remove(),b.data("xdsoft_datetimepicker",null).off(".xdsoft"),a(window).off("resize.xdsoft"),a([window,document.body]).off("mousedown.xdsoft"),b.unmousewheel&&b.unmousewheel())},a(document).off("keydown.xdsoftctrl keyup.xdsoftctrl").on("keydown.xdsoftctrl",function(a){a.keyCode===h&&(x=!0)}).on("keyup.xdsoftctrl",function(a){a.keyCode===h&&(x=!1)}),this.each(function(){var b=a(this).data("xdsoft_datetimepicker");if(b){if(a.type(c)==="string")switch(c){case"show":a(this).select().focus(),b.trigger("open.xdsoft");break;case"hide":b.trigger("close.xdsoft");break;case"toggle":b.trigger("toggle.xdsoft");break;case"destroy":B(a(this));break;case"reset":this.value=this.defaultValue,(!this.value||!b.data("xdsoft_datetime").isValidDate(Date.parseDate(this.value,y.format)))&&b.data("changed",!1),b.data("xdsoft_datetime").setCurrentTime(this.value)}else b.setOptions(c);return 0}a.type(c)!=="string"&&(!y.lazyInit||y.open||y.inline?A(a(this)):D(a(this)))})},a.fn.datetimepicker.defaults=b}(jQuery),function(){!function(a){"function"==typeof define&&define.amd?define(["jquery"],a):"object"==typeof exports?exports=a:a(jQuery)}(function(a){function b(b){var g=b||window.event,h=i.call(arguments,1),j=0,l=0,m=0,n=0,o=0,p=0;if(b=a.event.fix(g),b.type="mousewheel","detail"in g&&(m=-1*g.detail),"wheelDelta"in g&&(m=g.wheelDelta),"wheelDeltaY"in g&&(m=g.wheelDeltaY),"wheelDeltaX"in g&&(l=-1*g.wheelDeltaX),"axis"in g&&g.axis===g.HORIZONTAL_AXIS&&(l=-1*m,m=0),j=0===m?l:m,"deltaY"in g&&(m=-1*g.deltaY,j=m),"deltaX"in g&&(l=g.deltaX,0===m&&(j=-1*l)),0!==m||0!==l){if(1===g.deltaMode){var q=a.data(this,"mousewheel-line-height");j*=q,m*=q,l*=q}else if(2===g.deltaMode){var r=a.data(this,"mousewheel-page-height");j*=r,m*=r,l*=r}if(n=Math.max(Math.abs(m),Math.abs(l)),(!f||f>n)&&(f=n,d(g,n)&&(f/=40)),d(g,n)&&(j/=40,l/=40,m/=40),j=Math[j>=1?"floor":"ceil"](j/f),l=Math[l>=1?"floor":"ceil"](l/f),m=Math[m>=1?"floor":"ceil"](m/f),k.settings.normalizeOffset&&this.getBoundingClientRect){var s=this.getBoundingClientRect();o=b.clientX-s.left,p=b.clientY-s.top}return b.deltaX=l,b.deltaY=m,b.deltaFactor=f,b.offsetX=o,b.offsetY=p,b.deltaMode=0,h.unshift(b,j,l,m),e&&clearTimeout(e),e=setTimeout(c,200),(a.event.dispatch||a.event.handle).apply(this,h)}}function c(){f=null}function d(a,b){return k.settings.adjustOldDeltas&&"mousewheel"===a.type&&b%120===0}var e,f,g=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],h="onwheel"in document||document.documentMode>=9?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],i=Array.prototype.slice;if(a.event.fixHooks)for(var j=g.length;j;)a.event.fixHooks[g[--j]]=a.event.mouseHooks;var k=a.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var c=h.length;c;)this.addEventListener(h[--c],b,!1);else this.onmousewheel=b;a.data(this,"mousewheel-line-height",k.getLineHeight(this)),a.data(this,"mousewheel-page-height",k.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var c=h.length;c;)this.removeEventListener(h[--c],b,!1);else this.onmousewheel=null;a.removeData(this,"mousewheel-line-height"),a.removeData(this,"mousewheel-page-height")},getLineHeight:function(b){var c=a(b),d=c["offsetParent"in a.fn?"offsetParent":"parent"]();return d.length||(d=a("body")),parseInt(d.css("fontSize"),10)||parseInt(c.css("fontSize"),10)||16},getPageHeight:function(b){return a(b).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};a.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})}),Date.parseFunctions={count:0},Date.parseRegexes=[],Date.formatFunctions={count:0},Date.prototype.dateFormat=function(a){if(a=="unixtime")return parseInt(this.getTime()/1e3);Date.formatFunctions[a]==null&&Date.createNewFormat(a);var b=Date.formatFunctions[a];return this[b]()},Date.createNewFormat=function(format){var funcName="format"+Date.formatFunctions.count++;Date.formatFunctions[format]=funcName;var code="Date.prototype."+funcName+" = function() {return ",special=!1,ch="";for(var i=0;i<format.length;++i)ch=format.charAt(i),!special&&ch=="\\"?special=!0:special?(special=!1,code+="'"+String.escape(ch)+"' + "):code+=Date.getFormatCode(ch);eval(code.substring(0,code.length-3)+";}")},Date.getFormatCode=function(a){switch(a){case"d":return"String.leftPad(this.getDate(), 2, '0') + ";case"D":return"Date.dayNames[this.getDay()].substring(0, 3) + ";case"j":return"this.getDate() + ";case"l":return"Date.dayNames[this.getDay()] + ";case"S":return"this.getSuffix() + ";case"w":return"this.getDay() + ";case"z":return"this.getDayOfYear() + ";case"W":return"this.getWeekOfYear() + ";case"F":return"Date.monthNames[this.getMonth()] + ";case"m":return"String.leftPad(this.getMonth() + 1, 2, '0') + ";case"M":return"Date.monthNames[this.getMonth()].substring(0, 3) + ";case"n":return"(this.getMonth() + 1) + ";case"t":return"this.getDaysInMonth() + ";case"L":return"(this.isLeapYear() ? 1 : 0) + ";case"Y":return"this.getFullYear() + ";case"y":return"('' + this.getFullYear()).substring(2, 4) + ";case"a":return"(this.getHours() < 12 ? 'am' : 'pm') + ";case"A":return"(this.getHours() < 12 ? 'AM' : 'PM') + ";case"g":return"((this.getHours() %12) ? this.getHours() % 12 : 12) + ";case"G":return"this.getHours() + ";case"h":return"String.leftPad((this.getHours() %12) ? this.getHours() % 12 : 12, 2, '0') + ";case"H":return"String.leftPad(this.getHours(), 2, '0') + ";case"i":return"String.leftPad(this.getMinutes(), 2, '0') + ";case"s":return"String.leftPad(this.getSeconds(), 2, '0') + ";case"O":return"this.getGMTOffset() + ";case"T":return"this.getTimezone() + ";case"Z":return"(this.getTimezoneOffset() * -60) + ";default:return"'"+String.escape(a)+"' + "}},Date.parseDate=function(a,b){if(b=="unixtime")return new Date(isNaN(parseInt(a))?0:parseInt(a)*1e3);Date.parseFunctions[b]==null&&Date.createParser(b);var c=Date.parseFunctions[b];return Date[c](a)},Date.createParser=function(format){var funcName="parse"+Date.parseFunctions.count++,regexNum=Date.parseRegexes.length,currentGroup=1;Date.parseFunctions[format]=funcName;var code="Date."+funcName+" = function(input) {\nvar y = -1, m = -1, d = -1, h = -1, i = -1, s = -1, z = -1;\nvar d = new Date();\ny = d.getFullYear();\nm = d.getMonth();\nd = d.getDate();\nvar results = input.match(Date.parseRegexes["+regexNum+"]);\nif (results && results.length > 0) {",regex="",special=!1,ch="";for(var i=0;i<format.length;++i)ch=format.charAt(i),!special&&ch=="\\"?special=!0:special?(special=!1,regex+=String.escape(ch)):(obj=Date.formatCodeToRegex(ch,currentGroup),currentGroup+=obj.g,regex+=obj.s,obj.g&&obj.c&&(code+=obj.c));code+="if (y > 0 && z > 0){\nvar doyDate = new Date(y,0);\ndoyDate.setDate(z);\nm = doyDate.getMonth();\nd = doyDate.getDate();\n}",code+="if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0 && s >= 0)\n{return new Date(y, m, d, h, i, s);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0 && i >= 0)\n{return new Date(y, m, d, h, i);}\nelse if (y > 0 && m >= 0 && d > 0 && h >= 0)\n{return new Date(y, m, d, h);}\nelse if (y > 0 && m >= 0 && d > 0)\n{return new Date(y, m, d);}\nelse if (y > 0 && m >= 0)\n{return new Date(y, m);}\nelse if (y > 0)\n{return new Date(y);}\n}return null;}",Date.parseRegexes[regexNum]=new RegExp("^"+regex+"$"),eval(code)},Date.formatCodeToRegex=function(a,b){switch(a){case"D":return{g:0,c:null,s:"(?:Sun|Mon|Tue|Wed|Thu|Fri|Sat)"};case"j":case"d":return{g:1,c:"d = parseInt(results["+b+"], 10);\n",s:"(\\d{1,2})"};case"l":return{g:0,c:null,s:"(?:"+Date.dayNames.join("|")+")"};case"S":return{g:0,c:null,s:"(?:st|nd|rd|th)"};case"w":return{g:0,c:null,s:"\\d"};case"z":return{g:1,c:"z = parseInt(results["+b+"], 10);\n",s:"(\\d{1,3})"};case"W":return{g:0,c:null,s:"(?:\\d{2})"};case"F":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+b+"].substring(0, 3)], 10);\n",s:"("+Date.monthNames.join("|")+")"};case"M":return{g:1,c:"m = parseInt(Date.monthNumbers[results["+b+"]], 10);\n",s:"(Jan|Feb|Mar|Apr|May|Jun|Jul|Aug|Sep|Oct|Nov|Dec)"};case"n":case"m":return{g:1,c:"m = parseInt(results["+b+"], 10) - 1;\n",s:"(\\d{1,2})"};case"t":return{g:0,c:null,s:"\\d{1,2}"};case"L":return{g:0,c:null,s:"(?:1|0)"};case"Y":return{g:1,c:"y = parseInt(results["+b+"], 10);\n",s:"(\\d{4})"};case"y":return{g:1,c:"var ty = parseInt(results["+b+"], 10);\ny = ty > Date.y2kYear ? 1900 + ty : 2000 + ty;\n",s:"(\\d{1,2})"};case"a":return{g:1,c:"if (results["+b+"] == 'am') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(am|pm)"};case"A":return{g:1,c:"if (results["+b+"] == 'AM') {\nif (h == 12) { h = 0; }\n} else { if (h < 12) { h += 12; }}",s:"(AM|PM)"};case"g":case"G":case"h":case"H":return{g:1,c:"h = parseInt(results["+b+"], 10);\n",s:"(\\d{1,2})"};case"i":return{g:1,c:"i = parseInt(results["+b+"], 10);\n",s:"(\\d{2})"};case"s":return{g:1,c:"s = parseInt(results["+b+"], 10);\n",s:"(\\d{2})"};case"O":return{g:0,c:null,s:"[+-]\\d{4}"};case"T":return{g:0,c:null,s:"[A-Z]{3}"};case"Z":return{g:0,c:null,s:"[+-]\\d{1,5}"};default:return{g:0,c:null,s:String.escape(a)}}},Date.prototype.getTimezone=function(){return this.toString().replace(/^.*? ([A-Z]{3}) [0-9]{4}.*$/,"$1").replace(/^.*?\(([A-Z])[a-z]+ ([A-Z])[a-z]+ ([A-Z])[a-z]+\)$/,"$1$2$3")},Date.prototype.getGMTOffset=function(){return(this.getTimezoneOffset()>0?"-":"+")+String.leftPad(Math.floor(Math.abs(this.getTimezoneOffset())/60),2,"0")+String.leftPad(Math.abs(this.getTimezoneOffset())%60,2,"0")},Date.prototype.getDayOfYear=function(){var a=0;Date.daysInMonth[1]=this.isLeapYear()?29:28;for(var b=0;b<this.getMonth();++b)a+=Date.daysInMonth[b];return a+this.getDate()},Date.prototype.getWeekOfYear=function(){var a=this.getDayOfYear()+(4-this.getDay()),b=new Date(this.getFullYear(),0,1),c=7-b.getDay()+4;return String.leftPad(Math.ceil((a-c)/7)+1,2,"0")},Date.prototype.isLeapYear=function(){var a=this.getFullYear();return(a&3)==0&&(a%100||a%400==0&&a)},Date.prototype.getFirstDayOfMonth=function(){var a=(this.getDay()-(this.getDate()-1))%7;return a<0?a+7:a},Date.prototype.getLastDayOfMonth=function(){var a=(this.getDay()+(Date.daysInMonth[this.getMonth()]-this.getDate()))%7;return a<0?a+7:a},Date.prototype.getDaysInMonth=function(){return Date.daysInMonth[1]=this.isLeapYear()?29:28,Date.daysInMonth[this.getMonth()]},Date.prototype.getSuffix=function(){switch(this.getDate()){case 1:case 21:case 31:return"st";case 2:case 22:return"nd";case 3:case 23:return"rd";default:return"th"}},String.escape=function(a){return a.replace(/('|\\)/g,"\\$1")},String.leftPad=function(a,b,c){var d=new String(a);c==null&&(c=" ");while(d.length<b)d=c+d;return d},Date.daysInMonth=[31,28,31,30,31,30,31,31,30,31,30,31],Date.monthNames=["January","February","March","April","May","June","July","August","September","October","November","December"],Date.dayNames=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],Date.y2kYear=50,Date.monthNumbers={Jan:0,Feb:1,Mar:2,Apr:3,May:4,Jun:5,Jul:6,Aug:7,Sep:8,Oct:9,Nov:10,Dec:11},Date.patterns={ISO8601LongPattern:"Y-m-d H:i:s",ISO8601ShortPattern:"Y-m-d",ShortDatePattern:"n/j/Y",LongDatePattern:"l, F d, Y",FullDateTimePattern:"l, F d, Y g:i:s A",MonthDayPattern:"F d",ShortTimePattern:"g:i A",LongTimePattern:"g:i:s A",SortableDateTimePattern:"Y-m-d\\TH:i:s",UniversalSortableDateTimePattern:"Y-m-d H:i:sO",YearMonthPattern:"F, Y"}}(),module.exports||exports}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/text.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.text=teacss.ui.control.extend({init:function(a){var b=this;this._super($.extend({buttons:["bold","italic","removeformat"],oneline:!1},a)),this.element=this.options.element,this.element.wrapInner('<div class="editor_text"></div>');var c=this.element.find("> .editor_text"),d=$('<div class="text_toolbar">').hide();this.element.append(d),c.spacedText({document:Component.previewFrame.frame[0].contentWindow.document,window:Component.previewFrame.frame[0].contentWindow,toolbarExternal:d,focus:!1,convertLinks:!1,buttons:this.options.buttons,buttons_extra:[],oneline:this.options.oneline,on_change:$.proxy(function(a){b.value!=a&&(b.value=a,b.trigger("change"))},this)}),d.find("ul li").length<1&&d.css("visibility","hidden"),c.on("focus",$.proxy(function(a){d.show()},this)).on("blur",$.proxy(function(a){$(a.relatedTarget).closest("ul.spacedText_toolbar").length<1&&d.hide()},this))}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/color.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.color=teacss.ui.select.extendOptions({inline:!0,panelClass:"only-icons",iconSize:30,itemTpl:function(a){return $("<div class='font-set-item combo-item'>").append($("<div>").css({background:a.color||a.value,width:this.options.iconSize,height:this.options.iconSize,border:"1px solid #ccc"}))}}),lp.buttonColor=lp.color.extendOptions({iconSize:15,items:[{value:"blue",color:"#0187BC"},{value:"green",color:"#3E9802"},{value:"orange",color:"#FD6F00"},{value:"purple",color:"#8C33D2"},{value:"purple_light",color:"#9581BF"},{value:"rose",color:"#F372A4"},{value:"red",color:"#CE0707"},{value:"yellow",color:"#FFC415"}]}),lp.blockColor=lp.color.extendOptions({items:[{value:"#FFFFFF"},{value:"#F7F7F7"}]}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/cover.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.cover=teacss.ui.control.extend({showForm:function(){if(!this.current)return;$(".ui-dialog-content:visible").dialog("close"),Component.previewFrame.window.alertify.genericDialog(this.current.form[0])},showFormSuccess:function(){if(!this.current)return;$(".ui-dialog-content:visible").dialog("close"),Component.previewFrame.window.alertify.genericDialog(this.current.formSuccess[0])}},{init:function(a){var b=this;this._super(a),this.element=this.options.element,b.cover=$("<div class='cmp-cover fa fa-gear'>").click(function(){b.config({my:"left top",at:"right+5px top",of:b.cover,collision:"flipfit"})}).appendTo(this.element),b.form=this.element.find(".form"),b.formSuccess=this.element.find(".form_done"),b.options.init&&b.options.init.call(b)},config:lp.block.prototype.config}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/logo.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.logo=lp.cover.extendOptions({change:function(){var a=this,b=a.element.find(".logo");if(a.value.type=="image"){var c=b.find("img");c.length||b.empty().append(c=$("<img>")),c.attr({src:base_url+"/"+a.value.url,width:a.value.size+"%"})}else{var d=$(".company_name");d.length||b.empty().append(d=$('<div class="company_name">')),d.text(a.value.text).css({fontStyle:a.value.italic?"italic":"",fontWeight:a.value.bold?"bold":"",fontFamily:a.value.font||"",color:a.value.color||"",fontSize:a.value.fontSize?a.value.fontSize+"px":""})}},configForm:{title:_t("Logotype"),items:[{name:"type",type:"radio",margin:"5px 0 20px",items:[{label:_t("Image logo"),value:"image"},{label:_t("Text name logo"),value:"text"}]},{name:"url",type:"uploadButton",label:_t("Upload file"),showWhen:{type:"image"}},{type:"label",value:_t("Company name:"),margin:"10px 0 5px",showWhen:{type:"text"}},{name:"text",type:"text",showWhen:{type:"text"}},{type:"label",value:_t("Font settings:"),margin:"10px 0 5px",showWhen:{type:"text"}},{name:"font",type:"fontCombo",width:"50%",height:27,showWhen:{type:"text"}},{name:"bold",label:"<b>B</b>",type:"check",width:27,height:27,margin:"0 0 10px 5px",showCheckbox:!1,showWhen:{type:"text"}},{name:"italic",label:"<i>I</i>",type:"check",width:27,height:27,margin:"0 0 10px 5px",showCheckbox:!1,showWhen:{type:"text"}},{name:"color",type:"colorPicker",width:27,height:27,margin:"0 0 10px 5px",showWhen:{type:"text"}},_t("Size:"),{margin:"5px 0",name:"size",type:"slider",min:10,max:100,showWhen:{type:"image"}},{margin:"5px 0",name:"fontSize",type:"slider",min:14,max:30,showWhen:{type:"text"}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/icon.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.iconCombo=ui.combo.extendOptions({panelClass:"only-icons lp-icon-panel",inline:!0,height:"100%",margin:0,name:"",items:function(){var a=[];for(var b=1;b<=841;b++){if(b>=285&&b<=289)continue;if(b>=365&&b<=716)continue;if(b>=743&&b<=766)continue;a.push({value:"view/editor/assets/ico/"+b+".png"})}return a},itemTpl:function(a){return $("<div class='combo-item'>").css({backgroundImage:"url("+base_url+"/"+a.value+")"})}}),lp.iconComboWhite=lp.iconCombo.extendOptions({items:function(){var a=[];this.element.css({background:"transparent"}),this.element.parent().css({background:"#555"});for(var b=365;b<=716;b++)a.push({value:"view/editor/assets/ico/"+b+".png"});return a}}),lp.icon=lp.cover.extendOptions({init:function(){this.cover.appendTo(this.element.find(".ico"))},change:function(){this.element.find(".ico").css({backgroundImage:"url("+base_url+"/"+this.value+")"})}}).extend({init:function(a){a.configForm={title:_t("Icons"),width:550,height:500,item:a.iconType=="white"?lp.iconComboWhite:lp.iconCombo},a.iconType&&(a.configForm.id="dialog_"+a.iconType),this._super(a)}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/formOrder.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.formControls={},lp.formControls.field=teacss.ui.composite.extend({tpl_label:function(a){var b,c;return a.required&&(b="<i>*</i>"),a.desc?c=$('<div class="desc">').text(a.desc):c="",$('<div class="field_title">').text(a.label).append(b).add(c)}},{}),lp.formControls.text=lp.formControls.field.extendOptions({selectLabel:_t("Text"),selectIcon:"fa fa-font",tpl:function(a){return $('<div class="form_field">').append($("<label>").append(this.tpl_label(a),$('<input class="form_field_text" type="text">'),$('<div class="error">')))}},{items:[_t("Field label"),{type:"text",name:"label"},_t("Field description"),{type:"text",name:"desc"},{type:"checkbox",name:"required",label:_t("Is required?"),margin:"0"}]}),lp.formControls.textarea=lp.formControls.text.extend({selectLabel:_t("Text area"),selectIcon:"fa fa-bars",tpl:function(a){return $('<div class="form_field">').append($("<label>").append(this.tpl_label(a),$('<textarea class="form_field_textarea" rows="3">'),$('<div class="error">')))}},{}),lp.formControls.file=lp.formControls.text.extend({selectLabel:_t("File"),selectIcon:"fa fa-paperclip",tpl:function(a){return $('<div class="form_field">').append($("<label>").append(this.tpl_label(a),$('<input class="form_field_file" type="file" multiple="multiple">'),$('<div class="error">')))}},{}),lp.formControls.select=lp.formControls.field.extendOptions({selectLabel:_t("Select"),selectIcon:"fa fa-toggle-down","default":{options:_t("Option 1\nOption 2\nOption 3")},tpl:function(a){var b,c=$('<div class="form_field">').append($("<label>").append(this.tpl_label(a),$('<div class="form_field_select_wrap">').append(b=$('<select class="form_field_select">')),$('<div class="error">')));return $.each(a.options.split("\n"),function(){b.append($("<option>").text(this))}),c}},{items:[_t("Field label"),{type:"text",name:"label"},_t("Field description"),{type:"text",name:"desc"},_t("Options"),{type:"textarea",name:"options",height:55,width:448}]}),lp.formControls.radio=lp.formControls.select.extend({selectLabel:_t("Radio"),selectIcon:"fa fa-dot-circle-o",tpl:function(a,b){var c,d=$('<div class="form_field">').append($("<label>").append(this.tpl_label(a),c=$('<div class="form_field_radio_values">'),$('<div class="error">')));return $.each(a.options.split("\n"),function(){c.append($('<div class="form_field_radio_value">').append($("<label>").text(this).prepend('<input name="'+b+'" class="form_field_radio" type="radio" value="'+this+'"/>')))}),$(c.find("input")[0]).prop("checked",!0),d}},{}),lp.formControls.checkbox=teacss.ui.composite.extendOptions({selectLabel:_t("Checkbox"),selectIcon:"fa fa-check-square-o",tpl:function(a){return $("<div class='form_field'>").append($("<label>").append('<input class="form_field_checkbox" type="checkbox">','<span class="field_title">'+a.label+"</span>"))}},{items:[_t("Field label"),{type:"text",name:"label"}]}),lp.formOrder=lp.cover.extendOptions({},{change:function(){var a=this.getValue(),b=this.element.find(".form_fields").empty();$.each(a.fields,function(a,c){var d=lp.formControls[c.type];b.append(d.tpl(c,"field_"+a))}),this.element.find(".form_submit .form_field_submit").attr("class","form_field_submit "+a.button.color).find("span").text(a.button.label)},configForm:{title:_t("Form"),items:[{name:"fields",repeaterClass:"lp-field-repeater",type:teacss.ui.repeater.extend({init:function(a){this._super(a);var b=this;this.addCombo=teacss.ui.combo({label:_t("Add Field"),comboWidth:300,itemTpl:function(a){return $("<div>").addClass("lp-add-field "+a.sub.selectIcon).text(a.sub.selectLabel).mousedown(function(){b.addElement($.extend(a.sub.default||{},{type:a.type,label:a.sub.selectLabel})),b.trigger("change")})},items:function(){var a=[];return $.each(lp.formControls,function(b,c){c&&c.selectLabel&&a.push({value:b,sub:c,type:b})}),a}}),this.addButton.replaceWith(this.addCombo.element)},itemTemplate:function(a){var b=this._super(a),c=b.find(".ui-repeater-item-content").hide();return b.find(".ui-repeater-item-title").css({cursor:"pointer"}).prepend($("<span>")).click(function(){var a=c.is(":visible");b.parent().find(".ui-repeater-item-content").hide(),c.toggle(!a)}),b},updateLabel:function(a){var b=a.getValue(),c=a.itemContainer.find(".ui-repeater-item-title").addClass(lp.formControls[b.type].selectIcon);c.children("span").eq(0).text(b.label)},addElement:function(a){a=a||{};var b=lp.formControls[a.type]();b.setValue(a);var c=this;return b.bind("change",function(){c.updateLabel(b),c.trigger("change")}),this.push(b),this.updateLabel(b),b}})},{type:"label",value:_t("Button text:"),width:"53%",margin:"0 0 5px"},{type:"label",value:_t("Button color:"),width:"47%",margin:"0 0 5px"},{type:"text",name:"button.label",width:"50%",margin:"0 3% 12px 0"},{type:lp.color,name:"button.color",width:"47%",iconSize:15,items:[{value:"blue",color:"#0187BC"},{value:"green",color:"#3E9802"},{value:"orange",color:"#FD6F00"},{value:"purple",color:"#8C33D2"},{value:"purple_light",color:"#9581BF"},{value:"rose",color:"#F372A4"},{value:"red",color:"#CE0707"},{value:"yellow",color:"#FFC415"}]},{type:"button",label:_t("Show success window"),width:"auto",margin:"0 0 10px 0px",click:function(){lp.formOrder.showFormSuccess()}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/image.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.image=lp.cover.extendOptions({init:function(){this.cover.appendTo(this.element.find(".img"))},change:function(){this.element.find(".img").css({backgroundImage:"url('"+base_url+"/"+this.value+"')"})},configForm:{title:_t("Image"),items:[{type:"label",value:_t("Upload image file"),margin:"10px 0 5px"},{name:"",type:"uploadButton",label:_t("Select file")}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/logoItem.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.logoItem=lp.cover.extendOptions({change:function(){this.element.find("img").attr({src:base_url+"/"+this.value})},configForm:{title:_t("Image"),items:[{type:"label",value:_t("Upload image file"),margin:"10px 0 5px"},{name:"",type:"uploadButton",label:_t("Select file")}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/formButton.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.formButton=lp.cover.extendOptions({change:function(){var a=Component.previewFrame.window.$,b=this,c=b.element.find(".btn_form");b.value.type=="link"?c.attr("href",b.value.link):c.removeAttr("href"),c.text(b.value.text).prop("class","btn_form "+b.value.color)},configForm:{title:_t("Order button"),items:[{type:"label",value:_t("Button behavior after click:"),width:"100%",margin:"2px 0"},{name:"type",type:"radio",margin:"5px 0 15px",items:[{label:_t("Show order form"),value:"form"},{label:_t("Go to the link"),value:"link"}]},{type:"label",value:_t("Button text:"),width:"53%",margin:"5px 0 2px 0"},{type:"label",value:_t("Button color:"),width:"47%",margin:"5px 0 2px 0"},{type:"text",name:"text",width:"50%",margin:"0 3% 10px 0"},{type:lp.buttonColor,name:"color",width:"47%",margin:"0 0 8px"},{type:"label",value:_t("Form"),width:"100%",margin:"5px 0",showWhen:{type:"form"}},{type:"label",value:_t("Link"),width:"100%",margin:"5px 0",showWhen:{type:"link"}},{type:"button",label:_t("Show form"),width:"auto",margin:"0 0 10px",showWhen:{type:"form"},click:function(){lp.formButton.showForm()}},{type:"button",label:_t("Show success window"),width:"auto",margin:"0 0 10px 8px",showWhen:{type:"form"},click:function(){lp.formButton.showFormSuccess()}},{type:"text",name:"link",width:"100%",margin:"0 3% 10px 0",showWhen:{type:"link"}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/uploadButton.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return teacss.ui.uploadButton=teacss.ui.button.extend({iconWidth:64,iconHeight:52},{init:function(a){var b=this;this._super($.extend({label:_t("Upload file"),uploadDir:"files"},a));var c=$("<input type='file'>").css({position:"fixed",top:0,left:0,zIndex:1e4,width:0}).hide().appendTo("body");c.change(function(){var a=new FormData;$.each(c[0].files,function(b,c){a.append("file-"+b,c)}),a.append("_type","upload"),a.append("name",b.options.uploadDir),a.append("iconWidth",b.Class.iconWidth),a.append("iconHeight",b.Class.iconHeight),$.ajax({url:Component.app.options.ajax_url,data:a,cache:!1,contentType:!1,processData:!1,type:"POST",success:function(a){a=$.parseJSON(a);var c=a[0].url.substring(base_url.length);c[0]=="/"&&(c=c.substring(1)),b.value=c,b.trigger("change")}})}),this.element.click(function(a){a.preventDefault(),c.val("").show(),c.click(),c.hide()})}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/fontCombo.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return ui.fontCombo=ui.combo.extendOptions({itemTpl:function(a){var b=$("<div class='font-set-item combo-item'>");return a.value?b.append("<div style='font-family:${value};font-size:11.6px;'>"+a.value+"</div>"):b.append("<div style='font-weight:bold;font-size:11.6px;'>auto</div>"),b},buttonClass:"icon-button",selectedIndex:0,preview:!0,falseItem:!0,items:function(){var a=this.options.falseItem?[{value:!1}]:[];return a=a.concat([{value:"Verdana"},{value:"Lucida Grande"},{value:"Arial"},{value:"Georgia"},{value:"Impact"},{value:"Times New Roman"},{value:"Trebuchet MS"},{value:"Palatino Linotype"},{value:"Comic Sans MS"},{value:"Century Gothic"},{value:"Open Sans"}]),a}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/media.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.media=lp.cover.extend({init:function(a){a.configForm={title:_t("Media file"),items:[{name:"image_url",type:"uploadButton",label:_t("Upload file"),showWhen:{type:"image"}},{type:"label",value:_t("Video url (youtube or vimeo):"),margin:"5px 0 0",showWhen:{type:"video"}},{name:"video_url",type:"text",margin:"5px 0 0",showWhen:{type:"video"}},{type:"label",value:_t("example: www.youtube.com/embed/P55qVX3y134"),margin:"0 0 5px 0",showWhen:{type:"video"}}]},a.switchType!==!1&&a.configForm.items.unshift({name:"type",type:"radio",margin:"15px 0 20px",items:[{label:_t("Image"),value:"image"},{label:_t("Video"),value:"video"}]}),a.configForm.id="dialog_"+(a.switchType===!1?"nosw":"sw"),a.change=function(){var a=this.element.find(".media");if(this.value.type=="image")a.empty(a),a.append($('<div class="img">').css({backgroundImage:"url('"+base_url+"/"+this.value.image_url+"')"}));else if(this.value.type=="video"){var b=this.value.video_url,c=/youtu/,d=/vimeo/;if(c.test(b)){var e=/^.*((youtu.*be\/)|(v\/)|(\/u\/\w\/)|(embed\/)|(watch\?))\??v?=?([^#\&\?]*).*/,f=b.match(e);f&&(a.empty(a),a.append($('<iframe frameborder="0"></iframe>').attr({src:"//www.youtube.com/embed/"+f[7]+"?showinfo=0&controls=2&theme=light&rel=0"})))}else if(d.test(b)){var g=/^.*(vimeo\.com\/)((channels\/[A-z]+\/)|(groups\/[A-z]+\/videos\/))?([0-9]+)/,f=b.match(g);f&&(a.empty(a),a.append($('<iframe frameborder="0"></iframe>').attr({src:"//player.vimeo.com/video/"+f[5]})))}else a.empty(a),a.append($('<iframe frameborder="0"></iframe>').attr({src:base_url+"/view/editor/assets/404.php"}))}},this._super(a)}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/countdown.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.dateText=ui.text.extend({init:function(a){this._super(a),this.input.css({lineHeight:1.8,textAlign:"center"}),this.input.datetimepicker($.extend({animation:!1,days:!0,mask:!0,timepicker:!1,format:"Y/m/d",closeOnDateSelect:!0,minDate:new Date},a.pickerOptions||{}))}}),lp.countdown=lp.cover.extendOptions({change:function(){var a=this.element.find(".countdown"),b={type:this.value.type,date:this.value.date,day:this.value.day,dayOfWeek:this.value.dayOfWeek,time:this.value.time};a.attr("data-datetime",JSON.stringify(b));var c=Component.previewFrame.window.$;c(a).lpCounty(b)},configForm:{title:_t("Countdown settings"),width:"250px",items:[{name:"type",type:"radio",margin:"5px 0 5px",items:[{label:_t("Exact date<br>"),value:"datetime"},{label:_t("Every month<br>"),value:"monthly"},{label:_t("Every week<br>"),value:"weekly"},{label:_t("Every day<br>"),value:"daily"}]},"<hr>",{type:"label",value:_t("Date:"),width:"65%",margin:"5px 5% 5px 0",showWhen:{type:"datetime"}},{type:"label",value:_t("Day:"),width:"65%",margin:"5px 5% 5px 0",showWhen:{type:"monthly"}},{type:"label",value:_t("Day of week:"),width:"65%",margin:"5px 5% 5px 0",showWhen:{type:"weekly"}},{type:"label",value:_t("Time:"),width:"25%",margin:"5px 5% 5px 0",showWhen:{type:["datetime","monthly","weekly"]}},{type:"label",value:_t("Time:"),width:"100%",margin:"11px 70% 5px 0",showWhen:{type:"daily"}},{name:"date",type:lp.dateText,width:"65%",margin:"5px 5% 5px 0",showWhen:{type:"datetime"}},{name:"day",type:teacss.ui.select,items:function(){var a=[];for(i=1;i<=31;i++)a.push({value:i,label:i});return a}(),width:"65%",margin:"5px 5% 5px 0",showWhen:{type:"monthly"}},{name:"dayOfWeek",type:teacss.ui.select,items:[{value:1,label:_t("Monday")},{value:2,label:_t("Tuesday")},{value:3,label:_t("Wednesday")},{value:4,label:_t("Thursday")},{value:5,label:_t("Friday")},{value:6,label:_t("Saturday")},{value:7,label:_t("Sunday")}],width:"65%",margin:"5px 5% 5px 0",showWhen:{type:"weekly"}},{name:"time",type:lp.dateText,width:"25%",margin:"5px 5% 5px 0",pickerOptions:{format:"H:i",step:30,timepicker:!0,datepicker:!1}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/galleryRepeater.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.galleryRepeater=lp.repeater.extendOptions({inline:!0,itemChange:function(a,b){b.find(".img_title").text(a.title),b.find(".img_desc").text(a.desc),this.options.sortable?b.find(".preview_img").css({backgroundImage:"url('"+base_url+"/"+a.image+"')"}):b.find(".preview_img img").attr({src:base_url+"/"+a.image}),b.find(".big_img").attr("href",base_url+"/"+a.image).attr("title",a.title)},configForm:{title:_t("Image"),items:[{type:"label",value:_t("Upload image file"),margin:"10px 0 5px"},{name:"image",type:"uploadButton",label:_t("Select file")},{type:"label",value:_t("Image title:"),margin:"10px 0 5px"},{name:"title",type:"text"},{type:"label",value:_t("Image description:"),margin:"10px 0 5px"},{name:"desc",type:"text"}]}}).extend({init:function(a){this._super(a),this.addButtonWrap&&!this.options.sortable&&this.element.parents(".item_list").eq(0).append(this.addButtonWrap.css({marginTop:-90}))}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/overlayImage.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.overlayImage=lp.cover.extendOptions({init:function(){this.cover.addClass("lp-button")},change:function(){this.element.find(".img_title").text(this.value.title),this.element.find(".img_desc").text(this.value.desc),this.value.image&&(this.element.find(".big_img").attr("title",this.value.title),this.element.find(".preview_img").css({backgroundImage:"url('"+base_url+"/"+this.value.image+"')"}),this.element.find(".big_img").attr("href",base_url+"/"+this.value.image))},configForm:{title:_t("Image"),items:[{type:"label",value:_t("Upload image file"),margin:"10px 0 5px"},{name:"image",type:"uploadButton",label:_t("Select file")},{type:"label",value:_t("Image title:"),margin:"10px 0 5px"},{name:"title",type:"text"},{type:"label",value:_t("Image description:"),margin:"10px 0 5px"},{name:"desc",type:"text"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/galleryImage.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.galleryImage=lp.cover.extendOptions({init:function(){this.cover.addClass("lp-button")},change:function(){this.value.image&&(this.element.find(".preview_img").css({backgroundImage:"url('"+base_url+"/"+this.value.image+"')"}),this.element.find(".big_img").attr("href",base_url+"/"+this.value.image))},configForm:{title:_t("Image"),items:[{type:"label",value:_t("Upload image file"),margin:"10px 0 5px"},{name:"image",type:"uploadButton",label:_t("Select file")}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/background.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.background=teacss.ui.select.extendOptions({inline:!0,panelClass:"only-icons",items:function(){var a=[];a.push({value:{color:"#313138"}},{value:{color:"#24242A"}});for(var b=1;b<=3;b++)a.push({value:{url:"view/editor/assets/texture_black/"+b+".jpg"}});return a},itemTpl:function(a){return $("<div class='combo-item'>").append($("<div>").css({width:50,height:50,background:a.value.url?"url("+base_url+"/"+a.value.url+")":a.value.color,backgroundSize:"cover",backgroundPosition:"auto 100%"}))}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/internal/liquid.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.liquid=lp.cover.extendOptions({change:function(){this.element.html(this.value.tpl.replace("{{base_url}}",base_url))},configForm:{width:800,items:[_t("Template"),{name:"tpl",height:300,type:ui.textarea.extend({init:function(a){this._super(a);var b=this.element,c=this,d=new ui.uploadButton({label:_t("Upload image")});d.bind("change",function(){c.setValue(c.getValue()+'<img src="{{base_url}}/'+this.getValue()+'">'),c.trigger("change")}),this.element=$("<div>").append(b).append(d.element),this.input.css({overflow:"auto",whiteSpace:"nowrap"})}})}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/lib/ymaps.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return $.fn.mapYandex=function(a,b){$(this).each(function(){function j(){var a,d=c.data("ymap");d?d.setCenter(e,Number(h)):(d=new ymaps.Map(c[0],{center:e,zoom:h,controls:["geolocationControl","fullscreenControl","zoomControl"]}),c.data("ymap",d),b&&b(d)),d.behaviors.disable("scrollZoom"),d.geoObjects.removeAll();var g;for(i=0;i<f.length;i++){var j=f[i],g=[j.lat,j.lng];a=new ymaps.Placemark(g,{hintContent:j.title,balloonContentHeader:j.title,balloonContentBody:j.address},{balloonCloseButton:!0,balloonPanelMaxMapArea:"Infinity",balloonPane:"outerBalloon",preset:"islands#"+j.color+"DotIcon"}),d.geoObjects.add(a)}}var c=$(this),d=a||JSON.parse(c.attr("data-map-settings")),e=d.map_center,f=d.map_places,g=d.map_type,h=d.map_zoom;ymaps.ready(function(){j()})})},c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/header.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.header=lp.block.extendOptions({change:function(){this.variant.find(".header").css({background:this.value.background||""});if(this.value.variant==2){var a=this.value.show_order_button;this.variant.find(".span_btn").toggleVis(a),this.variant.find(".phone").toggleClass("no_btn",!a)}if(this.value.variant==3){var a=this.value.show_desc_and_order_button;this.variant.find(".span_btn").toggleVis(a),this.variant.find(".desc_2").toggleVis(a),this.variant.find(".desc_1").toggleClass("no_btn",!a),this.variant.find(".phone").toggleClass("no_btn",!a)}if(this.value.variant==4){var a=this.value.show_order_button;this.variant.find(".span_btn").toggleVis(a),this.variant.find(".phone").toggleClass("no_btn",!a),this.variant.find(".desc").toggleClass("hidden",this.value.logo.type=="image")}},configForm:{items:[{name:"show_desc_and_order_button",label:_t("Show description and order button"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{name:"show_order_button",label:_t("Show order button"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2,4]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/order.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.order=lp.block.extendOptions({change:function(){this.value.background&&this.variant.find(".order_"+this.value.variant).css({backgroundImage:"url("+base_url+"/"+this.value.background+")"}),this.value.background_color&&this.variant.find(".order_"+this.value.variant).css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".form_title_2").toggleVis(this.value.show_form_title_2),this.variant.find(".form_bottom").toggleVis(this.value.show_form_bottom_text)),this.value.variant==2&&(this.variant.find(".btn_note").toggleVis(this.value.show_text_above_button),this.variant.find(".btn_wrap").toggleClass("no_btn_note",!this.value.show_text_above_button),this.variant.find(".btn_wrap").toggleClass("no_arrow",!this.value.show_arrow),this.value.show_background_noise?this.variant.find(".background_toggle_noise").addClass("with_noise").removeClass("dark"):this.variant.find(".background_toggle_noise").removeClass("with_noise").addClass("dark")),this.value.variant==3&&(this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".img_wrap").toggleClass("hide_border",!this.value.show_border),this.variant.find(".list").toggleVis(this.value.show_list_box)),this.value.variant==4&&(this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".img_wrap").toggleClass("hide_box_shadow",!this.value.show_box_shadow),this.variant.find(".form_bottom").toggleVis(this.value.show_form_bottom_text)),this.value.variant==5&&(this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".form_bottom").toggleVis(this.value.show_form_bottom_text)),this.value.variant==6&&(this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".title_3").toggleVis(this.value.show_title_3),this.variant.find(".content_wrap").prop("class","content_wrap align_"+this.value.form_align),this.variant.find(".form_bottom").toggleVis(this.value.show_form_bottom_text))},configForm:{items:[{type:"label",value:_t("Background image:"),margin:"5px 0",showWhen:{variant:[1,2,6]}},{name:"background",width:245,type:ui.combo.extendOptions({panelClass:"only-icons",comboWidth:660,comboHeight:600,closeOnSelect:!1,icons:{secondary:"ui-icon-triangle-1-s"},items:function(){var a=[];for(var b=1;b<=221;b++)a.push({value:"view/editor/assets/background/"+b+".jpg",thumb:"view/editor/assets/background/thumbs/"+b+".jpg"});return a},itemTpl:function(a){return $("<div class='combo-item'>").append($("<div>").css({width:200,height:50,backgroundSize:"cover",backgroundPosition:"50% 50%",backgroundImage:"url("+base_url+"/"+(a.thumb||a.value)+")"}))}}),showWhen:{variant:[1,2,6]}},{name:"background",type:"uploadButton",label:_t("Upload image file"),showWhen:{variant:[1,2,6]}},{name:"show_background_noise",label:_t("Show noise"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2]}},{name:"show_text_above_button",label:_t("Show text above the button"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2]}},{name:"show_arrow",label:_t("Show arrow"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2]}},{name:"show_form_title_2",label:_t("Show text under the form title"),type:"checkbox",width:"auto",value:1,margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3,4,5,6]}},{name:"show_title_3",label:_t("Show third title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[6]}},{name:"show_form_bottom_text",label:_t("Show text under the form"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,4,5,6]}},{name:"show_border",label:_t("Show image around"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{name:"show_box_shadow",label:_t("Show image around"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[4]}},{name:"show_list_box",label:_t("Show list box"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{type:"label",value:_t("Form align:"),margin:"10px 0 0 0",showWhen:{variant:[6]}},{name:"form_align",items:[{label:_t("left<br>"),value:"left"},{label:_t("center<br>"),value:"center"},{label:_t("right"),value:"right"}],type:"radio",width:"auto",margin:"0px 0px 5px 0px",showWhen:{variant:[6]}},{type:"label",value:_t("Background color:"),margin:"5px 0",showWhen:{variant:[4,5]}},{type:lp.color,name:"background_color",items:[{value:"#313138"},{value:"#143A4F"},{value:"#19678B"},{value:"#4E6D8D"},{value:"#607FA4"},{value:"#0E93B3"},{value:"#1E4147"},{value:"#198B82"},{value:"#0C884A"},{value:"#393458"},{value:"#583458"},{value:"#614C8A"},{value:"#8C0C24"},{value:"#593D36"}],showWhen:{variant:[4,5]}},{type:"label",value:_t("Background texture:"),margin:"5px 0",showWhen:{variant:[3]}},{name:"background",width:95,type:ui.combo.extendOptions({panelClass:"only-icons",comboWidth:480,comboHeight:600,closeOnSelect:!1,icons:{secondary:"ui-icon-triangle-1-s"},items:function(){var a=[];for(var b=1;b<=24;b++)a.push({value:"view/editor/assets/texture/"+b+".png"});return a},itemTpl:function(a){return $("<div class='combo-item'>").append($("<div>").css({width:50,height:50,backgroundSize:"cover",backgroundPosition:"auto 100%",backgroundImage:"url("+base_url+"/"+a.value+")"}))}}),showWhen:{variant:[3]}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/benefits.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.benefits=lp.block.extendOptions({change:function(){var a=this;a.value.background_color&&a.variant.find(".benefits_"+this.value.variant).css({background:a.value.background_color||""}),this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.value.variant==1&&(this.variant.find(".name").toggleVis(this.value.show_name_benefit),this.variant.find(".desc").toggleVis(this.value.show_desc_benefit),this.variant.find(".item_list").toggleClass("hide_ico_border",!this.value.show_icon_border)),this.value.variant==2&&(this.variant.find(".name").toggleVis(this.value.show_name_benefit),this.variant.find(".desc").toggleVis(this.value.show_desc_benefit)),this.value.variant==3&&(this.variant.find(".name").toggleVis(this.value.show_name_benefit),this.variant.find(".item_list").toggleClass("hide_name",!this.value.show_name_benefit)),this.value.variant==4&&this.variant.find(".item_list").toggleClass("hide_border",!this.value.show_image_border),this.value.variant==5&&(this.variant.find(".name").toggleVis(this.value.show_name_benefit),this.variant.find(".desc").toggleVis(this.value.show_desc_benefit),this.variant.find(".item_list").toggleClass("hide_border",!this.value.show_image_border))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_icon_border",label:_t("Show icon around"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_name_benefit",label:_t("Show name benefit"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2,3,5]}},{name:"show_desc_benefit",label:_t("Show description benefit"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2,5]}},{name:"show_image_border",label:_t("Show image around"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[4,5]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/services.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.services=lp.block.extendOptions({init:function(){var a=Component.previewFrame.window.$;a&&a("form .form_field_submit").click(function(b){a("form").formValidateSubmit(b),b.preventDefault()})},change:function(){var a=Component.previewFrame.window.$;a&&a("form .form_field_submit").click(function(b){a("form").formValidateSubmit(b),b.preventDefault()}),this.variant.find(".services").css({background:this.value.background||""}),this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.value.variant==1&&(this.variant.find(".img_wrap").toggleVis(this.value.show_image),this.variant.find(".desc").toggleVis(this.value.show_desc),this.variant.find(".price").toggleVis(this.value.show_price),this.variant.find(".btn_wrap").toggleVis(this.value.show_order_button)),this.value.variant==2&&(this.variant.find(".desc").toggleVis(this.value.show_desc),this.variant.find(".price").toggleVis(this.value.show_price),this.variant.find(".btn_wrap").toggleVis(this.value.show_order_button),this.variant.find(".item").toggleClass("hide_shadow",!this.value.show_image_shadow),this.variant.find(".item_list").prop("class","item_list "+this.value.image_shape)),this.value.variant==3&&(this.variant.find(".desc").toggleVis(this.value.show_desc),this.variant.find(".price").toggleVis(this.value.show_price),this.variant.find(".btn_note").toggleVis(this.value.show_text_above_button),this.variant.find(".btn_wrap").toggleVis(this.value.show_order_button),this.variant.find(".item").toggleClass("hide_shadow",!this.value.show_image_shadow),this.variant.find(".img_data").prop("class","img_data image_"+this.value.image_size)),this.value.variant==4&&(this.variant.find(".img_wrap").toggleVis(this.value.show_image),this.variant.find(".desc").toggleVis(this.value.show_desc),this.variant.find(".price").toggleVis(this.value.show_price),this.variant.find(".btn_wrap").toggleVis(this.value.show_order_button)),this.value.variant==5&&(this.variant.find(".img_wrap").toggleVis(this.value.show_image),this.variant.find(".desc").toggleVis(this.value.show_desc),this.variant.find(".price").toggleVis(this.value.show_price),this.variant.find(".btn_wrap").toggleVis(this.value.show_order_button),this.variant.find(".item_list").prop("class","item_list "+this.value.image_shape))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_image",label:_t("Show image"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,4,5]}},{name:"show_name",label:_t("Show name"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[]}},{name:"show_desc",label:_t("Show description"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2,3,4,5]}},{name:"show_price",label:_t("Show price"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2,3,4,5]}},{name:"show_text_above_button",label:_t("Show text above order button"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{name:"show_order_button",label:_t("Show order button"),type:"checkbox",width:"100%",margin:"5px 79.8% 0px 0px",showWhen:{variant:[1,2,3,4,5]}},{name:"show_image_shadow",label:_t("Show image shadow"),type:"checkbox",width:"auto",margin:"5px 0 0 0",showWhen:{variant:[2]}},{name:"show_image_shadow",label:_t("Show shadow under image"),type:"checkbox",width:"auto",margin:"5px 0 0 0",showWhen:{variant:[3]}},{type:"label",value:_t("Image size:"),margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{name:"image_size",items:[{label:_t("middle<br>"),value:"middle"},{label:_t("large"),value:"large"}],type:"radio",width:"auto",margin:"0px 49% 10px 0px",showWhen:{variant:[3]}},{type:"label",value:_t("Image shape:"),margin:"5px 49% 0px 0px",showWhen:{variant:[2,5]}},{name:"image_shape",items:[{label:_t("circle<br>"),value:"circle"},{label:_t("square"),value:"square"}],type:"radio",width:"auto",margin:"0px 49% 10px 0px",showWhen:{variant:[2,5]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/reasons.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.reasons=lp.block.extendOptions({change:function(){this.variant.find(".reasons").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/gallery.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.gallery=lp.block.extendOptions({init:function(){var a=Component.previewFrame.window.$;a&&a(".fancybox:visible").lpFancybox()},change:function(){var a=Component.previewFrame.window.$;this.variant.find(".gallery").css({background:this.value.background||""}),this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".fancybox").toggleVis(this.value.enable_fancybox),a&&this.value.enable_fancybox&&a(".fancybox:visible").lpFancybox();if(this.value.variant==1||this.value.variant==5||this.value.variant==6||this.value.variant==7||this.value.variant==8||this.value.variant==9||this.value.variant==10)this.variant.find(".img_title").toggleVis(this.value.show_image_title),this.variant.find(".img_desc").toggleVis(this.value.show_image_desc),this.variant.find(".item_list").toggleClass("no_opacity",!this.value.show_image_title&&!this.value.show_image_desc);if(this.value.variant==2){this.variant.find(".img_text").unbind("keyup").on("keyup",function(){var b=a(this).parent(".in"),c=a(this).parents(".overlay");c.height(b.outerHeight())}),this.variant.find(".img_desc").toggleVis(this.value.show_image_desc),this.variant.find(".item_list").toggleClass("hide_desc",!this.value.show_image_desc),this.variant.find(".item_list").toggleClass("hide_overlay",!this.value.show_image_overlay);var b=this.variant.find(".gallery_2 .item_list .item_block .item");a(b).textBlockHeight()}if(this.value.variant==3||this.value.variant==4)this.variant.find(".img_desc").toggleVis(this.value.show_image_desc),this.variant.find(".overlay").toggleVis(this.value.show_image_overlay);if(this.value.variant==5){var c=this.variant.find(".slider [data-name=items]");a(c).lpBxSlider()}if(this.value.variant==6){var d=this.variant.find(".masonry");a(d).lpMasonry()}},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_image_title",label:_t("Show image title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,5,6,7,8,9,10]}},{name:"show_image_overlay",label:_t("Show block with text"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2,3,4]}},{name:"show_image_desc",label:_t("Show image description"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,5,6,7,8,9,10]}},{name:"show_image_desc",label:_t("Show image description"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2,3,4],show_image_overlay:!0}},{name:"enable_fancybox",label:_t("Show big image (enable fancybox)"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,3,4,5,6,7,8,9,10]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/logos.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.logos=lp.block.extendOptions({change:function(){this.variant.find(".clientsLogos").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".item_list").toggleClass("gray",this.value.grayscale_logo))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"grayscale_logo",label:_t("Grayscale logo"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/cases.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.cases=lp.block.extendOptions({change:function(){this.variant.find(".cases").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".name").toggleVis(this.value.show_name),this.variant.find(".desc").toggleVis(this.value.show_desc))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_name",label:_t("Show name company"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_desc",label:_t("Show description"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/stages.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.stages=lp.block.extendOptions({change:function(){this.variant.find(".stages").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".name").toggleVis(this.value.show_name),this.variant.find(".desc").toggleVis(this.value.show_desc)),this.value.variant==2&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2]}},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2]}},{name:"show_name",label:_t("Show name step"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_desc",label:_t("Show description step"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/feedback.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.feedback=lp.block.extendOptions({change:function(){this.variant.find(".feedback").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".img_wrap").toggleVis(this.value.show_image))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_image",label:_t("Show image"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/map.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.placemarkRepeater=teacss.ui.repeater.extend({init:function(a){var b=this;this._super($.extend({addLabel:_t("Add placemark"),repeaterClass:"lp-placemark-repeater",items:[{type:"text",name:"title",width:"32%",margin:"0 1% 0 0"},{type:lp.addressText,name:"",width:"32%",margin:"0 1% 0 0"},{type:lp.color,name:"color",width:"23%",iconSize:12,margin:"0",items:[{value:"blue",color:"#0187BC"},{value:"green",color:"#56DB40"},{value:"orange",color:"#E6761B"},{value:"violet",color:"#B51EFF"},{value:"pink",color:"#F371D1"},{value:"red",color:"#ED4543"},{value:"yellow",color:"#FFD21E"}]},{type:"button",label:_t("center"),width:"7%",margin:"0 1% 0 0",click:function(a){var c=lp.map.current;c.value.map.map_center=[this.form.value.lat,this.form.value.lng],b.trigger("change")}}]},a))},newElement:function(){var a=this.getValue();a.length?this.addElement($.extend(!0,{},a[a.length-1])):this.addElement()}}),lp.addressText=ui.text.extend({init:function(a){var b=this;this._super(a),this.bind("change",function(){function c(c){if(a!=b.input.val())return;var d=c?c.response.GeoObjectCollection.featureMember:!1;if(d&&d.length){var e=d[0].GeoObject.Point.pos,f=e.split(" ");b.value.lat=f[1],b.value.lng=f[0],b.input.removeClass("error");var g=lp.map.current;g.value.map.map_center=[b.value.lat,b.value.lng],b.trigger("change")}else b.input.addClass("error"),b.value.lat="",b.value.lng="";b.lastAddress=a,b.coordsChange=!0,b.trigger("change"),b.coordsChange=!1}if(b.coordsChange)return;var a=b.input.val();if(a==b.lastAddress)return;a?(clearTimeout(b.geocodeTimeout),b.geocodeTimeout=setTimeout(function(){$.get("http://geocode-maps.yandex.ru/1.x/",{format:"json",results:1,geocode:a},c)},500)):c(!1)})},setValue:function(a){a=a||{},this.input.val(a.address),this.value=a},getValue:function(){return this.value.address=this.input.val(),this.value}}),lp.map=lp.block.extendOptions({init:function(){var a=Component.previewFrame.window.$;if(a){var a=Component.previewFrame.window.$;a(this.element.find(".map")).mapYandex(this.value.map)}},change:function(){this.value.variant==1&&this.variant.find(".container_text").toggleVis(this.value.show_container_text);var a=Component.previewFrame.window.$;a(this.element.find(".map")).mapYandex(this.value.map)},configForm:{width:800,items:[{name:"show_container_text",label:_t("Show text"),type:"checkbox",width:"auto",margin:"0",showWhen:{variant:[1]}},"<hr>",{type:"composite",skipForm:!0,margin:0,items:[{type:"label",value:_t("Name"),width:"32%",margin:"0 1% 2px 0"},{type:"label",value:_t("Address"),width:"32%",margin:"0 1% 2px 0"},{type:"label",value:_t("Color"),width:"23%",margin:"0 0 2px 0"},{type:lp.placemarkRepeater,name:"map.map_places"}]},{height:300,margin:0,name:"map",type:ui.panel.extend({init:function(a){this._super(a)},setValue:function(a){function c(){b.element.mapYandex(a,function(a){a.events.add("boundschange",function(b){var c=lp.map.current;c.value.map.map_center=a.getCenter(),c.value.map.map_zoom=a.getZoom(),c.trigger("change")})})}var b=this;a&&a.map_type&&(window.ymaps?c():teacss.LazyLoad_f(document).js("http://api-maps.yandex.ru/2.1/?lang=ru_RU",c))}})}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/footer.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.footer=lp.block.extendOptions({change:function(){this.variant.find(".footer").css({background:this.value.background_color||""}),this.value.variant==1&&this.variant.find(".policy_wrap").toggleVis(this.value.show_policy)},configForm:{items:[{name:"show_policy",label:_t("Show policy"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/video.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.video=lp.block.extendOptions({change:function(){this.variant.find(".video_block").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".video").prop("class","video "+this.value.video_size)),this.value.variant==2&&this.variant.find(".text_title_2").toggleVis(this.value.show_text_title_2),this.value.variant==3&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".desc").toggleVis(this.value.show_desc),this.variant.find(".video").toggleClass("hide_border",!this.value.show_border))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,3]}},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,3]}},{name:"show_text_title_2",label:_t("Show second text title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2]}},{name:"show_desc",label:_t("Show description"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{name:"show_border",label:_t("Show border"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3]}},{type:"label",value:_t("Video size:"),margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"video_size",items:[{label:_t("small<br>"),value:"small"},{label:_t("medium<br>"),value:"medium"},{label:_t("large"),value:"large"}],type:"radio",width:"auto",margin:"0px 49% 10px 0px",showWhen:{variant:[1]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/textBlock.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.textBlock=lp.block.extendOptions({change:function(){this.variant.find(".text_block").css({background:this.value.background_color||""}),this.value.variant==1&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".list_wrap").toggleVis(this.value.show_list)),this.value.variant==2&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.variant.find(".name").toggleVis(this.value.show_name)),this.value.variant==3&&(this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2)),this.value.variant==4&&this.variant.find(".text_title_2").toggleVis(this.value.show_text_title_2),this.value.variant==5&&this.variant.find(".item_list").toggleClass("hide_border",!this.value.show_border),this.value.variant==6&&(this.variant.find(".title_2").toggleVis(this.value.show_text_title_2),this.variant.find(".item_list").toggleClass("hide_border",!this.value.show_border))},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2,3]}},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1,2,3]}},{name:"show_list",label:_t("Show list"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[1]}},{name:"show_name",label:_t("Show name cell"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[2]}},{name:"show_text_title_2",label:_t("Show second name"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[4,6]}},{name:"show_border",label:_t("Show image border"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[5,6]}},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/numbers.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.numbers=lp.block.extendOptions({change:function(){this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2),(this.value.variant==1||this.value.variant==2||this.value.variant==4||this.value.variant==8)&&this.variant.find(".numbers").css({background:this.value.background_color||""});if(this.value.variant==3||this.value.variant==5||this.value.variant==6||this.value.variant==7)this.value.background.color?this.variant.find(".numbers").css({background:this.value.background.color}):this.variant.find(".numbers").css({background:"url("+base_url+"/"+this.value.background.url+")"});(this.value.variant==4||this.value.variant==7)&&this.variant.find(".item_list").prop("class","item_list icon_"+this.value.icon_color),this.value.variant==8&&this.variant.find(".value").css({color:this.value.numbers_color})},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{type:"label",value:_t("Icons color:"),margin:"5px 0 0",showWhen:{variant:[4,7]}},{name:"icon_color",items:[{label:_t("black<br>"),value:"black"},{label:_t("grey"),value:"grey"}],type:"radio",width:"auto",margin:"0px 49% 5px 0px",showWhen:{variant:[4]}},{name:"icon_color",items:[{label:_t("white<br>"),value:"white"},{label:_t("grey"),value:"grey"}],type:"radio",width:"auto",margin:"0px 49% 5px 0px",showWhen:{variant:[7]}},{type:"label",value:_t("Numbers color:"),margin:"5px 0 0",showWhen:{variant:[8]}},{type:lp.color,name:"numbers_color",items:[{value:"#000"},{value:"#979797"},{value:"#E6332A"},{value:"#FF3E3E"},{value:"#78CA43"},{value:"#12ABE7"},{value:"#FD6F00"},{value:"#A659E2"},{value:"#E05189"}],showWhen:{variant:[8]}},{type:"label",value:_t("Background:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color",showWhen:{variant:[1,2,4,8]}},{name:"background",width:"auto",type:lp.background,showWhen:{variant:[3,5,6,7]}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/timer.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.timer=lp.block.extendOptions({init:function(){var a=this.element.find(".countdown"),b=Component.previewFrame.window.$;b&&b(a).lpCounty()},change:function(){var a=Component.previewFrame.window.$;this.variant.find(".title_2").toggleVis(this.value.show_title_2),this.value.variant==1&&(this.variant.find(".timer_1").css({background:this.value.background_color||""}),this.variant.find(".timer_1 .countdown_wrap").css({color:this.value.countdown_color})),this.value.variant==2&&(this.value.show_title_2&&this.variant.find(".title_2").prop("class",a(".title_2").attr("class")+"timer_"+this.value.title_2_and_countdown_color),this.variant.find(".countdown_wrap").prop("class","countdown_wrap timer_"+this.value.title_2_and_countdown_color));if(this.value.variant==2||this.value.variant==4)this.value.background.color?this.variant.find(".timer").css({background:this.value.background.color}):this.variant.find(".timer").css({background:"url("+base_url+"/"+this.value.background.url+")"});this.value.variant==3&&(this.variant.find(".timer").css({background:this.value.background_color||""}),this.variant.find(".form_bottom").toggleVis(this.value.show_form_bottom_text)),this.value.variant==4&&this.variant.find(".form_bottom").toggleVis(this.value.show_form_bottom_text)},configForm:{items:[{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_form_bottom_text",label:_t("Show text under the form"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px",showWhen:{variant:[3,4]}},{type:"label",value:_t("Countdown color:"),margin:"5px 0 0",showWhen:{variant:[1]}},{type:lp.color,name:"countdown_color",items:[{value:"#E76953"},{value:"#3F3F3F"}],showWhen:{variant:[1]}},{type:"label",value:_t("Second title color:"),margin:"5px 0 0",showWhen:{variant:[2]}},{type:lp.color,name:"title_2_and_countdown_color",width:"auto",iconSize:20,margin:"0 0 8px",items:[{value:"red",color:"#FF3E3E"},{value:"grey",color:"#C2C2C2"},{value:"green",color:"#74D336"},{value:"blue",color:"#12ABE7"},{value:"orange",color:"#FD6F00"},{value:"purple",color:"#C274FF"},{value:"rose",color:"#E05189"},{value:"yellow",color:"#FFC415"}],showWhen:{variant:[2]}},{type:"label",value:_t("Background:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color",showWhen:{variant:[1,3]}},{name:"background",width:"auto",type:lp.background,showWhen:{variant:[2,4]}}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/ui/extra/projects.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};return lp.projects=lp.block.extendOptions({change:function(){this.variant.find(".cases").css({background:this.value.background_color||""}),this.variant.find(".title").toggleVis(this.value.show_title),this.variant.find(".title_2").toggleVis(this.value.show_title_2)},configForm:{items:[{name:"show_title",label:_t("Show first title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{name:"show_title_2",label:_t("Show second title"),type:"checkbox",width:"auto",margin:"5px 49% 0px 0px"},{type:"label",value:_t("Background color:"),margin:"5px 0"},{type:lp.blockColor,name:"background_color"},{type:"label",value:_t("Projects IDs:"),margin:"5px 0"},{name:"ids",type:ui.text.extend({init:function(a){this._super(a),this.input.unbind("keyup"),this.bind("change",function(){var a=lp.projects.current;setTimeout(function(){a.reloadHtml()},1)})}})}]}}),c.exports||d}),require.define("http://dev1.lpcandy.ru/view/editor/editor.js",function(a){var b=window.require.factory(a),c={exports:!1},d={};b("./editor_ru.js"),window._t.load({Yes:"Да",Cancel:"Отмена",Preview:"Предпросмотр",Publish:"Публиковать",Editor:"Редактор","Add Section":"Добавить блок","Select component type":"Выбрать тип блока","Your page was successfully published and now is available to your customers":"Ваша страница теперь опубликована и на нее смогут зайти посетители","Publish success":"Успешная публикация"}),b("./editor.css"),b("./style/font-awesome.css"),b("./ui/internal/checkbox.js"),b("./ui/internal/block.js"),b("./ui/internal/repeater.js"),b("./lib/spacedText/spacedText.js"),b("./lib/spacedText/spacedText.css"),b("./lib/datetimePicker/jquery.datetimepicker.css"),b("./lib/datetimePicker/jquery.datetimepicker.js"),b("./ui/internal/text.js"),b("./ui/internal/color.js"),b("./ui/internal/cover.js"),b("./ui/internal/logo.js"),b("./ui/internal/icon.js"),b("./ui/internal/formOrder.js"),b("./ui/internal/image.js"),b("./ui/internal/logoItem.js"),b("./ui/internal/formButton.js"),b("./ui/internal/uploadButton.js"),b("./ui/internal/fontCombo.js"),b("./ui/internal/media.js"),b("./ui/internal/countdown.js"),b("./ui/internal/galleryRepeater.js"),b("./ui/internal/overlayImage.js"),b("./ui/internal/galleryImage.js"),b("./ui/internal/background.js"),b("./ui/internal/liquid.js"),b("./lib/ymaps.js"),b("./ui/header.js"),b("./ui/order.js"),b("./ui/benefits.js"),b("./ui/services.js"),b("./ui/reasons.js"),b("./ui/gallery.js"),b("./ui/logos.js"),b("./ui/cases.js"),b("./ui/stages.js"),b("./ui/feedback.js"),b("./ui/map.js"),b("./ui/footer.js"),b("./ui/video.js"),b("./ui/textBlock.js"),b("./ui/numbers.js"),b("./ui/timer.js"),b("./ui/extra/projects.js");var e=b.dir;return $.fn.toggleVis=function(a){$(this).toggleClass("hidden",!a),$(this).toggleClass("visible",a)},d=function(a,b){var c=a.extend({init:function(a){teacss.ui.Control.prototype.init.call(this,a),Component.app=this,this.staticStyles=[e+"/style/style.tea"],this.styles=[];var b=this;teacss.jQuery(function(){b.request("load",{cache:0},function(a){try{a=a||{},b.settings={},b.settings.templates=$.parseJSON(a.templates||"{}"),b.settings.theme=$.parseJSON(a.theme||"{}"),teacss.functions.settings=b.settings,b.components=a.components,b.settings.upload=a.upload}catch(c){alert(a)}b.initUI()})}),this.bind("change",function(a){if(b.skipSave)return;b.request("save",{templates:JSON.stringify(b.settings.templates),theme:JSON.stringify(b.settings.theme,undefined,2)})})},initUI:function(){var a=this;this._super(),this.frame.bind("init",function(){a.frame.$f("head").append("<link type='text/css' rel='stylesheet' href='"+e+"/style/frame.css'>")}),this.frame.element.css({left:0}),$(".editor-sidebar").detach(),$(".preview-toolbar").width("100%"),$(".preview-toolbar").append($("#beejee_info")),a.templateTabs.element.detach(),a.view3dButton.element.detach(),a.publishButton.element.css({position:"relative"}),a.addButton=ui.button({label:_t("Add Section"),icons:{primary:"ui-icon-plus"},click:function(b){a.addSection(b)}}),a.addButton.element.insertAfter(a.publishButton.element)},addSection:function(a){var b=Component.previewFrame.root;if(!b)return;b.children.length?b.children[0].addTop(a):b.addInside(a)},publish:function(){this.request("publish",{},function(){ui.alert({title:_t("Publish success"),text:_t("Your page was successfully published and now is available to your customers")})})}});c(b)},c.exports||d}),require("/lib/templater/client/app.js","/view/editor/editor.js",f||function(){})}